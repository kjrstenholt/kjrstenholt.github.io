window.jet={AppConstants:{STARTUP:"startup",PROCESS_DATA:"processData",INIT_YOUTUBE:"INIT_YOUTUBE",YOUTUBE_READY:"YOUTUBE_READY",PROCESS_GRAPHICS_DATA:"processGraphicsData",GET_PAGE_TYPE:"getPageType",PARSE_PROPERTIES:"processProperties",BUILD_ITEMS:"buildItems",REGISTER_ITEMS:"registerItems",TEXT:"TEXT",LABEL:"LABEL",BUTTON:"BUTTON",CHECKBOX:"CHECKBOX",DIV:"DIV",IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",RESOURCE:"RESOURCE",CROSSWORD:"CROSSWORD",NODES_MANAGER:"NODES_MANAGER",DATA_INPUT:"DATA_INPUT",COMBO_BOX:"COMBO_BOX",ACCESSIBILITY_TEXT:"ACCESSIBILITY_TEXT",EPUB3V2:"EPUB3V2",EPUB3V3:"EPUB3V3",IFRAME:"IFRAME",FORWARD:"FORWARD",BACK:"BACK",REQUEST_NEXT_PAGE:"REQUEST_NEXT_PAGE",REQUEST_RESET_PAGE:"REQUEST_RESET_PAGE",REQUEST_RESET_ALL_INTERACTIVITY:"REQUEST_RESET_ALL_INTERACTIVITY",REQUEST_REMOVE_FROM_FLOW:"REQUEST_REMOVE_FROM_FLOW",REQUEST_REMOVE_FROM_FLOW_BY_ID:"REQUEST_REMOVE_FROM_FLOW_BY_ID",REQUEST_RESTORE_TO_FLOW_BY_ID:"REQUEST_RESTORE_TO_FLOW_BY_ID",REQUEST_ADD_RESOURCE:"REQUEST_ADD_RESOURCE",REQUEST_REMOVE_RESOURCE:"REQUEST_REMOVE_RESOURCE",REQUEST_REMOVE_ALL_RESOURCES:"REQUEST_REMOVE_ALL_RESOURCES",REQUEST_NAV_BEGIN:"REQUEST_NAV_BEGIN",REQUEST_NAV_END:"REQUEST_NAV_END",REQUEST_NAV_FORWARD:"REQUEST_NAV_FORWARD",REQUEST_NAV_BACK:"REQUEST_NAV_BACK",REQUEST_NAV_NORMAL:"REQUEST_NAV_NORMAL",REQUEST_NAV_DISABLE:"REQUEST_NAV_DISABLE",REQUEST_NAV_DISABLE_BACK:"REQUEST_NAV_DISABLE_BACK",REQUEST_NAV_DISABLE_FORWARD:"REQUEST_NAV_DISABLE_FORWARD",REQUEST_NAV_SUSPEND:"REQUEST_NAV_SUSPEND",REQUEST_NAV_HIDE:"REQUEST_NAV_HIDE",REQUEST_NAV_RESUME:"REQUEST_NAV_RESUME",REQUEST_NAV_BRANCH:"REQUEST_NAV_BRANCH",REQUEST_NODE:"REQUEST_NODE",REQUEST_NODES:"REQUEST_NODES",REQUEST_NODE_OVERLAY:"REQUEST_NODE_RESOURCE",REQUEST_UPDATE_PROGRESSBAR:"REQUEST_UPDATE_PROGRESSBAR",REQUEST_MANUAL_UPDATE_PROGRESSBAR:"REQUEST_MANUAL_UPDATE_PROGRESSBAR",REQUEST_UPDATE_MENUS:"REQUEST_UPDATE_MENUS",REQUEST_CHECK_ANSWER:"REQUEST_CHECK_ANSWER",SHOW_CHECK_ANSWER_BUTTON:"SHOW_CHECK_ANSWER_BUTTON",SHOW_FEEDBACK_MESSAGE:"SHOW_FEEDBACK_MESSAGE",HIDE_CHECK_ANSWER_BUTTON:"HIDE_CHECK_ANSWER_BUTTON",DISABLE_CHECK_ANSWER_BUTTON:"DISABLE_CHECK_ANSWER_BUTTON",REQUEST_ALTERNATIVE_CONTENT:"REQUEST_ALTERNATIVE_CONTENT",REQUEST_HANDLE_PROJECT_NAME:"REQUEST_HANDLE_PROJECT_NAME",REQUEST_QUESTION_PROCESS:"REQUEST_QUESTION_PROCESS",PROCESS_ANSWER_KEYS:"PROCESS_ANSWER_KEYS",REQUEST_USER_ACTIVITY:"REQUEST_USER_ACTIVITY",REPORT_USER_ACTIVITY:"REPORT_USER_ACTIVITY",REPORT_TO_SCORM_API:"REPORT_TO_SCORM_API",REPORT_INTERNALLY:"REPORT_TO_INTERNALLY",REPORT_TO_JOURNAL:"REPORT_TO_JOURNAL",REQUEST_USER_DATA:"REQUEST_USER_DATA",STORE_USER_RESPONSES:"STORE_USER_RESPONSES",REQUEST_SUSPEND_DATA:"REQUEST_SUSPEND_DATA",REQUEST_RETRIEVE_DATA:"REQUEST_RETRIEVE_DATA",REQUEST_SUSPEND_DATA:"REQUEST_SUSPEND_DATA",SET_COMPLETION_STATUS:"SET_COMPLETION_STATUS",REQUEST_CLEAR_JET_DATA:"REQUEST_CLEAR_JET_DATA",RECORD_USER_RESPONSE:"RECORD_USER_RESPONSE",RECORD_USER_INTERACTION:"RECORD_USER_INTERACTION",RECORD_OBJECTIVE_RESPONSES:"RECORD_OBJECTIVE_RESPONSES",SET_SCORE:"SET_SCORE",GET_SCORE:"GET_SCORE",SET_CUSTOM_USER_SCORE:"SET_CUSTOM_USER_SCORE",GET_CUSTOM_USER_SCORE:"GET_CUSTOM_USER_SCORE",SET_CUSTOM_TOTAL_SCORE:"SET_CUSTOM_TOTAL_SCORE",GET_CUSTOM_TOTAL_SCORE:"GET_CUSTOM_TOTAL_SCORE",GET_REPORT:"GET_REPORT",LINK_OUTCOME:"LINK_OUTCOME",GET_TOTAL_POINTS:"GET_TOTAL_POINTS",INCREMENT_SCORE:"INCREMENT_SCORE",INCREMENT_TOTAL_POINTS:"INCREMENT_TOTAL_POINTS",RESET_SCORES:"RESET_SCORES",RESET_INTERACTIVITY_ONLY:"RESET_INTERACTIVITY_ONLY",RESET_SECTION_SCORES:"RESET_SECTION_SCORES",REQUEST_FEEDBACK_REPORT:"REQUEST_FEEDBACK_REPORT",REQUEST_OUTCOMES_REPORT:"REQUEST_OUTCOMES_REPORT",REPORT_OUTCOMES:"REPORT_OUTCOMES",REPORT_FEEDBACK_INTERNALLY:"REPORT_FEEDBACK_INTERNALLY",REPORT_TRANSCRIPT_ACTIVITY:"REPORT_TRANSCRIPT_ACTIVITY",REPORT_USER_FEEDBACK_ACTIVITY:"REPORT_USER_FEEDBACK_ACTIVITY",REQUEST_CONFIRMATION:"REQUEST_CONFIRMATION",REPORT_CONFIRMATION:"REPORT_CONFIRMATION",REQUEST_TERMINATE:"REQUEST_TERMINATE",REQUEST_JOURNAL_REPORT:"REQUEST_JOURNAL_REPORT",REQUEST_OVERLAY:"REQUEST_OVERLAY",REQUEST_POPUP:"REQUEST_POPUP",REQUEST_NOTES:"REQUEST_NOTES",REQUEST_TRANSCRIPT:"REQUEST_TRANSCRIPT",REQUEST_CLOSE_POPUP:"REQUEST_CLOSE_POPUP",REQUEST_TOOLTIP:"REQUEST_TOOLTIP",REQUEST_CLOSE_TOOLTIP:"REQUEST_CLOSE_TOOLTIP",REQUEST_BANNER_TEXT:"REQUEST_BANNER_TEXT",REQUEST_HEADER_BACKGROUND:"REQUEST_HEADER_BACKGROUND",REQUEST_METER:"REQUEST_METER",REQUEST_CLOSE_METER:"REQUEST_CLOSE_METER",SET_METER:"SET_METER",REQUEST_DASHBOARD_LAYOUT:"REQUEST_DASHBOARD_LAYOUT",REQUEST_GADGET_UPDATE:"REQUEST_GADGET_UPDATE",REQUEST_ANIMATION:"REQUEST_ANIMATION",UPDATE_ANIMATORS:"UPDATE_ANIMATORS",BRANCH_IMMEDIATELY:"Branch immediately",BRANCH_NEXT_BUTTON:"Branch when the Next Button is clicked",ADD_TOC:"ADD_TOC",ADD_RESOURCES:"ADD_RESOURCES",ADD_TITLE:"ADD_TITLE",ADD_SETTINGS:"ADD_SETTINGS",SHOW_TOC:"SHOW_TOC",HIDE_TOC:"HIDE_TOC",HANDLE_GRAPHICS_DATA:"HANDLE_GRAPHICS_DATA",BUILD_VECTOR_IMAGE:"BUILD_VECTOR_IMAGE",PAGE:"Page",OBJECTLIST:"ObjectList",LAYER:"Layer",ELLIPSE:"JFEllipse",RECTANGLE:"JFRectangle",ROUNDED_RECTANGLE:"JFRoundedRectangle",LINE:"Line",LABEL_LINE:"LabelLine",REGULAR_LINE:"RegularLine",POLYGON:"Polygon",ARC:"Arc",DIAMOND:"Diamond",SHAPE:"Shape",CHORD:"Chord",PIE:"Pie",JFIMAGE:"JFImage",JFTEXT:"Text",PARALLELOGRAM:"Parallelogram",TRAPEZOID:"Trapezoid",ISOSCELESRECTANGLE:"IsoscelesRectangle",JFGROUP:"JFGroup",LARGE_VALUE:100000000000,CLICK:"Click",JUMP_TO_PAGE:"Jump to Page",OPEN_URL:"Open URL",ADD_OVERLAY:"Add Overlay",SHOW_NODE:"Show Node",MOUSE_OVER:"Mouse Over",SET_VALUE:"Set Value",APPEND_VALUE:"Append Value",REMOVE_FROM_FLOW:"Remove from Flow",EXECUTE_COMMAND:"Execute Command(s)",JUMP_TO_VALUE:"Jump to Value",LINK_TO_OUTCOME:"Link to Outcome",SHOW_AS_LAYER:"Show as Layer",SEND_XAPI_STATEMENT:"Send xAPI statement",WRONG_ANSWER:"WRONG_ANSWER",CORRECT_ANSWER:"CORRECT_ANSWER",ALERT_MAP:"ALERT_MAP",SET_GEOLOCATION:"SET_GEOLOCATION",SET_MARKER:"SET_MARKER",IS_INTERACTIVE_TRUE:"IS_INTERACTIVE_TRUE",UPDATE_WIDGETS:"UPDATE_WIDGETS"}};puremvc.define({name:"jet.ApplicationFacade",parent:puremvc.Facade},{registeredNodes:{},registeredGadgets:{},projectName:"",startup:function(){if(!this.initialized){this.initialized=true;this.registerCommand(jet.AppConstants.STARTUP,jet.controller.command.StartupCommand);this.sendNotification(jet.AppConstants.STARTUP,this)}},registerNode:function(a,b){this.registeredNodes[a]=b},createNode:function(a){if(this.registeredNodes.hasOwnProperty(a)){return this.registeredNodes[a]()}return null},registerGadget:function(a,b){this.registeredGadgets[a]=b},getGadgets:function(){return this.registeredGadgets},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e},setProjectName:function(a){this.projectName=a},getProjectName:function(){return this.projectName}},{getInstance:function(a){var b=puremvc.Facade.instanceMap;instance=b[a];if(instance){return instance}return b[a]=new jet.ApplicationFacade(a)},NAME:"JetBuilder"});puremvc.define({name:"jet.controller.command.BuildItemsCommand",parent:puremvc.SimpleCommand},{execute:function(w){var e=w.getBody();var q=this.facade;var a=q.retrieveProxy(jet.model.proxy.LXMLProxy.NAME);var s;var l;var v=0;var f=$(e).find("settings");var u=a.parseSettings(f);setSettings(u);var t=$(e).find("interaction");var k=a.parseInteractionElement(t);q.setProjectName(k);q.sendNotification(jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME,"");q.registerMediator(new jet.view.mediator.PageMediator);q.registerMediator(new jet.view.mediator.FormsMediator);q.registerMediator(new jet.view.mediator.GraphicsMediator);q.registerMediator(new jet.view.mediator.AudioMediator);q.registerMediator(new jet.view.mediator.YouTubeMediator);q.registerMediator(new jet.view.mediator.QuestionProcessorMediator);q.registerMediator(new jet.view.mediator.WidgetMediator);q.registerMediator(new jet.view.mediator.ImageMediator);q.registerMediator(new jet.view.mediator.AnimationMediator);var o=q.retrieveMediator(jet.view.mediator.PageMediator.NAME);o.setSettings(u);var x=q.retrieveMediator(jet.view.mediator.GraphicsMediator.NAME);var p=q.retrieveMediator(jet.view.mediator.YouTubeMediator.NAME);var b=q.retrieveMediator(jet.view.mediator.QuestionProcessorMediator.NAME);var n=q.retrieveMediator(jet.view.mediator.WidgetMediator.NAME);var d=q.retrieveMediator(jet.view.mediator.ImageMediator.NAME);var h=q.retrieveMediator(jet.view.mediator.AnimationMediator.NAME);var r=100;if($(e).find("optionpage")&&$(e).find("optionpage").length){var m=$(e).find("optionpage");r=m.length;setTotalNumberOfPages(r)}this.processPages(this,m,v,a,q,o,x,p,b,n,d,h,r)},completeTasks:function(a){a.hideNodes();a.constructResources();a.constructTitle();a.showFirstNode()},processPages:function(q,d,f,s,r,a,b,n,o,k,m,h,e){var l=d.get(f);pageLayout=s.getPageType(s,l).toUpperCase();uid=s.getUID(l);if($("body").hasClass("epub3")||$("body").hasClass("epub3v2")){var p=$("body").attr("id");p=p.substring(3);if(p==uid){page=r.createNode(pageLayout)}else{page=null}}else{page=r.createNode(pageLayout)}if(page!=null&&page!=undefined){if(f>0){$(page.getDiv()).hide()}page.setMediator(jet.view.mediator.PageMediator.NAME,a);page.setMediator(new jet.view.mediator.FormsMediator);page.setMediator(jet.view.mediator.GraphicsMediator.NAME,b);page.setMediator(jet.view.mediator.YouTubeMediator.NAME,n);page.setMediator(jet.view.mediator.QuestionProcessorMediator.NAME,o);page.setMediator(jet.view.mediator.WidgetMediator.NAME,k);page.setMediator(jet.view.mediator.ImageMediator.NAME,m);page.setMediator(jet.view.mediator.AnimationMediator.NAME,h);page.setUID(uid);a.addNode(page,uid);a.addTOCItem(l,uid);a.addResourceItem(l,uid);s.parseData(l,page)}f++;if(f<e){window.requestAnimationFrame(function(){q.processPages(q,d,f,s,r,a,b,n,o,k,m,h,e);updatePagesLoaded(f)})}else{q.completeTasks(a)}}});puremvc.define({name:"jet.controller.command.BuildVectorImage",parent:puremvc.SimpleCommand},{graphicsUtils:null,execute:function(d){this.graphicsUtils=new jet.controller.command.util.GraphicsUtils();var b=d.getBody();var e=b.objectMap;var a=b.contentDiv;switch(e.ID){case jet.AppConstants.RECTANGLE:this.drawRectangle(e,a);break;case jet.AppConstants.ROUNDED_RECTANGLE:this.drawRoundedRectangle(e,a);break;case jet.AppConstants.LINE:this.drawLine(e,a);break;case jet.AppConstants.REGULAR_LINE:this.drawLine(e,a);break;case jet.AppConstants.LABEL_LINE:this.drawLabelLine(e,a);break;case jet.AppConstants.POLYGON:this.drawPolygon(e,a);break;case jet.AppConstants.ELLIPSE:this.drawEllipse(e,a);break;case jet.AppConstants.ARC:this.drawArc(e,a);break;case jet.AppConstants.CHORD:this.drawChord(e,a);break;case jet.AppConstants.PIE:this.drawPie(e,a);break;case jet.AppConstants.JFIMAGE:this.drawImage(e,a);break;case jet.AppConstants.JFTEXT:this.drawText(e,a);break;case jet.AppConstants.DIAMOND:this.drawDiamond(e,a);break;case jet.AppConstants.PARALLELOGRAM:this.drawRectangle(e,a);break;case jet.AppConstants.TRAPEZOID:this.drawRectangle(e,a);break;case jet.AppConstants.ISOSCELESRECTANGLE:this.drawRectangle(e,a);break;case jet.AppConstants.JFGROUP:this.drawGroup(e,a);break}},createCanvas:function(s,v,q,r,l,n){var a=v.ObjectId;var m=v.LayerIndex;var h=v.page;if(a>-1){var o=h.getGroups()[a];if(o!=null&&o!=undefined){q=o}}var e=document.createElement("canvas");if(a>-1){$(e).css("pointer-events","none")}if(a==-1){this.setMotionProperty(e,v);this.setModifyingProperty(e,v);this.setPropertyList(e,v)}$(q).append(e);var t=e.getContext("2d");this.graphicsUtils.calculateCanvasDimensions(s,l);var b=parseInt(v.LineWidth);this.translatePoints(s,l.left,l.top,b+n);var u=l.x;var d=l.y;$(e).css("position","absolute");e.width=u+(2*b)+(2*n);e.height=d+(2*b)+(2*n);r={x:u,y:d};r={x:e.width,y:e.height};var k=this.graphicsUtils.calculateOffset(q);var p=l.top-b-n-k.y;var f=l.left-b-n-k.x;$(e).css("top",p+"px");$(e).css("left",f+"px");$(e).css("z-index",m);this.setStyleFormat(t,v,r);if(a==-1){h.processGraphicsObject(e,v,l)}return t},createDiv:function(q,e,h,l,a,p){var m=e.page;var b=document.createElement("div");var o=e.GroupID;m.getGroups()[o]=b;this.setMotionProperty(b,e);this.setModifyingProperty(b,e);this.setPropertyList(b,e);$(h).append(b);this.graphicsUtils.calculateCanvasDimensions(q,a);var d=a.x;var k=a.y;$(b).css("position","absolute");var n=a.top;var f=a.left;$(b).css("top",n+"px");$(b).css("left",f+"px");$(b).css("width",d+"px");$(b).css("height",k+"px");var m=e.page;m.processGraphicsObject(b,e,a)},render:function(d,e){var a=parseInt(e.LineWidth);var b=parseInt(e.FillStyle);if(a&&a>0){d.stroke()}if(b){d.fill()}},drawLine:function(k,e){var d=k.Points;var a={};var h={};var f=this.createCanvas(d,k,e,a,h,0);f.moveTo(d[0]["x"],d[0]["y"]);for(var b=1;b<d.length;b++){f.lineTo(d[b]["x"],d[b]["y"])}f.stroke();this.drawArrows(f,k,d[0],d[d.length-1])},drawPolygon:function(k,e){var d=k.Points;var a={};var h={};var f=this.createCanvas(d,k,e,a,h,0);f.moveTo(d[0]["x"],d[0]["y"]);for(var b=1;b<d.length;b++){f.lineTo(d[b]["x"],d[b]["y"])}f.closePath();this.render(f,k)},drawDiamond:function(b,d){var o=b.Points;var m=[];m.push(o[0]);m.push(o[1]);m.push(o[2]);m.push(o[3]);var h={};var a={};var e=this.createCanvas(o,b,d,h,a,0);var n=this.graphicsUtils.calcMidPointFromPoints(m[0],m[1]);var l=this.graphicsUtils.calcMidPointFromPoints(m[1],m[3]);var k=this.graphicsUtils.calcMidPointFromPoints(m[3],m[2]);var f=this.graphicsUtils.calcMidPointFromPoints(m[2],m[0]);e.moveTo(n.x,n.y);e.lineTo(l.x,l.y);e.lineTo(k.x,k.y);e.lineTo(f.x,f.y);e.lineTo(n.x,n.y);e.closePath();this.render(e,b)},drawRectangle:function(b,d){var n=b.Points;if(n.length<4){return}var h={};var a={};var e=this.createCanvas(n,b,d,h,a,0);var m=n[0];var l=n[1];var k=n[2];var f=n[3];e.moveTo(n[0]["x"],n[0]["y"]);e.lineTo(n[1]["x"],n[1]["y"]);e.lineTo(n[3]["x"],n[3]["y"]);e.lineTo(n[2]["x"],n[2]["y"]);e.lineTo(n[0]["x"],n[0]["y"]);e.closePath();this.render(e,b)},drawGroup:function(f,d){var b=f.Points;if(b.length<4){return}var a={};var e={};this.createDiv(b,f,d,a,e,0)},drawText:function(b,d){var q=b.Points;if(q.length<4){return}var l={};var a={};var s=parseInt(b.FontSize)-3;var f=this.createCanvas(q,b,d,l,a,0);var o=q[0];var n=q[1];var m=q[2];var k=q[3];var e=this.graphicsUtils.setRotation(b,f,a,false);var r=b.text;var h=this.graphicsUtils.convertFromCharCode(r);var p=this.convert(parseInt(b.FontColor));if(p){f.fillStyle=p}f.textBaseline="alphabetic";f.font=s+"px Arial";f.fillText(h,0,a.y/2)},drawImage:function(f,h){var s=f.Points;if(s.length<4){return}var o={};var b={};var m=this.createCanvas(s,f,h,o,b,0);var r=s[0];var q=s[1];var p=s[2];var n=s[3];var e=this.graphicsUtils.calcMagnitude(r,q);var d=this.graphicsUtils.calcMagnitude(q,n);var a="./base/"+f.imageData;var l=new Image();l.onload=function(){m.drawImage(this,0,0,e,d)};l.src=a;var k=this.graphicsUtils.setRotation(f,m,b,true)},drawEllipse:function(v,p){var s=v.Points;var h={};var n=0;if(this.graphicsUtils.isObjectRotated(v,h,true)){n=0}else{n=5}var q={};var t=this.createCanvas(s,v,p,q,h,n);var f=s[0];var e=s[1];var d=s[2];var b=s[3];var a=parseInt(v.LineWidth);var o=this.graphicsUtils.calcMagnitude(f,e);var u=this.graphicsUtils.calcMagnitude(e,b);var l=a+n;var k=a+n;var r=this.graphicsUtils.setRotation(v,t,h,true);var m=0.5522848;ox=(o/2)*m,oy=(u/2)*m,xe=l+o,ye=k+u,xm=l+o/2,ym=k+u/2;t.beginPath();t.moveTo(l,ym);t.bezierCurveTo(l,ym-oy,xm-ox,k,xm,k);t.bezierCurveTo(xm+ox,k,xe,ym-oy,xe,ym);t.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);t.bezierCurveTo(xm-ox,ye,l,ym+oy,l,ym);t.closePath();this.render(t,v)},drawArc:function(K,A){var G=K.Points;var E={};var t={};var H=this.createCanvas(G,K,A,E,t,25);var p=G[0];var l=G[1];var f=G[2];var a=parseInt(K.LineWidth);var b=this.graphicsUtils.calcAngle(p,l);var d=this.graphicsUtils.calcMidPointFromPoints(p,l);var C=this.graphicsUtils.calcMagnitude(f,d);var J=this.graphicsUtils.calcMagnitude(p,l);var r=((J*J)/(8*C))+(C/2);var F=this.graphicsUtils.calcAngle(f,d);var q=r*Math.cos(F);var s=r*Math.sin(F);var o=f.x+q;var k=f.y+s;var I=b;var v=a;var u=a;var n=p.y-k;var B=p.x-o;var h=l.y-k;var z=l.x-o;var D=Math.atan2(n,B);var w=Math.atan2(h,z);var e=this.graphicsUtils.isFlipped(p,l,f);H.arc(o,k,r,D,w,e);this.render(H,K)},drawChord:function(K,A){var G=K.Points;var E={};var t={};var H=this.createCanvas(G,K,A,E,t,25);var p=G[0];var l=G[1];var f=G[2];var a=parseInt(K.LineWidth);var b=this.graphicsUtils.calcAngle(p,l);var d=this.graphicsUtils.calcMidPointFromPoints(p,l);var C=this.graphicsUtils.calcMagnitude(f,d);var J=this.graphicsUtils.calcMagnitude(p,l);var r=((J*J)/(8*C))+(C/2);var F=this.graphicsUtils.calcAngle(f,d);var q=r*Math.cos(F);var s=r*Math.sin(F);var o=f.x+q;var k=f.y+s;var I=b;var v=a;var u=a;var n=p.y-k;var B=p.x-o;var h=l.y-k;var z=l.x-o;var D=Math.atan2(n,B);var w=Math.atan2(h,z);var e=this.graphicsUtils.isFlipped(p,l,f);H.arc(o,k,r,D,w,e);H.closePath();this.render(H,K)},drawPie:function(L,B){var H=L.Points;var F={};var u={};var I=this.createCanvas(H,L,B,F,u,25);var r=H[0];var n=H[1];var h=H[2];var f=H[3];var a=parseInt(L.LineWidth);var b=this.graphicsUtils.calcAngle(r,n);var d=this.graphicsUtils.calcMidPointFromPoints(r,n);var D=this.graphicsUtils.calcMagnitude(h,d);var K=this.graphicsUtils.calcMagnitude(r,n);var s=((K*K)/(8*D))+(D/2);var G=this.graphicsUtils.calcAngle(h,d);var q=s*Math.cos(G);var t=s*Math.sin(G);var p=h.x+q;var l=h.y+t;var J=b;var w=a;var v=a;var o=r.y-l;var C=r.x-p;var k=n.y-l;var A=n.x-p;var E=Math.atan2(o,C);var z=Math.atan2(k,A);var e=this.graphicsUtils.isFlipped(r,n,h);I.arc(p,l,s,E,z,e);I.moveTo(n.x,n.y);I.lineTo(f.x,f.y);I.lineTo(r.x,r.y);this.render(I,L)},drawRoundedRectangle:function(w,p){var t=w.Points;var s={};var k={};var u=this.createCanvas(t,w,p,s,k,0);var f=t[0];var e=t[1];var d=t[2];var b=t[3];var a=parseInt(w.LineWidth);var n=this.graphicsUtils.calcMagnitude(f,e);var v=this.graphicsUtils.calcMagnitude(e,b);var m=a;var l=a;var q=n;var o=v;var h=Math.min(n,v)/5;var r=this.graphicsUtils.setRotation(w,u,k,true);u.beginPath();u.moveTo(m+h,l);u.lineTo(m+q-h,l);u.quadraticCurveTo(m+q,l,m+q,l+h);u.lineTo(m+q,l+o-h);u.quadraticCurveTo(m+q,l+o,m+q-h,l+o);u.lineTo(m+h,l+o);u.quadraticCurveTo(m,l+o,m,l+o-h);u.lineTo(m,l+h);u.quadraticCurveTo(m,l,m+h,l);u.closePath();this.render(u,w)},drawLabelLine:function(e,f){var q=e.Points;var n={};var a={};var l=this.createCanvas(q,e,f,n,a,0);if(q.length<1){return}var d=this.graphicsUtils.calcMagnitude(q[0],q[1]);var b=this.graphicsUtils.calcMagnitude(q[0],q[2]);var m=this.graphicsUtils.calcSlope(q[0],q[2]);var h=Math.atan2(m,1);var k=20;var p=this.graphicsUtils.projectPoint(q[2],k,h);var o=this.graphicsUtils.projectPoint(q[4],k,h);this.drawLabelArrows(l,e,q[0],q[1]);this.drawLabelArrows(l,e,q[1],q[0]);l.beginPath();l.moveTo(q[0]["x"],q[0]["y"]);l.lineTo(q[1]["x"],q[1]["y"]);l.lineTo(q[0]["x"],q[0]["y"]);l.lineTo(q[2]["x"],q[2]["y"]);l.lineTo(q[3]["x"],q[3]["y"]);l.lineTo(q[0]["x"],q[0]["y"]);l.moveTo(q[1]["x"],q[1]["y"]);l.lineTo(q[4]["x"],q[4]["y"]);l.lineTo(q[5]["x"],q[5]["y"]);l.stroke();l.closePath()},translatePoints:function(e,h,f,b){for(var d=0;d<e.length;d++){var a=e[d];a.x=a.x-h+b;a.y=a.y-f+b;e[d]=a}},translatePointsForGroupedObject:function(m,b,k,f,d){var h=d.x;var a=d.y;for(var e=0;e<m.length;e++){var l=m[e];l.x=l.x-(b+h);l.y=l.y-(k+a);l.x=l.x+f;l.y=l.y+f;m[e]=l}},convert:function(b){var d=this.decimalToHexString(b);var a="#"+d.substring(d.length-6);return a},setStyleFormat:function(b,d,a){this.setFillFormat(b,d,a.x,a.y);this.setLineFormat(b,d);this.setSettings(b,d)},decimalToHexString:function(a){if(a<0){a=4294967295+a+1}return a.toString(16).toUpperCase()},setSettings:function(b,d){var a=parseInt(d.Transparency);b.globalAlpha=(100-a)/100;var e=parseInt(d.Invisible);if(e==1){}},setMotionProperty:function(a,d){var b=parseInt(d.DisableMotion);if(b==0){$(a).draggable();$(a).drag(function(f,e){$(this).css({top:e.offsetY,left:e.offsetX})});$(a).addClass("EnableMotion")}},setModifyingProperty:function(b,d){var a=parseInt(d.DisableModifyingProperties);if(a==0){$(b).addClass("EnableModify")}},setPropertyList:function(a,e){var b=e.event;switch(b){case jet.AppConstants.CLICK:$(a).addClass("EnableClickTouch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.JUMP_TO_PAGE:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.OPEN_URL:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.ADD_OVERLAY:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.SHOW_NODE:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break}var d=e.mouseoverevent;switch(d){case jet.AppConstants.MOUSE_OVER:$(a).addClass("EnableMouseOver");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break}},setLineFormat:function(b,e){var f=1;var a=parseInt(e.LineWidth);var d=this.convert(parseInt(e.LineColor));if(a==0){f=0}b.strokeStyle=d;b.lineWidth=a},setFillFormat:function(f,h,e,d){var b=parseInt(h.FillStyle);var a=parseInt(h.FillColor);var k=this.convert(a);switch(b){case 0:break;case 1:f.fillStyle=k;break;default:f.fillStyle=k;break}},drawArrows:function(h,k,f,d){var b=k.StartArrowType;var a=k.EndArrowType;var e=k.Points;if(e.length<2){return}if(b=="1"){f=e[0];d=e[1];this.calcRadians(h,f,d,k)}if(a=="1"){f=e[e.length-1];d=e[e.length-2];this.calcRadians(h,f,d,k)}},drawLabelArrows:function(h,k,f,d){var b=k.StartArrowType;var a=k.EndArrowType;var e=k.Points;if(e.length<2){return}if(b=="1"){f=e[0];d=e[1];this.calcRadians(h,f,d,k)}if(a=="1"){f=e[1];d=e[0];this.calcRadians(h,f,d,k)}},calcRadians:function(n,d,o,e){var m=parseInt(d.x-o.x);var b=parseInt(d.y-o.y);var l=Math.sqrt(Math.pow(o.x-d.x,2)+Math.pow(o.y-d.y,2));var k=Math.acos(Math.abs(o.x-d.x)/l);var h=0;var f=0;var a=0;if((d.y==o.y)&&(d.x!=o.x)){a=1}if((d.y!=o.y)&&(d.x==o.x)){f=1}if((d.y-o.y>0)&&(d.x-o.x<0)){h=1}if((d.y-o.y>0)&&(d.x-o.x>0)){h=2}if((d.y-o.y<0)&&(d.x-o.x>0)){h=3}if((d.y-o.y<0)&&(d.x-o.x<0)){h=4}if(h==0){}if(h==1){}if(h==2){k=Math.PI-k}if(h==3){k=Math.PI+k}if(h==4){k=2*Math.PI-k}if(f&&d.y<o.y){k=2*Math.PI-k}if(a&&d.x>o.x){k=Math.PI+k}this.plotTriangle(n,k,d,e)},plotTriangle:function(h,b,q,a){var p=0.4363323129985824;var k=b+p;var f=b-p;var d=10;this.setLineFormat(h,a);fillColor=this.convert(parseInt(a.LineColor));var r=parseInt(a.FillStyle);h.fillStyle=fillColor;var e=q.x+d*Math.cos(k);var n=q.y-d*Math.sin(k);var o={x:e,y:n};var s=q.x+d*Math.cos(f);var l=q.y-d*Math.sin(f);var m={x:s,y:l};h.beginPath();h.moveTo(q.x,q.y);h.lineTo(o.x,o.y);h.lineTo(m.x,m.y);h.lineTo(q.x,q.y);h.closePath();h.stroke()}});puremvc.define({name:"jet.controller.command.ParseProperties",parent:puremvc.SimpleCommand},{execute:function(b){var e=b.getBody();var a=e.component;properties=e.properties;var d=this.getProperty(properties,"player_width");if(d!=null){a.setWidth(d.player_width)}else{d=this.getProperty(properties,"width");if(d!=null){a.setWidth(d.width)}}d=this.getProperty(properties,"player_height");if(d!=null){a.setHeight(d.player_height)}else{d=this.getProperty(properties,"height");if(d!=null){a.setHeight(d.height)}}d=this.getProperty(properties,"player_x");if(d!=null){a.setX(d.player_x);a.setInitialX(d.player_x)}else{d=this.getProperty(properties,"x");if(d!=null){a.setX(d.x);a.setInitialX(d.x)}}d=this.getProperty(properties,"player_y");if(d!=null){a.setY(d.player_y);a.setInitialY(d.player_y)}else{d=this.getProperty(properties,"y");if(d!=null){a.setY(d.y);a.setInitialY(d.y)}}d=this.getProperty(properties,"bgAlpha");if(d!=null){a.setBackgroundOpacity(d.bgAlpha)}d=this.getProperty(properties,"fgAlpha");if(d!=null){a.setForegroundOpacity(d.fgAlpha)}d=this.getProperty(properties,"bgColor");if(d!=null){a.setBackgroundColor(d.bgColor)}d=this.getProperty(properties,"parentClass");if(d!=null){a.setClass(d.parentClass)}d=this.getProperty(properties,"contentClass");if(d!=null){a.setContentClass(d.contentClass)}},getProperty:function(e,b){var d=null;for(var a in e){if(d!=null){break}if(!e.hasOwnProperty(a)){continue}if(typeof e[a]=="object"){d=this.getProperty(e[a],b)}else{if(a==b){d=e;break}}}return d}});puremvc.define({name:"jet.controller.command.PrepareControllerCommand",parent:puremvc.SimpleCommand},{execute:function(a){this.facade.registerCommand(jet.AppConstants.PROCESS_DATA,jet.controller.command.ProcessDataCommand);this.facade.registerCommand(jet.AppConstants.PROCESS_GRAPHICS_DATA,jet.controller.command.ProcessGraphicsDataCommand);this.facade.registerCommand(jet.AppConstants.REGISTER_ITEMS,jet.controller.command.RegisterItemsCommand);this.facade.registerCommand(jet.AppConstants.BUILD_ITEMS,jet.controller.command.BuildItemsCommand);this.facade.registerCommand(jet.AppConstants.PARSE_PROPERTIES,jet.controller.command.ParseProperties);this.facade.registerCommand(jet.AppConstants.BUILD_VECTOR_IMAGE,jet.controller.command.BuildVectorImage);this.facade.registerCommand(jet.AppConstants.INIT_YOUTUBE,jet.controller.command.StartUpYouTubeCommand);this.facade.sendNotification(jet.AppConstants.INIT_YOUTUBE,"");this.facade.sendNotification(jet.AppConstants.PROCESS_DATA,"./base/main.xml")}});puremvc.define({name:"jet.controller.command.PrepareModelCommand",parent:puremvc.SimpleCommand},{execute:function(a){this.facade.registerProxy(new jet.model.proxy.LXMLProxy);this.facade.registerProxy(new jet.model.proxy.JFXMLProxy)}});puremvc.define({name:"jet.controller.command.PrepareViewCommand",parent:puremvc.SimpleCommand},{execute:function(a){}});puremvc.define({name:"jet.controller.command.ProcessDataCommand",parent:puremvc.SimpleCommand},{execute:function(d){var b=this;if($("body").hasClass("epub3v3")){var a=this.facade;var h=$("body").html();b.getDataStub(a,b,h);return}var e=d.getBody();var a=this.facade;var f={type:"GET",dataType:"xml",success:function(k){a.sendNotification(jet.AppConstants.REGISTER_ITEMS,k)},error:function(k){if($("body").hasClass("epub3")){b.getData(a,false);return}else{if($("body").hasClass("epub3v2")){b.getData(a,true);return}else{window.alert("Use LodeStar to preview projects on your local drive.")}}}};f.url=e;$.ajax(f)},getSectionsHTML:function(){var a="";$("body").find("section.page").each(function(){a+=$(this).html()});return a},processHTML:function(n,e,m){var f="";var b=n.retrieveMediator(jet.view.mediator.PageMediator.NAME);b.setSettings(f);var d=n.retrieveMediator(jet.view.mediator.GraphicsMediator.NAME);var k=n.retrieveMediator(jet.view.mediator.YouTubeMediator.NAME);var l=n.retrieveMediator(jet.view.mediator.QuestionProcessorMediator.NAME);var h=n.retrieveMediator(jet.view.mediator.WidgetMediator.NAME);var a=new jet.view.page.WidgetPage();$(a.getDiv()).addClass("elem3");a.setMediator(jet.view.mediator.PageMediator.NAME,b);a.setMediator(jet.view.mediator.GraphicsMediator.NAME,d);a.setMediator(jet.view.mediator.YouTubeMediator.NAME,k);a.setMediator(jet.view.mediator.QuestionProcessorMediator.NAME,l);a.setMediator(jet.view.mediator.WidgetMediator.NAME,h);a.setUID("1000");a.buildComponent(a,jet.AppConstants.EPUB3V3,null,e,null);m.reparentContent(a)},getData:function(e,h){var d=getXMLData();var f=h?qValidate(d):d;d=$.parseXML(f);var a=setInterval(b,1000);function b(){var k=e.retrieveProxy(jet.model.proxy.LXMLProxy.NAME);if(typeof k!="undefined"&&k!=null){e.sendNotification(jet.AppConstants.REGISTER_ITEMS,d);clearInterval(a)}}},getDataStub:function(f,e,h){var d=getXMLData();d=$.parseXML(d);var a=setInterval(b,1000);function b(){if(f.retrieveProxy(jet.model.proxy.LXMLProxy.NAME)!=undefined){f.sendNotification(jet.AppConstants.REGISTER_ITEMS,d);clearInterval(a);e.processHTML(f,h,e)}}},reparentContentx:function(){var a=$(".viewer").contents();$(a).appendTo("body");$(".viewer").empty();$(".viewer").remove()},reparentContenty:function(){var a=$(".WidgetPage").contents();$(a).appendTo("body");$(".viewer").empty();$(".viewer").remove()},reparentContentz:function(){$(".WidgetPage").appendTo("body");$(".viewer").empty();$(".viewer").remove()},reparentContentxx:function(){$("section.page").appendTo("body");$(".viewer").empty();$(".viewer").remove()},reparentContent:function(h){var d=h.getDiv();var a=$(d).find(".QuestionWidget,.LS_JET_0009");var f=$("body").find(".QuestionWidget");var b=a.length;var e=f.length;$(f).each(function(k,l){if(k<b){var m=$(a).get(k);$(l).before(m).detach()}});$(".viewer").empty();$(".viewer").remove()}});puremvc.define({name:"jet.controller.command.ProcessGraphicsDataCommand",parent:puremvc.SimpleCommand},{execute:function(d){var b=d.getBody();var e=b.fileName;var h=b.graphicsUID;var a=this.facade;var f={type:"GET",dataType:"xml",success:function(k){var l={graphicsUID:h,xml:k};a.sendNotification(jet.AppConstants.HANDLE_GRAPHICS_DATA,l)},error:function(k){}};f.url=e;$.ajax(f)}});puremvc.define({name:"jet.controller.command.StartUpYouTubeCommand",parent:puremvc.SimpleCommand},{execute:function(d){var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}});puremvc.define({name:"jet.controller.command.StartupCommand",parent:puremvc.MacroCommand},{initializeMacroCommand:function(){this.addSubCommand(jet.controller.command.PrepareControllerCommand);this.addSubCommand(jet.controller.command.PrepareViewCommand);this.addSubCommand(jet.controller.command.PrepareModelCommand);window.requestAnimationFrame(function(){updatePagesLoaded(2)})}});var progressDiv=null;var loadProgressDiv=null;var totalNumberOfPages=100;var pagesLoaded=0;var intervalID=null;var intervalMathJaxChecker=null;var intervalSCORMChecker=null;var intervalParserChecker=null;var isSCORMLoaded=false;var isSCORMNeeded=false;var intervalCount=10;var scormIntervalCount=10;var backgroundColor=null;var outerBackgroundColor=null;var googleMap=null;var firstPageShown=false;var infoWindowInstance=null;var isCordova=false;var isDeviceReadyHandled=false;var isParserLoaded=false;var isCMI5Loaded=false;var settings=null;var isCMINeeded=false;var adHocAudio=null;var exposed=null;var currentUID=null;var globaldndWidget={currentItem:null,keyboardHandler:keyboardHandler,showMenu:showMenu,isMenuShowing:isMenuShowing,menuHeight:100,moveItem:moveItem,resetFocus:resetFocus};(function setUpParserAPIHooks(){if(typeof ParserApiHooks=="undefined"||ParserApiHooks==null){ParserApiHooks={};ParserApiHooks.Exposed={};if(console&&console.log){console.log("Build 8-11-23 v10 b9 -- ParseAPIHooks in place")}showLoadProgressBar();hideJetWrapper(true)}}());$(document).ready(function(){if(navigator.platform.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)){document.addEventListener("deviceready",onDeviceReady,false);if(!!window.cordova){if(!isDeviceReadyHandled){onDeviceReady()}}else{if(!isDeviceReadyHandled){onDeviceReady()}}}else{if(!isDeviceReadyHandled){onDeviceReady()}}});function onDeviceReady(){isDeviceReadyHandled=true;if(!isEmpty(window.cordova)){isCordova=true}if(console&&console.log){console.log("Platform: "+navigator.platform);console.log("Cordova loaded:  "+isCordova)}if(!isParserLoaded){intervalParserChecker=setInterval(checkIfParserIsLoaded,2000)}}function checkIfMathJaxIsLoaded(){intervalCount--;if((typeof MathJax!=="undefined"&&MathJax!=null)||intervalCount<1){clearInterval(intervalMathJaxChecker);MathJax.Hub.Queue(["Typeset",MathJax.Hub]);console.log("MathJax Loaded and Document ready")}}function checkIfParserIsLoaded(){if(!isParserLoaded){if((typeof jsParser&&typeof jsParser.parseAndExecute!=="undefined"&&jsParser.parseAndExecute!=null)){isParserLoaded=true;clearInterval(intervalParserChecker);performInitialization();if(!isCordova){intervalSCORMChecker=setInterval(checkIfSCORMIsLoaded,5000)}if(console&&console.log){console.log("Parser Loaded and Document ready")}}else{if(console&&console.log){console.log("Waiting for Parser to be loaded...")}}}}function checkIfSCORMIsLoaded(){scormIntervalCount--;if(!isSCORMLoaded&&scormIntervalCount>1){var a=doInitialize();if(a=="true"){isSCORMLoaded=true;doSetValue("cmi.completion_status","incomplete");doSetValue("cmi.success_status","unknown");clearInterval(intervalSCORMChecker)}}else{clearInterval(intervalSCORMChecker);if(console&&console.log){console.log("Not connected to the Learning Management System")}if(isSCORMNeeded&&!isSCORMLoaded){alert("You are not connected to the Learning Management System.  Your score will not report.")}}if(window.console){console.log("SCORM Init Call returned "+a+". "+scormIntervalCount+" attempts remaining.")}}function performInitialization(){if(window.console){console.log("Performing initialization")}jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).startup();preFetch();setUpLinks();setUpParser();activateUnload();addJQueryFunctions();addInteractiveImage()}function preFetch(){var b=["lib/css/arrowLeft.png","lib/css/arrowLeft_down.png","lib/css/arrowLeft_gray.png","lib/css/arrowRight.png","lib/css/arrowRight_down.png","lib/css/arrowRight_gray.png"];for(var a=0;a<b.length;a++){var d=new Image();d.src=b[a]}}function setUpLinks(){$(document).on("click",".content a, .colorboxDiv a, .mPage a, .textBlock a",function(f){if($(f.target).parents(".jetTimeline").length){return}f.preventDefault();var e=f.target.href;var d=f.target.target;var a=/\(ID:(\d+)/.exec(e);var b=null;if(a&&a.length>1){b=a[1]}if(b){switch(d){case"_blank":jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,b);break;case"_overlay":jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE_RESOURCE,b);break;default:jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,b)}}else{window.open(f.target.href,"_blank","toolbar=yes, scrollbars=yes, resizable=yes, top=50, left=50, width=700, height=400")}})}function showLoadProgressBar(){hideJetWrapper(true);loadProgressDiv=document.createElement("div");document.body.appendChild(loadProgressDiv);loadProgressDiv.style.position="absolute";loadProgressDiv.style.width="150px";loadProgressDiv.style.height="150px";loadProgressDiv.style.top="20px";loadProgressDiv.style.right="0px";loadProgressDiv.style.opacity="50%";loadProgressDiv.style.borderRadius="100%";loadProgressDiv.style.backgroundColor="#4ba5e2";loadProgressDiv.style.zIndex="2000";loadProgressDiv.id="loadProgressDiv";var b="<canvas id='meterCanvas' width='150px' height=150px'></canvas>";loadProgressDiv.innerHTML=b;textReadoutDiv=document.createElement("div");loadProgressDiv.appendChild(textReadoutDiv);textReadoutDiv.style.position="absolute";textReadoutDiv.style.top="0px";textReadoutDiv.style.left="0px";textReadoutDiv.style.padding="50px";textReadoutDiv.style.fontSize="2EM";textReadoutDiv.style.fontWeight="bold";textReadoutDiv.style.textAlign="center";textReadoutDiv.style.opacity="100%";textReadoutDiv.style.color="white";textReadoutDiv.style.zIndex="10";textReadoutDiv.id="textReadoutDiv";var a=setInterval(function(){var e=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);if(!isEmpty(e)){e.sendNotification(jet.AppConstants.REQUEST_NAV_HIDE,null)}if(isFirstPageShown()){var d=e.retrieveMediator(jet.view.mediator.PageMediator.NAME);d.sendSettings();d.constructTOC();jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null);clearInterval(a);hideLoadProgressBar();hideJetWrapper(false);addGraphics()}},1000)}function setTotalNumberOfPages(a){totalNumberOfPages=a}function updatePagesLoaded(a){pagesLoaded=a;updateLoadProgressBar()}function getUniqueName(){var a=String(Math.random()*10000000);var b="LS_"+a.substring(0,6);return b}function hideJetWrapper(a){var b=getJetWrapper();if(a==true){$(b).hide()}else{$(b).fadeIn(1000)}}function updateLoadProgressBar(){var b=pagesLoaded/totalNumberOfPages;var d=b*2;var h=document.getElementById("meterCanvas");var a=h.getContext("2d");a.beginPath();a.arc(75,75,50,0,d*Math.PI);a.lineWidth=10;a.strokeStyle="#00FF00";a.stroke();var f=Math.floor(b*100)+"%";var e=document.getElementById("textReadoutDiv");e.innerHTML="<span>"+f+"</span>"}function hideLoadProgressBar(){document.body.removeChild(loadProgressDiv)}function setFirstPageShown(){firstPageShown=true}function isFirstPageShown(){var b=getSettings();if(b!=null&&b.lockCMI5!=null){var a=Number(b.lockCMI5);isCMINeeded=a>0?false:true}if(firstPageShown&&(!isCMINeeded||getCMI5Loaded())){return firstPageShown}return false}function setCMI5Loaded(a){if(window&&window.console){window.console.log("CMI5 Loaded")}isCMI5Loaded=a}function getCMI5Loaded(){return isCMI5Loaded}function setSettings(a){settings=a}function getSettings(){return settings}function postCurrentUID(a){currentUID=a}function qValidate(e){var b="";var d="AES_Encryption_2";var a="RandomInitVector";b=validate(e,d,a);return b}function validate(f,e,d){try{e=CryptoJS.enc.Utf8.parse(e);d=CryptoJS.enc.Utf8.parse(d);var a=CryptoJS.AES.decrypt(f,e,{iv:d});a=a.toString(CryptoJS.enc.Utf8);return a}catch(b){return""}}function hexToRgb(d){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;d=d.replace(b,function(f,k,h,e){return k+k+h+h+e+e});var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function getExposedMethods(){if(isEmpty(exposed)){exposed={}}return exposed}function playAudio(b){if(isEmpty(adHocAudio)){adHocAudio=new Audio()}else{adHocAudio.pause()}adHocAudio.src="base/audio/"+b;adHocAudio.load();var a=adHocAudio.play();if(a!==undefined&&a["catch"]){a["catch"](function(d){if(console&&console.log){console.log("Caught -> "+d.message)}})}}function pauseAudio(){if(isEmpty(adHocAudio)){adHocAudio=new Audio();return}else{var e=adHocAudio.pause()}if(e!==undefined&&e["catch"]){e["catch"](function(f){if(console&&console.log){console.log("Caught -> "+f.message)}})}var d=document.getElementsByTagName("audio");for(var b=0,a=d.length;b<a;b++){d[b].pause()}}function pauseVideo(){doNotify(jet.AppConstants.PAUSE_VIDEO)}function pauseIFrame(){var a=$("iframe");$(a).each(function(){var b=$(this).attr("src");$(this).attr("src","");$(this).attr("src",b)})}function stopTimer(a){var b=getJetValue(a);if((!isEmpty(b)&&!isNaN(b))){clearInterval(b);setJetValue(a,"");if(console&&console.log){console.log("Timer "+b);console.log("Timer "+a+" stopped.")}}}function beep(){var a=new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");var b=a.play();if(b!==undefined&&b["catch"]){b["catch"](function(d){if(console&&console.log){console.log("Caught -> "+d.message)}})}}function getUserScore(){doNotify(jet.AppConstants.GET_REPORT);var a=getJetValue("system_report");if(!isEmpty(a)&&!isEmpty(a.userTotal)){return a.userTotal}}function getTotalScore(){doNotify(jet.AppConstants.GET_REPORT);var a=getJetValue("system_report");if(!isEmpty(a)&&!isEmpty(a.scoreTotal)){return a.scoreTotal}}function getDay(){var a=new Date();return a.getDate()}function getMonth(){var a=new Date();return a.getMonth()+1}function getYear(){var a=new Date();return a.getFullYear()}function getTime(){var a=new Date();var b=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();return b}function disableDraggable(a){var b=$("#"+a);if(isEmpty(b)){return}$(b).draggable("disable")}function enableDraggable(a){var b=$("#"+a);if(isEmpty(b)){return}$(b).draggable("enable")}function processDragElement(n,k,h){makeDraggableAccessible(n);var u=null;var b=0;var s=0;var d=0;var q=0;var a=false;var l=null;var r=null;var f="";try{u=JSON.parse(k)}catch(p){}var t="none";var r="none";if(u&&u.dropTarget){var m=u.dropTarget;var o=m.split("\t");if(o.length>=3){t=o[2]}}if(u&&u.dragConstraints){var m=u.dragConstraints;var o=m.split("\t");if(o.length>=3){r="#"+o[2];a=true}}if(u&&u.dragAxis){var m=u.dragAxis;if(!isEmpty(m)){f=m}}var e=$(n).prop("tagName").toLowerCase();switch(e){case"text":$(n).css("user-select","none");break;case"g":case"image":case"rect":break;case"ellipse":case"circle":xProp="cx";yProp="cy";break;case"line":case"path":return;case"img":case"svg":case"div":$(n).draggable({stop:function(v,w){v.stopPropagation();if(t.trim()=="none"||(!isEmpty(t)&&elementsOverlap(this,$("#"+t).get(0)))){h()}},axis:f,containment:r});$(n).attr("aria-haspopup","true");return;default:return}$(n).draggable({start:function(y,z){var v=getGroup($(this));var C=v.get(0);var w=v.parents("svg");var B=getMousePosition(w,y);var x=C.transform.baseVal;if(x.length===0||x.getItem(0).type!==SVGTransform.SVG_TRANSFORM_TRANSLATE){var A=$(w).get(0).createSVGTransform();A.setTranslate(0,0);C.transform.baseVal.insertItemBefore(A,0)}transform=x.getItem(0);B.x-=transform.matrix.e;B.y-=transform.matrix.f;v.attr("data-offsetX",B.x);v.attr("data-offsetY",B.y)},drag:function(v,F){var H=getGroup($(this));var A=H.get(0);var B=H.parents("svg");var D=A.transform.baseVal;var w=D.getItem(0);var C=getMousePosition(B,v);var z=Number(H.attr("data-offsetX"));var y=Number(H.attr("data-offsetY"));if(a){var x=$(r).get(0);var G=getBounds(x);b=G.x;s=G.width;d=G.y;q=G.height;var E=H.get(0);l=getBounds(E);minX=b-l.x;maxX=b+s-l.x-l.width;minY=d-l.y;maxY=d+q-l.y-l.height;var J=C.x-z;var I=C.y-y;if(J<minX){J=minX}else{if(J>maxX){J=maxX}}if(I<minY){I=minY}else{if(I>maxY){I=maxY}}I=f=="x"?0:I;J=f=="y"?0:J;registerPosition(E,x,$(B).get(0),f);w.setTranslate(J,I)}else{registerPosition(H.get(0),null,$(B).get(0),f);w.setTranslate(C.x-z,C.y-y)}},stop:function(w,x){var v=getGroup($(this));var y=$(v).get(0);if(t.trim()=="none"||(!isEmpty(t)&&elementsOverlap(y,$("#"+t).get(0)))){h.apply()}}});$(n).attr("aria-haspopup","true")}function addToArray(a,l,h,k){var f=null;var m=getJetValue(a);if(Array.isArray(m)){f=m}else{f=new Array();setJetValue(a,f);var d=getJetValue(a)}if(h){var b=f.length;var e=Math.ceil((b-k)*0.5);if(e>-1&&e<f.length){f.splice(e,0,l)}else{f.push(l)}f.push(l)}else{f.push(l)}console.log(">>"+f.length)}function addToArray(b,e){var d=null;var a=getJetValue(b);if(Array.isArray(a)){d=a}else{d=new Array();setJetValue(b,d);var f=getJetValue(b)}d.push(e);console.log(">>"+d.length)}function changeColor(f,a){var e=$("#"+f);if(isEmpty(e)){return}var b=$(e).prop("tagName").toLowerCase();switch(b){case"rect":case"ellipse":case"circle":case"text":case"path":$(e).css("fill",a);break;case"line":$(e).css("stroke",a);break;case"image":case"img":if(a!="none"){var d="opacity(0.50) drop-shadow(0 0 0 "+a+")";$(e).css("filter",d)}else{$(e).css("filter","none")}break;case"div":$(e).css("background-color",a);break;default:}}function changeOpacity(d,a){var b=$("#"+d);if(isEmpty(b)){return}$(b).css("opacity",a)}function changeZindex(d,a){var b=$("#"+d);if(isEmpty(b)){return}$(b).css("z-index",a)}function changeScale(h,d,f,b,a){var e=$("#"+h);if(isEmpty(e)){return}if(!isNaN(b)&&!isNaN(a)){$(e).css("transform","translate("+-1*b+"px,"+-1*a+"px) scale("+d+","+f+") translate("+b+"px,"+a+"px)")}else{$(e).css("transform","scale("+d+","+f+")")}}function changeTranslate(e,a,d){var b=$("#"+e);if(isEmpty(b)){return}$(b).css("transform","translate("+a+"px,"+d+"px)")}function changeImage(a,b){var e=$("#"+a);var d=$("#"+b);if(isEmpty(e)||isEmpty(d)){return}var f=$(d).attr("src");$(e).attr("src",f);$(e).attr("href",f)}function changeText(d,a){var b=$("#"+d);if(isEmpty(b)){return}if($(b).val){$(b).val(a)}if($(b).text){$(b).text(a)}}function animate(e,a,d){var b=$("#"+e);if(isEmpty(b)){return}if(!isObject(a)){a=JSON.parse(a)}$(b).css("position","absolute");$(b).animate(a,d)}function animatePosition(k,b,a,e,d,h){var f=$("#"+k);if(isEmpty(f)){return}$(f).css("position","absolute");$(f).css("left",b);$(f).css("top",a);$(f).animate({left:e,top:d},h)}function animateOpacity(e,a,d){var b=$("#"+e);if(isEmpty(b)){return}$(b).animate({opacity:a},d)}function show(b){var a=$("#"+b);if(isEmpty(a)){return}$(a).show()}function hide(b){var a=$("#"+b);if(isEmpty(a)){return}$(a).hide()}function changePosition(n,o,e){e=e.toLowerCase();var w=$("#"+n);if(isEmpty(w)){return}o=isEmpty(o)?0:o;var q=getProp(n,"hTrackLength");q=isEmpty(q)?1:q;var k=getProp(n,"vTrackLength");k=isEmpty(k)?1:k;var h=getProp(n,"xPos");h=isEmpty(h)?0:h;var m=getProp(n,"yPos");m=isEmpty(m)?0:m;var a=false;if($(w).data("draggable")){switch(e){case"x":var b=Number(h)*Number(q);var l=Number(o)*Number(q);var s=l-b;$(w).simulate("drag",{dx:s});setProp(n,"xPos",o);break;case"y":var p=Number(m)*Number(k);var l=Number(o)*Number(k);var s=-1*(l-p);$(w).simulate("drag",{dy:s});setProp(n,"yPos",o);break;default:break}}else{var d=$(w).get(0);var f="";if(d.prop){f=d.prop("tagName").toLowerCase()}else{f=d.tagName.toLowerCase()}switch(f){case"rect":case"ellipse":case"circle":case"text":case"path":case"image":case"line":var v=$(w).attr("data-oldTranslateX");v=isEmpty(v)?0:v;var u=$(w).attr("data-oldTranslateY");u=isEmpty(u)?0:u;switch(e){case"x":var r=(o*100)+"%";$(w).css("transform","translate("+r+","+u+")");$(w).attr("data-oldTranslateX",r);break;case"y":var t=(o*100)+"%";$(w).css("transform","translate("+v+","+t+")");$(w).attr("data-oldTranslateY",t);break;default:break}break;case"div":case"img":$(w).css("position","absolute");switch(e){case"x":var r=(o*100)+"%";$(w).css("left",r);break;case"y":var t=(o*100)+"%";$(w).css("top",t);break;default:break}break;default:}}}function changeRotation(l,f,e,d){if(isEmpty(e)||isEmpty(d)){rotate(l,f)}else{var b=e+"% "+d+"%";var h=$("#"+l);if(isEmpty(h)){return}var k=isSVGElement(h);if(k){var a="rotate("+f+"deg)";$(h).css("transform-origin",b);$(h).css("transform",a)}else{f=isEmpty(f)?0:f;$(h).css("transform-origin",b);$(h).css("transform","rotate("+f+"deg)")}}}function rotate(a,o){var f=$("#"+a);var q=isSVGElement(f);if(q){f=$(f).get(0);var p=getSVGDoc(f);var r=$(p).get(0).width.baseVal.value;var e=$(p).get(0).height.baseVal.value;var b=f.getBBox().width;var s=f.getBBox().height;var n=f.x.baseVal.value;var l=f.y.baseVal.value;var h=((n+b/2)/r)*100;var d=((l+s/2)/e)*100;var m=h+"% "+d+"%";if(isEmpty(f)){return}var k="rotate("+o+"deg)";$(f).css("transform-origin",m);$(f).css("transform",k)}else{var p=$(f).parent().get(0);var r=$(p).css("width");var e=$(p).css("height");var b=$(f).css("width");var s=$(f).css("height");var n=$(f).css("left");var l=$(f).css("top");var h=((n+b/2)/r)*100;var d=((l+s/2)/e)*100;var m=h+"% "+d+"%";var f=$("#"+a);if(isEmpty(f)){return}o=isEmpty(o)?0:o;$(f).css("transform-origin",m);$(f).css("transform","rotate("+o+"deg)")}}function getSVGDoc(b){if($(b).prop("tagName")!="svg"){var a=$(b).parent();return getSVGDoc(a)}else{return b}}function setProp(f,a,e){var d=getJetValue(f);if(typeof d=="object"){d[a]=e;setJetValue(f,d)}else{var b={x:null,y:null,position:null};b[a]=e;setJetValue(f,b)}}function getProp(d,a){var b=getJetValue(d);if(typeof b=="object"&&!isEmpty(b)){return b[a]}else{return null}}function sendXAPIStatement(b,a){if(typeof doSendXAPIStatement==="function"){doSendXAPIStatement(b,a)}}function doNotify(b,a){if(a&&a.length>0){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(b,a)}else{jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(b)}}function testParser(){if(ParserApiHooks!=undefined&&ParserApiHooks.execute!=undefined){var d="Go Forward()";try{var b=ParserApiHooks.parse(d);var a=ParserApiHooks.execute(b);clearInterval(intervalID)}catch(f){window.alert(f)}}}function initSCORM(){var a=doInitialize();if(window.console){console.log("SCORM Init Call returned "+a)}}function setIsSCORMNeeded(a){isSCORMNeeded=a}function setProjectSettings(b){if(b!=null){if(b.displayScormWarning!=null){var a=b.displayScormWarning=="0"?true:false;setIsSCORMNeeded(a)}}}function activateUnload(){$(window).on("beforeunload",function(b){var a=doTerminate();if(window.console){console.log("doTerminate returns "+a)}})}function setUpSwipeGesture(){$(document).on("ontouchstart","div.navigator",function(a){touchStart(a,"navigator")})}var jetData={};function setJetValue(a,b){if(isNaN(b)||Array.isArray(b)){jetData[a]=b}else{b=parseFloat(b);jetData[a]=b}}function appendJetValue(b,d){if(isNaN(d)){var a=jetData[b];if(isEmpty(a)){jetData[b]=d}else{jetData[b]=a+d}}else{d=parseFloat(d);if(jetData[b]==undefined){jetData[b]=0}var a=jetData[b];jetData[b]=a+d}}function getJetValue(a){return jetData[a]}function setJetStore(a){var a=JSON.parse(a);if(typeof a=="object"){jetData=a}}function getJetStore(){if(isEmptyObject(jetData)){return""}try{var b=JSON.stringify(jetData);return b}catch(a){return""}}function clearJetStore(){jetData={}}function isEmptyObject(a){for(var b in a){if(Object.prototype.hasOwnProperty.call(a,b)){return false}}return true}function getJetWrapper(){if($(".jetWrapper").length){return $(".jetWrapper")}else{return $("body")}}function addToSet(b,d){if(!isEmpty(getSet(b))){var e=getSet(b);e[d]="true"}else{var a={};a[d]="true";addSet(b,a)}}function restoreToFlowByID(a){doNotify(jet.AppConstants.REQUEST_RESTORE_TO_FLOW_BY_ID,a)}function initGoogleMap(){var a=new google.maps.LatLng(45,-93.910965);googleMap=new google.maps.Map(document.getElementById("mapDiv"),{center:a,scrollwheel:false,zoom:8,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:["roadmap","terrain","satellite"]},});if(console&&console.log){console.log("GMaps loaded...")}}function getInfoWindowInstance(){if(infoWindowInstance==null&&!isEmpty(googleMap)){infoWindowInstance=new google.maps.InfoWindow()}return infoWindowInstance}function getOuterBackgroundColor(a){if(outerBackgroundColor!=null){$(a).css("color",getContrastYIQ(outerBackgroundColor));return}var b=this;$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(d){$(d).find("outerBgColor").each(function(){var e=$(this).text();$(a).css("color",b.getContrastYIQ(e));outerBackgroundColor=e})},error:function(){}})}function getContrastYIQ(h){h=h.substring(1);var e=parseInt(h.substr(0,2),16);var d=parseInt(h.substr(2,2),16);var a=parseInt(h.substr(4,2),16);var f=((e*299)+(d*587)+(a*114))/1000;return(f>=128)?"black":"white"}function rgb2hex(a){try{rgbM=a.match(/^rgb.?(\d*),*(\s\d*),*(\s\d*).?/);return"#"+("0"+parseInt(rgbM[1],10).toString(16)).slice(-2)+("0"+parseInt(rgbM[2],10).toString(16)).slice(-2)+("0"+parseInt(rgbM[3],10).toString(16)).slice(-2)}catch(b){return""}}function hex2rgbaComponents(e){if(e&&e.length==9){var d=e;var k=parseInt(d.slice(1,3),16);var f=parseInt(d.slice(3,5),16);var b=parseInt(d.slice(5,7),16);var h=parseInt(d.slice(7,9),16)/255;var a=[k,f,b,h]}else{var d=e;var k=parseInt(d.slice(1,3),16);var f=parseInt(d.slice(3,5),16);var b=parseInt(d.slice(5,7),16);var a=[k,f,b]}return a}function hex2rgba(e){if(e.length==9){var d=e;var k=parseInt(d.slice(1,3),16);var f=parseInt(d.slice(3,5),16);var b=parseInt(d.slice(5,7),16);var h=parseInt(d.slice(7,9),16)/255;var a="rgba("+k+","+f+","+b+","+h+")"}else{var d=e;var k=parseInt(d.slice(1,3),16);var f=parseInt(d.slice(3,5),16);var b=parseInt(d.slice(5,7),16);var a="rgb("+k+","+f+","+b+")"}return a}function rgbToHsl(a,m,o){a/=255,m/=255,o/=255;var p=Math.max(a,m,o),f=Math.min(a,m,o);var k,q,e=(p+f)/2;if(p==f){k=q=0}else{var n=p-f;q=e>0.5?n/(2-p-f):n/(p+f);switch(p){case a:k=(m-o)/n+(m<o?6:0);break;case m:k=(o-a)/n+2;break;case o:k=(a-m)/n+4;break}k/=6}return[k,q,e]}function stripSpaces(a){a=a.replace(/\s+/g,"");return a}function stripNonAlphaNumeric(a){a=a.replace(/([^A-Z a-z 0-9])+ /g," ");return a}function stripTerminatingCharacter(b,a){if(b.charAt(b.length-1)==a){return b.substring(0,b.length-1)}else{return b}}function stripQuotes(a){a=a.replace(/[\"|\']/g,"");return a}function addJQueryFunctions(){$.fn.redraw=function(){return $(this).each(function(){var a=this.offsetHeight;$(window).resize()})}}function convertHexToString(b){var a=b.toString();var d="";for(var e=0;e<a.length;e+=2){d+=String.fromCharCode(parseInt(a.substr(e,2),16))}return d}function addInteractiveImage(){$("body").on("click",".zoomable",expandImage);$("body").on("hover",".zoomable",handleHover)}function addGraphics(){doNotify(jet.AppConstants.REQUEST_HEADER_BACKGROUND)}function expandImage(){var f=$(this).attr("data-isExpanded");if(f=="true"){var b=$(this).attr("data-tempHeight");var a=$(this).attr("data-tempWidth");var e=$(this).attr("data-leftMargin");$(this).css("cursor","zoom-in");$(this).css("margin-left",e);$(this).width(a);$(this).height(b);$(this).attr("data-isExpanded","false")}else{var b=$(this).height();var a=$(this).width();$(this).width("100%");$(this).height("auto");var d=$(this).css("margin-left");$(this).attr("data-tempHeight",b);$(this).attr("data-tempWidth",a);$(this).attr("data-isExpanded","true");$(this).attr("data-leftMargin",d);$(this).css("cursor","zoom-out")}}function handleHover(){$(this).css("cursor","zoom-in")}function isEmpty(a){if(a!=null&&typeof a!="undefined"&&a!=""&&a!="undefined"&&a===a){return false}else{return true}}function isObject(a){return a&&typeof a==="object"&&a.constructor===Object}function printPage(d){var n=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);pageMediator=n.retrieveMediator(jet.view.mediator.PageMediator.NAME);var e=pageMediator.getPageByLabel(d);var h=e.node.getContentDiv();var b=$(h);var k=$(b).find(".text").first().html();var m=window.location.pathname;var f=m.lastIndexOf("/");m=m.substring(0,f)+"/";var l=window.open("Certificate","","height=785, width=875");l.document.write("<html>");l.document.write("<head>");l.document.write("<base href='"+m+"'>");l.document.write("</head>");l.document.write("<body > ");l.document.write(k);l.document.write("</body></html>")}function getSet(a){return jetData[a]}function addSet(b,a){jetData[b]=a}function getMousePosition(b,a){var d=b.get(0).getScreenCTM();return{x:(a.clientX-d.e)/d.a,y:(a.clientY-d.f)/d.d}}function getGroup(b){var a=b.parents("g");var d=b;$(a).each(function(){var e=$(this).get(0).getAttribute("class");if(e!="layer"){d=$(this)}});return d}function isOverlap(f,e){var b=false;var d=$("#"+f).get(0);var a=$("#"+e).get(0);b=elementsOverlap(d,a);return b}function elementsOverlap(f,e){var b=false;var d=f.getBoundingClientRect();var a=e.getBoundingClientRect();b=!(d.right<a.left||d.left>a.right||d.bottom<a.top||d.top>a.bottom);return b}function getBounds(a){if(a.getBBox!=undefined){return a.getBBox()}else{return a.getBoundingClientRect()}}function showToolTip(b,a,e){var d={htmlString:b,xpos:a,ypos:e};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_TOOLTIP,d)}function hideToolTip(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_CLOSE_TOOLTIP)}function getPosition(h){var b=$("#"+h);if(isEmpty(b)){return}var f=isSVGElement(b);if(b&&b.x&&b.x.baseVal&&b.x.baseVal.value){var e=b.x.baseVal.value;var d=b.y.baseVal.value;var a={left:e,top:d};return a}else{var a=$(b).offset();return a}}function registerPosition(q,f,l,k){var b=isEmpty(f)?l:f;var s=getBounds(b);var m=getBounds(q);var h=getLeftPosition(q);var n=h-s.x;var a=s.width-m.width;var o=n/a*1;o=round(o,2);setProp(q.getAttribute("id"),"xPos",o);setProp(q.getAttribute("id"),"hTrackLength",a);var p=getTopPosition(q);var e=p-s.y;var r=s.height-m.height;var d=1-(e/r*1);d=round(d,2);setProp(q.getAttribute("id"),"yPos",d);setProp(q.getAttribute("id"),"vTrackLength",r);setProp(q.getAttribute("id"),"axis",k)}function getLeftPosition(d){var b=d.tagName;var h=d.transform.baseVal;var a=h.getItem(0);var f=a.matrix.e;switch(b){case"ellipse":return Number($(d).attr("cx"))+f-(Number($(d).attr("rx")));break;case"circle":return Number($(d).attr("cx"))+f-(Number($(d).attr("rx")));break;default:var e=Number($(d).attr("x"));var k=Number($(d).attr("width"));return e+f}}function getTopPosition(e){var d=e.tagName;var f=e.transform.baseVal;var a=f.getItem(0);var k=a.matrix.f;switch(d){case"ellipse":return Number($(e).attr("cy"))+k-(Number($(e).attr("ry")));break;case"circle":return Number($(e).attr("cy"))+k-(Number($(e).attr("ry")));break;default:var b=Number($(e).attr("y"));var h=Number($(e).attr("height"));return b+k}}function makeDraggableAccessible(a){$(a).attr("aria-grabbed","false");$(a).attr("aria-haspopup","true");$(a).keyup(function(b){globaldndWidget.keyboardHandler(b,globaldndWidget);b.stopPropagation()})}function createMenu(b,a,e){var f=document.createElement("ul");$(f).attr("data-dragItem",$(b).attr("alt"));$(f).addClass("dndMenu");$(f).attr("id","dndMenu");$(f).attr("role","menu");$(f).css("padding-left","60px");$(f).css("padding-right","10px");$(f).css("padding-top","10px");$(f).css("padding-bottom","10px");$(f).css("position","relative");$(f).css("width","50%");$(f).css("background-color","white");$(f).css("border","2px solid white");$(f).css("outline","1px solid black");for(var d=0;d<a.length;d++){item=a[d];objChoice=document.createElement("li");objChoice.appendChild(document.createTextNode(item));$(objChoice).attr("role","listitem");$(objChoice).addClass("dndMenuItem");$(objChoice).attr("tabindex","0");$(objChoice).on("focus",function(){});f.appendChild(objChoice)}$(f).on("keyup",function(h){e.keyboardHandler(h,e,item)});$(f).insertAfter(b);$(f).css("display","none");return f}function showMenu(b,e,d){if(e==true){var a=getTargets(b);var f=createMenu(b,a,globaldndWidget);$(f).css("display","block");$(f).css("background-color","#171717");$(f).css("color","white");$(f).find("li").removeClass("focus");d.menuHeight=$(f).height();return f}else{$(".dndMenu").empty();$(".dndMenu").remove()}}function isMenuShowing(){if($(".dndMenu").css("display")=="block"){return true}else{return false}}function getTargets(d){var b=[];var e=$(d).parents(".page");if(isEmpty(e)){return b}var a=$(e).find("[alt]");$(a).each(function(){var f=$(this).attr("alt");if(!isEmpty(f)){b.push(f)}});return b}function keyboardHandler(m,l,o){if(m.stopPropogation){m.stopPropogation()}if($(m.target).hasClass("ui-draggable")||$(m.target).hasClass("dndMenuItem")){var b=m.keyCode;var k=m.target;var f=$(k).offset();var h=l.isMenuShowing();console.log(h);switch(h){case false:var e="20px";switch(b){case 32:$(k).attr("aria-owns","dndMenu");var d=l.showMenu(k,true,l);if(d!=null){$(d).css("top",e);$(l.currentItem).after(d);var a=$(d).find("li").first();$(a).focus()}break}break;case true:if(m.preventDefault){m.preventDefault()}m=m||window.event;var k=m.target||m.srcElement;var b=m.keyCode;switch(b){case 40:objFocus=k.nextSibling;if(!objFocus){objFocus=$(k).parent().find("li").first()}objFocus.focus();break;case 38:objFocus=k.previousSibling;if(!objFocus){objFocus=$(k).parent().find("li").last()}objFocus.focus();break;case 13:var n="";var d=$(k).parent();if(d){n=$(d).attr("data-dragItem")}l.moveItem(l,n,k);l.resetFocus(l);break;case 27:$(l.currentItem).removeAttr("aria-owns");$(l.currentItem).removeAttr("aria-dropeffect");$(l.currentItem).attr("aria-grabbed","false");l.showMenu(null,false,l);l.resetFocus(l);break}break}}}function moveItem(l,m,a){var n=$(a).parents(".page");var d=$(a).text();var o=$(n).find("*[alt='"+m+"']").get(0);var f=$(n).find("*[alt='"+d+"']").get(0);var e=getCumulativeOffset(o);var b=getCumulativeOffset(f);var h=-1*(e.top-b.top);var k=-1*(e.left-b.left);$(o).simulate("drag",{dx:k,dy:h})}function resetFocus(a){}function getCumulativeOffset(a){var e=0,d=0;do{var b=a.getBoundingClientRect();e+=b.top||0;d+=b.left||0;a=a.offsetParent}while(false);return{top:e,left:d}}function isSVGElement(b){var a=$(b).prop("tagName").toLowerCase();switch(a){case"text":case"g":case"image":case"rect":case"ellipse":case"circle":case"line":case"path":return true;default:return false}}function preventPageHide(k,l,b,h,f,n){var m=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var e=m.retrieveMediator(jet.view.mediator.PageMediator.NAME);var d=e.getPageByLabel(k);d.node.setManualHide(l);if(l&&d.node.getDiv&&d.node.getDiv()!=null){var a=d.node.getDiv();$(a).css("position","absolute");$(a).css("left",b+"%");$(a).css("top",h+"%");$(a).css("min-height","0");$(a).css("height","auto");$(a).css("overflow","hidden");$(a).css("background","rgba(255, 255, 255, 0");$(a).css("z-index",f);if(n=="true"){$(a).css("pointer-events","auto")}else{$(a).css("pointer-events","none")}d.node.show(true)}else{$(a).css("position","static");$(a).css("z-index",0);$(a).css("pointer-events","auto");d.node.show(false)}}function showAsLayer(b,m,e,l,k,o){var n=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var h=n.retrieveMediator(jet.view.mediator.PageMediator.NAME);var d=h.getNode(b);if(d==null){var f=h.getPageByLabel(b);if(f!=null){d=f.node}}if((m==true||m=="show"||m=="true")&&d&&d.getDiv&&d.getDiv()!=null){d.setIsLayer(true);var a=d.getDiv();$(a).css("position","absolute");$(a).css("left",e+"%");$(a).css("top",l+"%");$(a).css("min-height","0");$(a).css("height","auto");$(a).css("overflow","hidden");$(a).css("background","rgba(255, 255, 255, 0");$(a).css("z-index",k);if(o=="true"||o==true){$(a).css("pointer-events","auto")}else{$(a).css("pointer-events","none")}d.show(true)}else{if(m=="show once"&&d&&d.getDiv&&d.getDiv()!=null){var a=d.getDiv();$(a).css("position","absolute");$(a).css("left",e+"%");$(a).css("top",l+"%");$(a).css("min-height","0");$(a).css("height","auto");$(a).css("overflow","hidden");$(a).css("background","rgba(255, 255, 255, 0");$(a).css("z-index",k);if(o=="true"||o==true){$(a).css("pointer-events","auto")}else{$(a).css("pointer-events","none")}d.show(true)}else{if(d&&d.setIsLayer){d.setIsLayer(false);$(a).css("position","static");$(a).css("z-index",0);$(a).css("pointer-events","auto");d.show(false)}}}}function round(b,a){var d=Math.pow(10,a);return Math.round(b*d)/d}function updateEmbeddedVariableWidget(e){var a="div[id="+e+"]";var d=$(a);var b=$(d).parents(".WidgetPage").first();$(b).attr("data-updated",false)}function executePageCalcOptions(a){var e=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var b=e.retrieveMediator(jet.view.mediator.PageMediator.NAME);var f=b.getPageByLabel(a);var d=f.node.getCalcOptions();if(d!=null&&typeof d!="undefined"){f.node.setBranchOptions(d);b.processFeedbackAndBranchingOptions(f.node,true,d)}}function generateRandomNumbers(e){var a=[];for(var b=0;b<e;b++){a.push(b)}for(var b=a.length-1;b>0;b--){var f=a[b];var d=parseInt(Math.random()*(b+1));a[b]=a[d];a[d]=f}return a}function showTOC(a){if(a==1){doNotify(jet.AppConstants.SHOW_TOC)}else{doNotify(jet.AppConstants.HIDE_TOC)}}function toLowerCase(a){return a.toLowerCase()}function toUpperCase(a){return a.toUpperCase()}function findIn(a,b){return a.search(b)}function updateAnimator(h,a,d,f,e,b,k,l){if(isEmpty(a)){a="play"}if(isEmpty(d)){d=null}if(isEmpty(f)){f="10"}if(isEmpty(e)){e="1"}if(isEmpty(b)){b="1"}if(isEmpty(l)){l="0"}var m={uid:h,state:a,duration:f,currentTime:d,iterations:e,playbackRate:b,onFinish:k,iterationStart:l};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.UPDATE_ANIMATORS,m)}function setGadget(b){var a=$("#"+b);$(a).css("position","fixed");$(a).css("bottom","10px");$(a).css("width","200px");$(a).css("height","auto");$(a).css("left","50%");$(a).css("margin-top","-75px");$(a).css("margin-left","-100px");$(a).css("z-index","100");$(".jetWrapper").append(a)}function setUpParser(){var a=getExposedMethods();a.Math=Math;a.convertToString=function(b){return new String(b).toString()};a["Math.ceil"]=function(b){return Math.ceil(b)};a["Math.floor"]=function(b){return Math.floor(b)};a["Math.round"]=function(b){return Math.round(b)};a["Math.random"]=function(){return Math.random()};a.message=function(b){var d=String(b);window.alert(d)};a.Message=function(b){var d=String(b);window.alert(d)};a.concatenate=function(d,b){return d.concat(b)};a.gotonextpage=function(){doNotify(jet.AppConstants.REQUEST_NEXT_PAGE)};a.goToNextPage=function(){doNotify(jet.AppConstants.REQUEST_NEXT_PAGE)};a.gotopreviouspage=function(){doNotify(jet.AppConstants.BACK)};a.goToPreviousPage=function(){doNotify(jet.AppConstants.BACK)};a.jumptopage=function(b){doNotify(jet.AppConstants.JUMP_TO_PAGE,b)};a.jumpToPage=function(b){doNotify(jet.AppConstants.JUMP_TO_PAGE,b)};a.openurl=function(b){doNotify(jet.AppConstants.OPEN_URL,b)};a.openUrl=function(b){doNotify(jet.AppConstants.OPEN_URL,b)};a.addoverlay=function(b){doNotify(jet.AppConstants.ADD_OVERLAY,b)};a.addOverlay=function(b){doNotify(jet.AppConstants.ADD_OVERLAY,b)};a.setvalue=function(d,b){setJetValue(d,b)};a.setValue=function(d,b){setJetValue(d,b)};a.appendvalue=function(d,b){appendJetValue(d,b)};a.appendValue=function(d,b){appendJetValue(d,b)};a.getvalue=function(b){return getJetValue(b)};a.getValue=function(b){return getJetValue(b)};a.getValueAsString=function(d){var b=String(getJetValue(d));return b};a.getvalueasstring=function(d){var b=String(getJetValue(d));return b};a.getValueAsNumber=function(d){var b=Number(getJetValue(d));return b};a.getvalueasnumber=function(d){var b=Number(getJetValue(d));return b};a.resetpage=function(){doNotify(jet.AppConstants.REQUEST_RESET_PAGE)};a.resetPage=function(){doNotify(jet.AppConstants.REQUEST_RESET_PAGE)};a.resetpagebyid=function(b){doNotify(jet.AppConstants.REQUEST_RESET_PAGE,b)};a.resetPageById=function(b){doNotify(jet.AppConstants.REQUEST_RESET_PAGE,b)};a.resetallinteractivity=function(){doNotify(jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY)};a.resetAllInteractivity=function(){doNotify(jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY)};a.removefromflow=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW)};a.removeFromFlow=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW)};a.removefromflowbyid=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,b)};a.removeFromFlowById=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,b)};a.restoretoflowbyid=function(b){restoreToFlowByID(b)};a.restoreToFlowById=function(b){restoreToFlowByID(b)};a.addtoresources=function(b){doNotify(jet.AppConstants.REQUEST_ADD_RESOURCE,b)};a.addToResources=function(b){doNotify(jet.AppConstants.REQUEST_ADD_RESOURCE,b)};a.removefromresources=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_RESOURCE,b)};a.removeFromResources=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_RESOURCE,b)};a.removeallresources=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_ALL_RESOURCES)};a.removeAllResources=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_ALL_RESOURCES)};a.updateprogressbar=function(e,d){var b={value:e,max:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,b)};a.updateProgressBar=function(e,d){var b={value:e,max:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,b)};a.suspenddata=function(){doNotify(jet.AppConstants.REQUEST_SUSPEND_DATA)};a.suspendData=function(){doNotify(jet.AppConstants.REQUEST_SUSPEND_DATA)};a.retrieveData=function(e,d){var b={successPage:e,failPage:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_RETRIEVE_DATA,b)};a.retrievedata=function(e,d){var b={successPage:e,failPage:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_RETRIEVE_DATA,b)};a.cleardata=function(){doNotify(jet.AppConstants.REQUEST_CLEAR_JET_DATA)};a.clearData=function(){doNotify(jet.AppConstants.REQUEST_CLEAR_JET_DATA)};a.setcompletionstatus=function(b){doNotify(jet.AppConstants.SET_COMPLETION_STATUS,b)};a.setCompletionStatus=function(b){doNotify(jet.AppConstants.SET_COMPLETION_STATUS,b)};a.setCustomUserScore=function(b){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_CUSTOM_USER_SCORE,b)};a.setCustomTotalScore=function(b){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_CUSTOM_TOTAL_SCORE,b)};a.updateGadget=function(d,e){var b={name:d,valueObject:e};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,b)};a.updategadget=function(d,e){var b={name:d,valueObject:e};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,b)};a.addToSet=function(b,d){addToSet(b,d)};a.addtoset=function(b,d){addToSet(b,d)};a.getSet=function(b){if(!isEmpty(getSet(b))){var d=getSet(b);return d}};a.getset=function(b){if(!isEmpty(getSet(b))){var d=getSet(b);return d}};a.removeFromSet=function(d,b){if(!isEmpty(getSet(d))){var e=getSet(d);delete e[b]}};a.setContains=function(f,h){if(!isEmpty(getSet(f))){var k=getSet(f);var b=h.split(",");for(var d=0;d<b.length;d++){var e=b[d];if(isEmpty(k[e])){return false}}}else{return false}return true};a.removefromset=function(d,b){if(!isEmpty(getSet(d))){var e=getSet(d);delete e[b]}};a.setcontains=function(f,h){if(!isEmpty(getSet(f))){var k=getSet(f);var b=h.split(",");for(var d=0;d<b.length;d++){var e=b[d];if(isEmpty(k[e])){return false}}}else{return false}return true};a.isequalto=function(d,b){d=d.toLowerCase().trim();b=b.toLowerCase().trim();if(d==b){return"true"}else{return"false"}};a.matches=function(e,d,b){if(isEmpty(e)){e=""}if(isEmpty(d)){d=""}e=$.trim(e);d=$.trim(d);if(!b){if(e.length>0){e=e.toLowerCase().replace("/ /g","")}if(d.length>0){d=d.toLowerCase().replace("/ / g","")}if(e==d){return true}else{return false}}else{if(e==d){return true}else{return false}}};a.isempty=function(b){return isEmpty(b)};a.isEmpty=function(b){return isEmpty(b)};a.playaudio=function(b){playAudio(b)};a.playAudio=function(b){playAudio(b)};a.pauseaudio=function(){pauseAudio()};a.pauseAudio=function(){pauseAudio()};a.pausevideo=function(){pauseVideo()};a.pauseVideo=function(){pauseVideo()};a.pauseiframe=function(){pauseIFrame()};a.pauseIFrame=function(){pauseIFrame()};a.stopTimer=function(b){stopTimer(b)};a.stoptimer=function(b){stopTimer(b)};a.beep=function(){beep()};a.getUserScore=function(){return getUserScore()};a.getuserscore=function(){return getUserScore()};a.getTotalScore=function(){return getTotalScore()};a.gettotalscore=function(){return getTotalScore()};a.getDay=function(){return getDay()};a.getday=function(){return getDay()};a.getMonth=function(){return getMonth()};a.getmonth=function(){return getMonth()};a.getYear=function(){return getYear()};a.getyear=function(){return getYear()};a.getTime=function(){return getTime()};a.gettime=function(){return getTime()};a.disableDraggable=function(b){disableDraggable(b)};a.disabledraggable=function(b){disableDraggable(b)};a.enableDraggable=function(b){enableDraggable(b)};a.enabledraggable=function(b){enableDraggable(b)};a.isOverlap=function(d,b){return isOverlap(d,b)};a.isoverlap=function(d,b){return isOverlap(d,b)};a.addToQueue=function(d,f,e,b){addToArray(d,f,e,b)};a.addtoqueue=function(d,f,e,b){addToArray(d,f,e,b)};a.addToArray=function(b,d){addToArray(b,d)};a.addtoarray=function(b,d){addToArray(b,d)};a.getArray=function(b){return getJetValue(b)};a.getarray=function(b){return getJetValue(b)};a.getQueue=function(b){return getJetValue(b)};a.getqueue=function(b){return getJetValue(b)};a.getCurrentUID=function(){return currentUID};a.getcurrentuid=function(){return currentUID};a.changecolor=function(d,b){changeColor(d,b)};a.changeColor=function(d,b){changeColor(d,b)};a.changeZIndex=function(d,b){changeZindex(d,b)};a.changezindex=function(d,b){changeZindex(d,b)};a.changeopacity=function(d,b){changeOpacity(d,b)};a.changeOpacity=function(d,b){changeOpacity(d,b)};a.changeimage=function(d,b){changeImage(d,b)};a.changeImage=function(d,b){changeImage(d,b)};a.changeposition=function(e,d,b){changePosition(e,d,b)};a.changePosition=function(e,d,b){changePosition(e,d,b)};a.changerotation=function(f,e,d,b){changeRotation(f,e,d,b)};a.changeRotation=function(f,e,d,b){changeRotation(f,e,d,b)};a.rotate=function(d,b){rotate(d,b)};a.rotate=function(d,b){rotate(d,b)};a.changetext=function(d,b){changeText(d,b)};a.changeText=function(d,b){changeText(d,b)};a.changeScale=function(h,f,e,d,b){changeScale(h,f,e,d,b)};a.changescale=function(h,f,e,d,b){changeScale(h,f,e,d,b)};a.changeTranslate=function(e,d,b){changeTranslate(e,d,b)};a.changetranslate=function(e,d,b){changeTranslate(e,d,b)};a.animate=function(e,b,d){animate(e,b,d)};a.animatePosition=function(k,d,b,f,e,h){animatePosition(k,d,b,f,e,h)};a.animateposition=function(k,d,b,f,e,h){animatePosition(k,d,b,f,e,h)};a.animateOpacity=function(e,b,d){animateOpacity(e,b,d)};a.animateopacity=function(e,b,d){animateOpacity(e,b,d)};a.isNumber=function(b){return !isNaN(b)};a.isNumber=function(b){return !isNaN(b)};a.getProp=function(d,b){return getProp(d,b)};a.getprop=function(d,b){return getProp(d,b)};a.setProp=function(e,b,d){setProp(e,b,d)};a.setprop=function(e,b,d){setProp(e,b,d)};a.getposition=function(b){return getPosition(b)};a.getPosition=function(b){return getPosition(b)};a.preventpagehide=function(k,d,f,e,h,b){preventPageHide(k,d,f,e,h,b)};a.preventPageHide=function(k,d,f,e,h,b){preventPageHide(k,d,f,e,h,b)};a.showaslayer=function(k,d,f,e,h,b){showAsLayer(k,d,f,e,h,b)};a.showAsLayer=function(k,d,f,e,h,b){showAsLayer(k,d,f,e,h,b)};a.hidelayer=function(b){showAsLayer(b,false,0,0,0,true)};a.hideLayer=function(b){showAsLayer(b,false,0,0,0,true)};a.updatevariablewidget=function(b){updateEmbeddedVariableWidget(b)};a.updateVariableWidget=function(b){updateEmbeddedVariableWidget(b)};a.sendXAPIStatement=function(d,b){sendXAPIStatement(d,b)};a.sendxapistatement=function(d,b){sendXAPIStatement(d,b)};a.displayBannerText=function(e,d){var b={value:e,color:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_BANNER_TEXT,b)};a.displaybannertext=function(e,d){var b={value:e,color:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_BANNER_TEXT,b)};a.executePageBranch=function(b){executePageCalcOptions(b)};a.executepagebranch=function(b){executePageCalcOptions(b)};a.generateRandomNumbers=function(b){return generateRandomNumbers(b)};a.generaterandomnumbers=function(b){return generateRandomNumbers(b)};a.showtoc=function(){showTOC(1)};a.showTOC=function(){showTOC(1)};a.hidetoc=function(){showTOC(0)};a.hideTOC=function(){showTOC(0)};a.toLowerCase=function(b){return toLowerCase(b)};a.tolowercase=function(b){return toLowerCase(b)};a.toUpperCase=function(b){return toUpperCase(b)};a.touppercase=function(b){return toUpperCase(b)};a.findIn=function(b,d){return findIn(b,d)};a.findin=function(b,d){return findIn(b,d)};a.show=function(b){show(b)};a.hide=function(b){hide(b)};a.showToolTip=function(d,b,e){showToolTip(d,b,e)};a.showtooltip=function(d,b,e){showToolTip(d,b,e)};a.hideToolTip=function(d,b,e){hideToolTip()};a.hidetooltip=function(d,b,e){hideToolTip()};a.webanimate=function(d,m,l,k,f,b,h){var e={elementID:d,animationID:m,duration:l,direction:k,currentTime:f,position:b,onFinish:h};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_ANIMATION,e)};a.webAnimate=function(d,m,l,k,f,b,h){var e={elementID:d,animationID:m,duration:l,direction:k,currentTime:f,position:b,onFinish:h};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_ANIMATION,e)};a.updateAnimation=function(d,l,h,m,f,e,k,b){updateAnimator(d,l,h,m,f,e,k,b)};a.updateanimation=function(d,l,h,m,f,e,k,b){updateAnimator(d,l,h,m,f,e,k,b)};a.setGadget=function(b){setGadget(b)};a.log=function(){if(console&&console.log){console.log.apply(console,arguments)}}}puremvc.define({name:"jet.view.mediator.AnimationMediator",parent:puremvc.Mediator},{animationMapByTimeLineID:{},animationMapByPageID:{},animatorsByPageID:{},listNotificationInterests:function(){return[jet.AppConstants.REQUEST_ANIMATION,jet.AppConstants.UPDATE_ANIMATORS]},handleNotification:function(m){switch(m.getName()){case jet.AppConstants.REQUEST_ANIMATION:var h=m.getBody();this.playAnimation(h.elementID,h.animationID,h.duration,h.direction,h.currentTime,h.position,h.onFinish);break;case jet.AppConstants.UPDATE_ANIMATORS:var h=m.getBody();var k=h.uid;var a=h.state;var f=h.duration;var d=h.currentTime;var e=h.iterations;var b=h.playbackRate;var l=h.onFinish;var n=h.iterationStart;this.updateAnimators(this,k,a,d,f,e,b,l,n);break}},onRegister:function(){},onRemove:function(){},onShow:function(d,a){var b=this;if(a){var e=b.animationMapByPageID[d.uid];b.webAnimate(d,"play",e)}},findAnimations:function(f,d){var e=$(d).find("div[data-animations]");for(var b=0;b<e.size();b++){var a=e[b];this.processElement(f,a)}this.reparentAnimatedElements(f)},processElement:function(f,d){var h=$(d).attr("data-animations");var b=qValidate(h);try{var e=JSON.parse(b);this.animationMapByPageID[f.uid]=e;this.storeAnimation(e)}catch(a){}},storeAnimation:function(b){var a=this;if(!isEmpty(b)){$.each(b,function(){var h=this;var f=h.tline;var e=JSON.parse(f);var d=e.title;a.animationMapByTimeLineID[d]=h.animation})}},getAnimation:function(a){return this.animationMapByTimeLineID[a]},playAnimation:function(n,b,f,m,a,h,k){if(!isEmpty(h)){$("#"+n).css("position",h)}if(isEmpty(a)){a=0}if(isEmpty(f)){f=10}if(isEmpty(m)){m="normal"}var d=$("#"+n).get(0);var e=this.getAnimation(b);if(d&&d.animate&&e){var l=d.animate(e,{duration:f*1000,direction:m,iterations:1,fill:"forwards"});if(!isEmpty(k)){l.addEventListener("finish",function(o){executePageCalcOptions(k)})}l.currentTime=a;l.play()}},reparentAnimatedElements:function(f){var h=this.animationMapByPageID[f.uid];if(!isEmpty(h)){$(f.getContentDiv()).css("min-height","600px");for(var a=0;a<h.length;a++){var d=h[a];var k=d.id;var e=$("#"+k).get(0);if(e){var b=e.tagName;switch(b.toUpperCase()){case"IMG":case"SVG":if(e.classList.contains("flowLockable")){return}else{$("#"+k).appendTo(f.getContentDiv())}break;default:break}}}}},checkWhatState:function(a){},webAnimate:function(d,a,h){var b=this;var f=[];if(a=="play"&&!isEmpty(h)){var e=this.calcTotalTime(h);$.each(h,function(){var l=this;if(!l||!l.id||$("#"+l.id).length<1){return false}var q=l.id;var o=1;if(l.iterations){o=l.iterations}var n=document.getElementById(q);var k=n.tagName;switch(k.toUpperCase()){case"IMG":case"SVG":if(n.classList.contains("flowLockable")){}else{n.style.position="absolute"}break;default:break}var p={duration:e*1000,direction:"normal",iterationStart:0,iterations:o,fill:"forwards"};var m=n.animate(l.animation,p);m.currentTime=0;f.push(m)});b.animatorsByPageID[d.uid]=f}},updateAnimators:function(m,l,a,d,h,e,b,n,p){var f=m.animatorsByPageID[l];if(isEmpty(f)){showAsLayer(l,"show",0,0,0,"false");showAsLayer(l,"hide",0,0,0,"false");f=m.animatorsByPageID[l];if(isEmpty(f)){return}}for(var k=0;k<f.length;k++){var o=f[k];if(!isEmpty(n)){o.addEventListener("finish",function(q){executePageCalcOptions(n)})}o.playbackRate=b;o.effect.updateTiming({duration:h*1000,iterations:e,iterationStart:p});switch(a){case"play":if(!isEmpty(d)){o.currentTime=d*1000}o.play();break;case"pause":o.pause();break;case"reverse":o.reverse();break;default:}}},calcTotalTime:function(b){var a=0;$.each(b,function(){var f=this;var d=f.tline;var e=JSON.parse(d);var k=e.ui;var h=k.totalTime;a=h>a?h:a});return a},getAnimators:function(a,d){var b=[];var f=this.animationMapByPageID[a];if(isEmpty(f)){return null}var e=this.calcTotalTime(f);$.each(f,function(){var h=this;if(!h||!h.id||$("#"+h.id).length<1){return false}var m=h.id;var l=document.getElementById(m);if(l.classList.contains("flowLockable")){}else{l.style.position="absolute"}var k=l.animate(h.animation,{duration:e*1000,direction:"normal",iterations:1,fill:"forwards"});switch(d){case"play":k.play();break;case"pause":k.pause();break}b.push(k)});this.animatorsByPageID[a]=b;return b},},{NAME:"AnimationMediator"});puremvc.define({name:"jet.view.mediator.AudioMediator",parent:puremvc.Mediator},{div:null,audioDiv:null,speakerDiv:null,sliderDiv:null,iconSpan:null,progressParent:null,progressDiv:null,timeDiv:null,sourceDiv:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,mediaURL:null,enableAutoPlay:null,enableController:null,volume:null,audioMarkedDivs:null,audioContext:null,toplay_Icon:"&#x25b6;",topause_Icon:"&#10074;&#10074;",downloadIcon:"&#x23F3;",foregroundColor:"black",animators:null,listNotificationInterests:function(){return[]},handleNotification:function(a){},onRegister:function(){this.createAudioElement()},createAudioElement:function(){this.enableAutoPlay="0";this.enableController="1";this.volume=0.8;this.div=document.createElement("div");$(this.div).css("display","flex");$(this.div).css("flex-wrap","nowrap");$(this.div).css("flex-direction","row");$(this.div).css("min-height","65px");$(this.div).css("margin","10px");$(this.div).css("user-select","none");this.speakerDiv=document.createElement("div");$(this.speakerDiv).css("order",1);$(this.speakerDiv).css("min-width","30px");this.iconSpan=document.createElement("span");$(this.iconSpan).css("user-select","none");$(this.iconSpan).html(this.downloadIcon);$(this.iconSpan).css("font-size","1.5em");this.progressParent=document.createElement("div");$(this.progressParent).css("order",2);$(this.progressParent).css("margin-left","20px");$(this.progressParent).css("visibility","hidden");this.progressDiv=document.createElement("div");$(this.progressDiv).css("margin-left","10px");$(this.progressDiv).css("user-select","none");$(this.progressDiv).html("0/0");$(this.progressDiv).css("font-size",".75em");$(this.progressDiv).css("color","#070707");$(this.progressParent).append(this.progressDiv);this.sliderDiv=document.createElement("div");$(this.sliderDiv).css("margin-top","10px");$(this.sliderDiv).css("margin-left","15px");$(this.sliderDiv).css("width","80px");$(this.sliderDiv).slider({step:1,});$(this.progressParent).append(this.sliderDiv);$(this.speakerDiv).append(this.iconSpan);$(this.div).append(this.speakerDiv);$(this.div).append(this.progressParent);$(this.div).css("margin-bottom","20px");this.audioDiv=document.createElement("audio");this.audioDiv.className="audioComponent";$(this.audioDiv).attr("preload","metadata");$(this.audioDiv).removeAttr("controls");$(this.div).append(this.audioDiv);this.sourceDiv=document.createElement("source");$(this.sourceDiv).attr("type","audio/mpeg");$(this.audioDiv).append(this.sourceDiv);this.addHandlers(this.speakerDiv,this.audioDiv,this.iconSpan);this.addTimeHandler(this.audioDiv,this.progressDiv);this.addSlideHandler();$(this.progressDiv).html("00:00/00:00")},onRemove:function(){},getAudioPlayer:function(){return this.div},setAnimators:function(a){this.animators=a},setaudioMarkedDivs:function(a){this.audioMarkedDivs=a},setSource:function(d){var a=this;$(this.audioDiv).attr("src",d);var b=setInterval(function(){a.updateIcon(a);clearInterval(b);a.logAudio("Audio has called failSafe.")},60000)},setAutoplay:function(a){if(a){$(this.audioDiv).attr("autoplay","")}else{$(this.audioDiv).removeAttr("autoplay")}},play:function(){var a=this;if(!isEmpty(a.audioDiv)){var b=$(a.audioDiv).get(0).play();a.playAnimations($(a.audioDiv).get(0),"play");if(b!==undefined&&b["catch"]){b["catch"](function(d){a.updateIcon(a);if(console&&console.log){console.log("Caught -> "+d.message)}})}}},pause:function(){var b=this;if(!isEmpty(b.audioDiv)){var a=$(b.audioDiv).get(0).pause();b.playAnimations($(b.audioDiv).get(0),"pause");if(a!==undefined&&a["catch"]){a["catch"](function(d){b.updateIcon(this);if(console&&console.log){console.log("Caught -> "+d.message)}})}}},requestPause:function(){this.pause()},addHandlers:function(e,d,b){var a=this;$(e).on("click",function(){if(!isEmpty(d)){var f=d.paused;if(f){a.play(a)}else{a.pause()}a.updateIcon(a)}})},updateIcon:function(b){var e=$(b.audioDiv).get(0);var d=$(b.iconSpan).get(0);if(!isEmpty(e)){if(e.readyState==e.HAVE_ENOUGH_DATA){var a=e.paused;if(a){$(d).html(b.toplay_Icon)}else{$(d).html(b.topause_Icon)}}else{$(d).html(b.downloadIcon)}}},addTimeHandler:function(l,a){var p=this;var b=0;var h=0;var s="";var k="";var n="";var q=0;var f=0;var r=0;var o=0;var m=0;var d=0;var e=false;if(!isEmpty(l)){l.oncanplay=function(t){p.updateIcon(p);p.logAudio("Audio can play")};l.onloadeddata=function(t){p.updateIcon(p);p.logAudio("Audio has loaded data")};l.onloadedmetadata=function(u){p.logAudio("Audio has loaded metadata");var t=$(p.iconSpan).get(0);$(t).html(p.toplay_Icon);h=l.duration;o=Math.floor(h/3600);m=h%3600;m=p.digit(Math.floor(m/60));d=p.digit(Math.floor(h%60));k=m+":"+d;s="00:00";n=s+" / "+k;$(a).html(n);$(p.progressParent).css("visibility","visible");$(p.sliderDiv).find(".ui-slider-handle").css("width","12px");$(p.sliderDiv).find(".ui-slider-handle").css("height","12px");$(p.sliderDiv).find(".ui-slider-handle").css("margin-top","6px");$(p.sliderDiv).find(".ui-slider-handle").css("background","#757575");$(p.sliderDiv).find(".ui-slider-handle").css("border","1px black solid");$(p.sliderDiv).find(".ui-slider-handle").parent().css("background-size","contain");$(p.sliderDiv).find(".ui-slider-handle").parent().css("background-image",p.getDataBackground());$(p.sliderDiv).slider({min:0,max:h,value:b})};l.ontimeupdate=function(t){b=l.currentTime;h=l.duration;if(isNaN(b)||isNaN(h)){n=""}else{o=Math.floor(h/3600);m=h%3600;m=p.digit(Math.floor(m/60));d=p.digit(Math.floor(h%60));k=q>0?o+":"+m+":"+d:m+":"+d;q=Math.floor(b/3600);f=b%3600;f=p.digit(Math.floor(f/60));r=p.digit(Math.floor(b%60));s=q>0?q+":"+f+":"+r:f+":"+r;n=s+" / "+k}$(p.progressDiv).html(n);$(p.sliderDiv).slider({min:0,max:h,value:b});p.handleTimeUpdate(t,p)}}},addSlideHandler:function(){var a=this;$(this.sliderDiv).on("slidestart",function(d,e){var b=$(a.audioDiv).get(0);if(!isEmpty(b)){a.pause(a);a.updateIcon(a)}});$(this.sliderDiv).on("slidestop",function(d,e){var b=$(a.audioDiv).get(0);if(!isEmpty(b)){b.currentTime=e.value;a.handleManualTimeChange(d,a)}})},digit:function(b){var a="00";a+=b;return a.substring(a.length-2,a.length)},handleManualTimeChange:function(e,a){var d=$(a.audioDiv).get(0);if(isEmpty(d)){return}var b=d.currentTime;$(a.audioMarkedDivs).each(function(){var f=$(this).attr("data-audio_in");var k=$(this).attr("data-audio_out");var h=$(this).attr("data-speed");if(isEmpty(f)){$(this).hide()}if(isEmpty(k)){k=d.duration}if(b<k&&b>f){}else{$(this).hide()}});$(a.audioMarkedDivs).each(function(){var k=$(this).attr("data-audio_out");var h=$(this).attr("data-speed");if(Math.abs(b-k)<1){var f=$(this).attr("data-effect_out");a.handleEffect(this,f)}})},handleTimeUpdate:function(e,a){var d=$(this.audioDiv).get(0);if(isEmpty(d)){return}var b=d.currentTime;this.updateIcon(this)},handleTimeUpdatexx:function(e,a){var d=$(this.audioDiv).get(0);if(isEmpty(d)){return}var b=d.currentTime;$(a.audioMarkedDivs).each(function(){var k=$(this).attr("data-audio_in");var h=$(this).attr("data-speed");if(Math.abs(b-k)<1){var f=$(this).attr("data-effect_in");a.handleEffect(this,f,h)}});$(a.audioMarkedDivs).each(function(){var k=$(this).attr("data-audio_out");var h=$(this).attr("data-speed");if(Math.abs(b-k)<1){var f=$(this).attr("data-effect_out");a.handleEffect(this,f)}});this.updateIcon(this)},addLoadedHandler:function(b,a){b.oncanplay=function(d){$(a.iconSpan).css("color","green")}},getDataBackground:function(){var a="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAJCAYAAADEiInQAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTA0LTEzVDEzOjM2OjI5LTA1OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA0LTEzVDEzOjUxOjA1LTA1OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wNC0xM1QxMzo1MTowNS0wNTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5YzgxZjQ1My0yM2VmLTRmNDQtOTlmNi0zMmRlMTMzMTc4YWEiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3OGUyNzI3Yy0zNjVlLWRiNDctOGE3OC05MTI3ZDQ1OGI1NGEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0Y2M2MDkzNi1hMWYxLWFlNDQtOWNkOC04ZjM3NGIzZDhjNTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjRjYzYwOTM2LWExZjEtYWU0NC05Y2Q4LThmMzc0YjNkOGM1OCIgc3RFdnQ6d2hlbj0iMjAyMC0wNC0xM1QxMzozNjoyOS0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphZjU2NTQyYi1mOWE0LTg4NGYtYWE4MS0wODMwMWNjYzhkMzIiIHN0RXZ0OndoZW49IjIwMjAtMDQtMTNUMTM6MzY6MjktMDU6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OWM4MWY0NTMtMjNlZi00ZjQ0LTk5ZjYtMzJkZTEzMzE3OGFhIiBzdEV2dDp3aGVuPSIyMDIwLTA0LTEzVDEzOjUxOjA1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+REVYagAAADlJREFUSMft1yEBAEAMw8D61xZPPzIHA18QEAVH2gDZnn0tQMQoQxGjLEEEMUEEsQuIKGUrS5SiHzLgZdy+eUe6VgAAAABJRU5ErkJggg==')";return a},updateColors:function(b){if(!isEmpty(b)&&b.includes("rgb(")){b=rgb2hex(String(b));if(!isEmpty(b)){var a=getContrastYIQ(b);$(this.iconSpan).css("color",a);$(this.progressDiv).css("color",a)}}},handleEffect:function(a,b,d){switch(d){case"fast":d=200;break;case"slow":d=2000;break;default:d=500;break}switch(b){case"none":$(a).show();break;case"show":$(a).show();break;case"hide":$(a).hide();break;case"fadeIn":$(a).css("position","absolute");$(a).css("top","10px");$(a).css("margin","");$(a).css("margin-left","auto");$(a).css("margin-right","auto");$(a).fadeIn(d);break;case"fadeOut":$(a).fadeOut(d);break;case"slideDown":$(a).slideDown(d);break;case"slideUp":$(a).slideUp(d);break;case"scrollTo":$(a).show();$("html, body").animate({scrollTop:$(a).offset().top-70},d);default:$(a).show()}},logAudio:function(a){if(window.console&&window.console.log){window.console.log(a)}},playAnimations:function(f,b){var e=f.currentTime;if(!isEmpty(this.animators)&&this.animators.length>0){for(var d=0;d<this.animators.length;d++){var a=this.animators[d];if(b=="play"){a.currentTime=e*1000;a.play()}else{a.pause()}}}}},{NAME:"AudioMediator"});puremvc.define({name:"jet.view.mediator.DashboardComponentMediator",parent:puremvc.Mediator},{meterComponent:null,isMeter:false,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_METER,jet.AppConstants.REQUEST_CLOSE_METER,jet.AppConstants.SET_METER,jet.AppConstants.REQUEST_DASHBOARD_LAYOUT,jet.AppConstants.REQUEST_GADGET_UPDATE,jet.AppConstants.ADD_SETTINGS]},handleNotification:function(e){switch(e.getName()){case jet.AppConstants.REQUEST_METER:this.showMeter(e.getBody());break;case jet.AppConstants.REQUEST_CLOSE_METER:this.hideMeter();break;case jet.AppConstants.SET_METER:this.setMeter(e.getBody());break;case jet.AppConstants.REQUEST_DASHBOARD_LAYOUT:this.layoutDashboard();break;case jet.AppConstants.REQUEST_GADGET_UPDATE:this.updateGadget(e.getBody());break;case jet.AppConstants.ADD_SETTINGS:var d=e.getBody();var b=d.settings;if(b!=null&&b.displayMeter!=null){var a=b.displayMeter;if(a==="0"){this.meterComponent.setEnabled("true")}else{this.meterComponent.setEnabled("false")}}break}},onRegister:function(){this.setViewComponent(new jet.view.component.DashboardComponent);this.setMeterComponent(new jet.view.component.MeterComponent(this))},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},setMeterComponent:function(a){this.meterComponent=a},showMeter:function(){if(!this.isMeter){this.meterComponent.setParent($(".dashboard"));this.meterComponent.initMeter();this.isMeter=true}this.meterComponent.show(true)},hideMeter:function(){this.meterComponent.show(false)},setMeter:function(b){this.meterComponent.setMeter(b);b=b/180;var a={score:b};this.updateGadgets(a)},requestResumeNavigation:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null)},layoutDashboard:function(){this.getViewComponent().doDashboardLayout()},updateGadget:function(e){var a=e.name;var d=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var b=d.getGadgets();var f=b[a];if(f!=null&&f!=undefined){f.setDataObject(e)}},updateGadgets:function(d){var b=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var a=b.getGadgets();for(var f in a){var e=a[f];if(e!=null&&e!=undefined&&e.setDataObject){e.setDataObject(d)}}}},{NAME:"DashboardComponentMediator"});puremvc.define({name:"jet.view.mediator.FormsMediator",parent:puremvc.Mediator},{pageMap:{},listNotificationInterests:function(){return[jet.AppConstants.RECORD_USER_RESPONSE]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.RECORD_USER_RESPONSE:this.handleResponse(a.getBody());break}},onRegister:function(){},onRemove:function(){},handleResponse:function(e){var b=e.page_ID;var d=e.response;var a="#"+b+" .textEntry";$(a).html(d)}},{NAME:"FormsMediator"});puremvc.define({name:"jet.view.mediator.GraphicsMediator",parent:puremvc.Mediator},{pageMap:{},listNotificationInterests:function(){return[jet.AppConstants.HANDLE_GRAPHICS_DATA]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.HANDLE_GRAPHICS_DATA:this.handleXMLData(a.getBody());break}},onRegister:function(){},onRemove:function(){},getXMLData:function(e,b){this.pageMap[e]=b;var d="base/"+e+"_vector.xml";var a={graphicsUID:e,fileName:d};this.facade.sendNotification(jet.AppConstants.PROCESS_GRAPHICS_DATA,a)},handleXMLData:function(d){var e=d.graphicsUID;var a=d.xml;var b=this.facade.retrieveProxy(jet.model.proxy.JFXMLProxy.NAME);b.parseData(this,e,a,-1)},post:function(e,f){var d=this.pageMap[f];e.page=d;var b=d.getContentDiv();var a={contentDiv:b,objectMap:e};this.facade.sendNotification(jet.AppConstants.BUILD_VECTOR_IMAGE,a)},postProcessGraphics:function(b){var a=this.pageMap[b];a.postProcessGraphics()}},{NAME:"GraphicsMediator"});puremvc.define({name:"jet.view.mediator.HeaderComponentMediator",parent:puremvc.Mediator},{listNotificationInterests:function(){return[jet.AppConstants.ADD_TOC,jet.AppConstants.ADD_RESOURCES,jet.AppConstants.ADD_TITLE,jet.AppConstants.REQUEST_NODE,jet.AppConstants.REQUEST_UPDATE_MENUS,jet.AppConstants.ADD_SETTINGS,jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME,jet.AppConstants.REQUEST_BANNER_TEXT,jet.AppConstants.REQUEST_HEADER_BACKGROUND,jet.AppConstants.SHOW_TOC,jet.AppConstants.HIDE_TOC]},handleNotification:function(f){switch(f.getName()){case jet.AppConstants.SHOW_TOC:this.viewComponent.showTOC(true);break;case jet.AppConstants.HIDE_TOC:this.viewComponent.showTOC(false);break;case jet.AppConstants.ADD_TOC:if($("body").hasClass("epub3")){return}var e=f.getBody();var d=e.tocItems;var b=e.settings;if(b!=null&&b["Table of Contents"]!=null){var a=Number(b["Table of Contents"]);switch(a){case (0):break;case (1):this.viewComponent.addMenu_1(d);break;case (2):this.viewComponent.addTOC(d);break;case (3):this.viewComponent.addMenu_2(d);break;case (4):this.viewComponent.addMenu_3(d);break;default:this.viewComponent.addTOC(d);break}}else{this.viewComponent.addTOC(d)}break;case jet.AppConstants.ADD_RESOURCES:var e=f.getBody();var d=e.tocItems;this.viewComponent.addResourceTabs_1(d);break;case jet.AppConstants.ADD_TITLE:var e=f.getBody();var b=e.settings;if(b!=null&&b.Title!=null){this.viewComponent.addTitle(b.Title)}break;case jet.AppConstants.ADD_SETTINGS:var e=f.getBody();var b=e.settings;if(b!=null&&b.displayADA!=null){this.viewComponent.displayADA(b.displayADA)}if(b!=null&&b.displayPrint!=null){this.viewComponent.displayPrint(b.displayPrint)}if(b!=null&&b.displayAccessibilityPage!=null){this.viewComponent.displayAccessibilityPage(b.displayAccessibilityPage)}if(b!=null&&b.displayNotes!=null){this.viewComponent.displayNotes(b.displayNotes)}if(b!=null&&b.displayTranscript!=null){this.viewComponent.displayTranscript(b.displayTranscript)}if(b!=null&&b.displayEPub!=null){this.viewComponent.displayEpub(b.displayEPub)}if(b!=null&&b.displayMap!=null){this.viewComponent.displayMap(b.displayMap)}break;case jet.AppConstants.REQUEST_UPDATE_MENUS:case jet.AppConstants.REQUEST_NODE:this.updateMenu(f.getBody());break;case jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME:this.viewComponent.handleProjectName();break;case jet.AppConstants.REQUEST_BANNER_TEXT:var e=f.getBody();this.viewComponent.displayBannerText(e.value,e.color);break;case jet.AppConstants.REQUEST_HEADER_BACKGROUND:this.viewComponent.displayHeaderBackground();break}},onRegister:function(){this.setViewComponent(new jet.view.navigation.HeaderComponent(this))},onRemove:function(){this.setHeaderComponent(null)},requestNode:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_NODE,a);this.facade.sendNotification(jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON)},updateMenu:function(a){this.viewComponent.updateMenu(a)}},{NAME:"HeaderComponentMediator"});puremvc.define({name:"jet.view.mediator.ImageMediator",parent:puremvc.Mediator},{pageMap:{},photoViewer:{},listNotificationInterests:function(){return[]},handleNotification:function(a){switch(a.getName()){}},onRegister:function(){},onRemove:function(){},onShow:function(d,a){var b=this;if(a){var f=b.photoViewer[d.getUID()];if(f){if(isEmpty(f.viewer)){var e=window.setInterval(function(){var k=f.options;var l=new PhotoSphereViewer.Viewer(k);l.autoSize();f.viewer=l;const h=l.getPlugin(PhotoSphereViewer.MarkersPlugin);h.on("select-marker",function(q,o){var n=o.data.status;var m="";var p="";if(o&&o.data&&(o.data.branchoptions||o.data.deselectedbranchoptions)){if(n=="deselected"){o.data.status="selected";m=o.data.branchoptions;p=b.createMarkerIcon(true,o.data.nodeType)}else{o.data.status="deselected";m=o.data.deselectedbranchoptions;p=b.createMarkerIcon(false,o.data.nodeType)}if(o.data.nodeType=="HOTSPOT"||o.data.nodeType=="IMAGEMAP"){}else{h.updateMarker({id:o.id,image:p})}}if(!isEmpty(m)){b.processMarkerBranchOptions(d,m)}});clearInterval(e)},1000)}}}},findImages:function(f,d){var e=$(d).find("img, svg");for(var b=0;b<e.size();b++){var a=e[b];this.processElement(f,a)}},processElement:function(o,h){var d=this;var o=o;var k=o.getMediator(jet.view.mediator.PageMediator.NAME);d.processSubElements(d,h,o,k);var p=qValidate($(h).attr("data-branchoptions"));var l=qValidate($(h).attr("data-branchoptions2"));var b=qValidate($(h).attr("data-hoveroptions"));var f=qValidate($(h).attr("data-hoveroutoptions"));if(p!=null||l!=null){this.processBranchOptions(o,h,p,l,k,"colorize","IMAGE")}if(b!=null||f!=null){this.processHoverBranchOptions(o,h,b,f,k)}var m=qValidate($(h).attr("data-dragoptions"));if(!isEmpty(m)){this.processDragOptions(o,h,m,k)}var q=$(h).hasClass("spherical");var n=qValidate($(h).attr("data-imagenodes"));if(q){if(!isEmpty(n)){var a=JSON.parse(n)}var e=d.createMarkers(d,a,o);d.createSphereViewer(o,h,e)}if(n!=null&&n.length>2&&!q){d.processImageNodes(o,h,n,k)}},processSubElements:function(f,b,e,a){if($(b).is("svg")){var d=$(b).find("*");$(d).each(function(){if(!isEmpty($(this).attr("data-branchoptions"))){var k=qValidate($(this).attr("data-branchoptions"));var m=qValidate($(this).attr("data-branchoptions2"));if(k!=null||m!=null){f.processBranchOptions(e,this,k,m,a,"colorize","IMAGE")}}if(!isEmpty($(this).attr("data-dragoptions"))){var n=qValidate($(this).attr("data-dragoptions"));if(!isEmpty(n)){f.processDragOptions(e,this,n,a)}}if(!isEmpty($(this).attr("data-hoveroptions"))){var l=qValidate($(this).attr("data-hoveroptions"));var h=qValidate($(this).attr("data-hoveroutoptions"));if(!isEmpty(l)||!isEmpty(h)){f.processHoverBranchOptions(e,this,l,h,a)}}})}},createMarkers:function(o,p,e){if(isEmpty(p)){p=[]}var z=[];for(var y=0;y<p.length;y++){var m={};var x=p[y];var b=x.nodeType;var v=x.percentageX;var s=x.percentageY;var d=x.nodeX;var a=x.nodeY;var k=x.percentageWidth;var B=x.percentageHeight;var f=x.originalImageWidth;var w=x.originalImageHeight;var q=x.imagePath;var A={};A.branchoptions=x.branchoptions;A.deselectedbranchoptions=x.deselectedbranchoptions;A.status="deselected";A.nodeType=b;var u=parseInt(v*f);var r=parseInt(s*w);var l=parseInt(k*f);var n=parseInt(B*w);m.id="marker"+y;if(b=="HOTSPOT"){m.polygonPx=[[u,r],[u+l,r],[u+l,r+n],[u,r+n]];m.svgStyle={fill:"rgba(200, 0, 0, 0.0)",stroke:"rgba(200, 0, 50, 0.0)",strokeWidth:"2px"}}else{if(b=="IMAGEMAP"){var h=parseInt(k*7000);var t=parseInt(B*3500);m.imageLayer="base/"+q;m.width=h;m.height=t;m.x=u+l/2;m.y=r+n;m.anchor="bottom center"}else{m.x=u;m.y=r;m.image=o.createMarkerIcon(false,b);m.width=32;m.height=32;m.anchor="bottom center"}}m.data=A;z.push(m)}return z},processBranchOptions:function(k,e,l,m,h,a,b){if(!isEmpty(l)){this.initHover(e)}var f=this;var d="No Event";$(e).on("click",function(o){var n=null;var p=f.checkWhatState(this);switch(p){case false:n=f.parseBranchOptions(l);break;case true:n=f.parseBranchOptions(m);break}if(n!=null&&typeof n!="undefined"&&n.checkedOption!="None"&&n.checkedOption!="No Action"){k.setBranchOptions(n);h.processFeedbackAndBranchingOptions(k,true,n);if((n.checkedOption!="None"&&n.checkedOption!="No Action")||n.showFeedback=="true"){f.changeState(f,e,l,m,a,b)}}})},processHoverBranchOptions:function(h,d,f,a,b){var e=this;$(d).on("mouseenter",function(l){if(isEmpty(f)){return}var k=null;k=e.parseBranchOptions(f);if(k!=null&&typeof k!="undefined"&&k.checkedOption!="None"&&k.checkedOption!="No Action"){h.setBranchOptions(k);b.processFeedbackAndBranchingOptions(h,true,k)}});$(d).on("mouseleave",function(l){if(isEmpty(a)){return}var k=null;k=e.parseBranchOptions(a);if(k!=null&&typeof k!="undefined"&&k.checkedOption!="None"&&k.checkedOption!="No Action"){h.setBranchOptions(k);b.processFeedbackAndBranchingOptions(h,true,k)}})},processDragOptions:function(h,d,f,b){var a="No Event";console.log("Processing drag options");var e=imageMediator.parseBranchOptions(f);if(e&&e.checkedOption!="None"&&e.checkedOption!="No Action"){processDragElement(d,e.eventOptions,function(){h.setBranchOptions(e);b.processFeedbackAndBranchingOptions(h,true,e)})}},processNodeBranchOptions:function(h,e,d,b){var f=this;var a="No Event";$(e).on("click",function(){var k=null;k=f.parseBranchOptions(d);if(k!=null&&typeof k!="undefined"){h.setBranchOptions(k);b.processFeedbackAndBranchingOptions(h,true,k)}})},processMarkerBranchOptions:function(f,b){var a=f.getMediator(jet.view.mediator.PageMediator.NAME);var e=this;var d=null;d=e.parseBranchOptions(b);if(d!=null&&typeof d!="undefined"){f.setBranchOptions(d);a.processFeedbackAndBranchingOptions(f,true,d)}},processImageNodes:function(l,e,k,f){var d=document.createElement("div");var m=$(e).attr("data-branchoptions");var h=$(e).attr("data-branchoptions2");if(m!=null||h!=null){this.processBranchOptions(l,d,m,h,f,"colorize","IMAGE")}$(d).addClass("imageOverlay");$(d).css("border","none");$(d).css("overflow","auto");$(d).insertBefore(e);$(d).width($(e).css("width"));$(d).css("position","relative");$(d).append(e);$(e).css("position","relative");$(e).css("object-fit","contain");$(e).css("margin","0px");$(e).css("width","100%");$(e).attr("height","auto");var b=document.createElement("div");$(b).addClass("nodeLayer");$(b).css("overflow","hidden");$(b).css("position","absolute");$(b).width("100%");$(b).height("100%");$(b).attr("height","auto");$(b).css("top","0");$(b).css("left","0");$(d).append(b);var a=JSON.parse(k);this.createNodes(l,e,a,f,b)},parseBranchOptions:function(a){if(!isEmpty(a)){try{var d=JSON.parse(a)}catch(b){if(window&&window.console){window.console.log("ImageMediator parseBranchOptions reports: "+b)}}return d}},createNodes:function(d,b,f,a,k){var s=$(b).css("border-width");var v=$(b).css("border-color");var w=$(b).css("border-style");$(b).css("border","none");for(var u=0;u<f.length;u++){var r=f[u];var m=r.percentageX;var l=r.percentageY;var e=r.percentageWidth;var y=r.percentageHeight;var h=r.imagePath;switch(r.nodeType){case"NAVINFO":case"NAVANCHOR":case"NAVPOINT":var q=document.createElement("div");$(k).append(q);$(q).width(30);$(q).height(30);$(q).css("position","absolute");var z=this.createMarkerIcon(false,r.nodeType);$(q).css("background-image","url("+z+")");$(q).css("background-size","contain");$(q).css("background-repeat","no-repeat");$(q).css("left",(m*100)+"%");$(q).css("top",(l*100)+"%");var n=-15;var t=-30;$(q).css("transform","translate("+n+"px,"+t+"px)");var x=r.branchoptions;var p=r.deselectedbranchoptions;if(x!=null||p!=null){this.processBranchOptions(d,q,x,p,a,"swapIcon",r.nodeType)}break;case"HOTSPOT":var o=document.createElement("div");$(k).append(o);$(o).css("width",(e*100)+"%");$(o).css("height",(y*100)+"%");$(o).css("position","absolute");$(o).css("background","none");$(o).css("left",(m*100)+"%");$(o).css("top",(l*100)+"%");var x=r.branchoptions;var p=r.deselectedbranchoptions;if(x!=null||p!=null){this.processBranchOptions(d,o,x,p,a,"colorize",r.nodeType)}break;case"IMAGEMAP":var o=document.createElement("div");$(k).append(o);$(o).css("background-image","url(./base/"+h+")");$(o).css("background-size","contain");$(o).css("background-repeat","no-repeat");$(o).css("width",(e*100)+"%");$(o).css("height",(y*100)+"%");$(o).css("position","absolute");$(o).css("left",(m*100)+"%");$(o).css("top",(l*100)+"%");var x=r.branchoptions;var p=r.deselectedbranchoptions;if(x!=null||p!=null){this.processBranchOptions(d,o,x,p,a,"colorize",r.nodeType)}break}}},checkWhatState:function(a){if($(a).is("img")||$(a).is("div")){return $(a).hasClass("branch-selected")}else{return($(a).attr("data-selection")=="branch-selected")}},changeState:function(k,h,f,l,b,a){var d=k.parseBranchOptions(l);var e=false;if(!isEmpty(d)&&d.checkedOption!="None"&&d.checkedOption!="No Action"&&typeof d.checkedOption!="undefined"||!isEmpty(d)&&d.showFeedback=="true"){e=true}if($(h).is("img")||$(h).is("div")){if($(h).hasClass("branch-selected")){$(h).removeClass("branch-selected");k.removeHighlight(b,h,k,a)}else{if(e){$(h).addClass("branch-selected");k.addHighlight(b,h,k,a)}}}else{if(e){if($(h).attr("data-selection")=="branch-selected"){$(h).attr("data-selection","");k.removeHighlight(b,h,k,a)}else{$(h).attr("data-selection","branch-selected");k.addHighlight(b,h,k,a)}}}$(h).hover(function(){$(this).css("cursor","pointer");$(this).css({opacity:"0.8",transition:"all 0s ease"})},function(){$(this).css("cursor","default");$(this).css({opacity:"1",transition:"all 0s ease"})})},initHover:function(a){$(a).hover(function(){$(this).css("cursor","pointer");$(this).css({opacity:"0.8",transition:"all 0s ease"})},function(){$(this).css("cursor","default");$(this).css({opacity:"1",transition:"all 0s ease"})})},addHighlight:function(d,b,e,a){switch(d){case"colorize":$(b).css("filter","grayscale(50%)");break;case"outline":$(b).css("outline","4px dotted #e73");break;case"swapIcon":var f=e.createMarkerIcon(true,a);$(b).css("background-image","url("+f+")");break;default:$(b).css("outline","4px dotted #e73");break}},removeHighlight:function(d,b,e,a){switch(d){case"colorize":$(b).css("filter","grayscale(0%)");break;case"outline":$(b).css("outline","none");break;case"swapIcon":var f=e.createMarkerIcon(false,a);$(b).css("background-image","url("+f+")");break;default:$(b).css("outline","none");break}},createSphereViewer:function(l,h,f){var a=$(h).attr("src");var k=$(h).attr("alt");var d=$(h).attr("id");var b=document.createElement("div");$(b).attr("id",d);$(b).addClass("photoSphereViewer");$(h).replaceWith(b);$(b).attr("style","width:850px; height:480px;background-color:#e7e7e7");$(b).css("background-size","contain");$(b).css("background-image","url('lib/js/sphereViewer/assets/photosphere-logo.gif')");$(b).css("background-repeat","no-repeat");$(b).css("background-position","center center");var e=[{url:a,desc:k,},];var m={};var n={container:b,panorama:a,caption:k,loadingTxt:"Loading...",navbar:["autorotate","zoom","caption","gyroscope","stereo",],plugins:[PhotoSphereViewer.GyroscopePlugin,PhotoSphereViewer.StereoPlugin,[PhotoSphereViewer.MarkersPlugin,{markers:f}]]};m.options=n;m.container=b;m.markers=f;this.photoViewer[l.getUID()]=m},createMarkerIcon:function(a,b){if(a){switch(b){case"NAVPOINT":return"lib/js/sphereViewer/assets/navpoint_yellow.png";case"NAVANCHOR":return"lib/js/sphereViewer/assets/navanchor_yellow.png";case"NAVINFO":return"lib/js/sphereViewer/assets/navinfo_yellow.png"}}else{switch(b){case"NAVPOINT":return"lib/js/sphereViewer/assets/navpoint.png";case"NAVANCHOR":return"lib/js/sphereViewer/assets/navanchor.png";case"NAVINFO":return"lib/js/sphereViewer/assets/navinfo.png"}}},createHourGlass:function(){var a="<svg xmlns='http://www.w3.org/2000/svg' height='100' viewBox='0 0 100 100' width='100'><path d='M0 0h24v24H0V0z' fill='none'/><path d='M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z'/></svg>";return a},},{NAME:"ImageMediator"});puremvc.define({name:"jet.view.mediator.MapMediator",parent:puremvc.Mediator},{markers:[],infoWindows:[],activateMap:true,listNotificationInterests:function(){return[jet.AppConstants.ALERT_MAP,jet.AppConstants.SET_GEOLOCATION,jet.AppConstants.SET_MARKER,jet.AppConstants.ADD_SETTINGS]},handleNotification:function(d){switch(d.getName()){case jet.AppConstants.ALERT_MAP:this.handleAlert(d.body);break;case jet.AppConstants.SET_GEOLOCATION:this.handleLocation(d.body);break;case jet.AppConstants.SET_MARKER:this.handleSetMarker(d.body);break;case jet.AppConstants.ADD_SETTINGS:var b=d.getBody();var a=b.settings;if(a!=null&&a.activateMap!=null){this.activateMap=a.activateMap=="1"?false:true}}},onRegister:function(){var d=$(".viewer")[0];var b=document.createElement("div");b.className="mapDiv";$(b).hide();$(b).attr("id","mapDiv");$(b).css("height","100%");$(b).css("min-height","500px");$(b).css("background-color","#000000");$(b).css("margin-top","100px");var a=this;$("body").append(b);$(".mapButton").on("click",function(){a.closeAllInfoWindows();if($(".mapButton").text()=="Hide Map"){$(".mapButton").text("Show Map");$(".showLocationButton").hide();$(".navigator").show();$(".dashboard").show();$("#tabs").show();$("#resources").show();$(".ui-tabs-anchor").show()}else{$(".mapButton").text("Hide Map");$(".showLocationButton").show();$(".navigator").hide();$(".dashboard").hide();$("#tabs").hide();$("#resources").hide();$(".ui-tabs-anchor").hide()}$(b).toggle();$(d).toggle();google.maps.event.trigger(googleMap,"resize");googleMap.fitBounds(a.gParams.geoBounds)});$(".showLocationButton").on("click",function(){if(navigator.geolocation){var e=a.gParams.userLocation;a.gParams.locationMarker.setPosition(e);googleMap.setCenter(e)}});this.loadScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyArhm1MAeLHU-iryXMqe26a9iveKlyAQpU&v=weekly&callback=initGoogleMap",this.callback)},onRemove:function(){},loadScript:function(b,d){var a=this;$.getScript(b,this.callback.bind(a))},callback:function(){var a="0000FF";var e=new google.maps.MarkerImage("https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+a);var d={path:google.maps.SymbolPath.CIRCLE,scale:4,strokeColor:a};var b=this;this.gParams.myNodesInterval=setInterval(b.checkForNodes.bind(b),1000);b.gParams.locationMarker=new google.maps.Marker({map:googleMap,title:"My Location",icon:d})},gParams:{nodesMessage:{nodes:null},myNodesInterval:null,firstLocation:null,geoBounds:null,locationMarker:null,userLocation:null},checkForNodes:function(){var a=this;$(".showLocationButton").hide();jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODES,a.gParams.nodesMessage);if(a.gParams.nodesMessage&&a.gParams.nodesMessage.nodes!=null){clearInterval(a.gParams.myNodesInterval);a.createMarkers(a.gParams)}},createMarkers:function(h){var s=this;var d=h.nodesMessage.nodes;var u=null;var m=null;var t=null;var b=new google.maps.LatLngBounds();for(var n=0;n<d.length;n++){var e=d[n];var o=e.uid;var f=e.node;if(f&&f.getLatitude&&f.getLongitude){var r=this.normalizeCoordinate(f.getLatitude());var a=this.normalizeCoordinate(f.getLongitude());if(f.getTitle){t=f.getTitle()}var l={lat:r,lng:a};if(n==0){h.firstLocation=l}if(!isNaN(r)&&!isNaN(a)&&r!=0&&a!=0&&r!="undefined"&&a!="undefined"){var q="FF0000";var p=new google.maps.MarkerImage("https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+q);var k=new google.maps.Marker({position:l,map:googleMap,title:t,uid:o,visited:false});this.markers.push(k);if(this.activateMap){k.uid=o;k.addListener("click",function(){$(".mapButton").click();jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,this.uid)})}b.extend(k.getPosition())}}}h.geoBounds=b},normalizeCoordinate:function(b){if(b!=null&&b!=undefined){var a=b.split(" ");if(a.length>0){b=this.convertTokens(a)}return b}return 0},convertTokens:function(b){var f=0;var e=0;var a=0;var d=0;if(b.length>0){e=Number(b[0])}if(b.length>1){a=Number(b[1])}if(b.length>2){d=Number(b[2])}f=e+((a*60)+d)/3600;return f},handleLocationError:function(a,b,d){if(b!=null){b.setPosition(d);b.setContent(a?"Error: Location service failed.":"Error: Your browser doesn't support location services.")}},startLocationFinder:function(){},handleLocation:function(d){if(d==null||d==undefined){return}if(d.coords.accuracy<=50){var b=d.coords;var a={lat:b.latitude,lng:b.longitude};this.gParams.userLocation=a;if(this.gParams!=null&&this.gParams.locationMarker!=null){this.gParams.locationMarker.setPosition(a)}}},setUpTest:function(){var b=document.createElement("button");$(b).attr("id","testButton");$(b).css("width","40px");$(b).css("height","40px");$(b).css("position","fixed");$(b).css("top","10px");$(b).css("left","90%");$(b).css("min-height","40px");$(b).css("background-color","#FFFFF");$(b).val("Test");$(b).on("click",function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.ALERT_MAP,"1488419658916")});var a=this;$("body").append(b)},handleAlert:function(d){var b=this;try{$.each(this.markers,function(e,k){if(k.uid==d){var f="You have reached "+k.title+". Click on marker or on 'Hide Map' to learn more.";var h=new google.maps.InfoWindow({content:f});b.infoWindows.push(h);h.open(googleMap,k)}})}catch(a){}b.handleSetMarker(d)},handleSetMarker:function(k){var b={path:google.maps.SymbolPath.CIRCLE,fillColor:"gold",fillOpacity:0.8,scale:0.1,strokeColor:"black",strokeWeight:14};var m="gold";var o={path:google.maps.SymbolPath.CIRCLE,scale:4,strokeColor:m};var n="00FF00";var l=new google.maps.MarkerImage("https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+n);var q="custom_icon.png";for(var e=0;e<this.markers.length;e++){var d=this.markers[e];if(k&&d&&d.uid&&(k.trim()==d.uid.trim())){var a=d.map;var f=d.position;var p=d.title;d.setMap(null);var h=new google.maps.Marker({position:f,map:a,title:p,uid:k,icon:l,visited:true});this.markers.splice(e,1);this.markers.push(h);h.setMap(a);h.addListener("click",function(){$(".mapButton").click();jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,this.uid)});break}}this.checkIfAllSitesVisited()},checkIfAllSitesVisited:function(){var d=true;for(var b=0;b<this.markers.length;b++){var a=this.markers[b];if(a.visited==false){d=false;break}}if(d){jet.AppConstants.REQUEST_ADD_RESOURCE;jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_ADD_RESOURCE,"Awards")}},closeAllInfoWindows:function(){$.each(this.infoWindows,function(a,b){b.close()})}},{NAME:"MapMediator"});puremvc.define({name:"jet.view.mediator.NavigatorComponentMediator",parent:puremvc.Mediator},{automateProgressBar:true,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_NAV_BEGIN,jet.AppConstants.REQUEST_NAV_END,jet.AppConstants.REQUEST_NAV_NORMAL,jet.AppConstants.REQUEST_NAV_SUSPEND,jet.AppConstants.REQUEST_NAV_HIDE,jet.AppConstants.REQUEST_NAV_NEXT,jet.AppConstants.REQUEST_NAV_BACK,jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON,jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,jet.AppConstants.SHOW_FEEDBACK_MESSAGE,jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON,jet.AppConstants.REQUEST_NAV_DISABLE_BACK,jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,jet.AppConstants.REQUEST_NAV_DISABLE,jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR,jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,jet.AppConstants.ADD_SETTINGS]},handleNotification:function(d){switch(d.getName()){case jet.AppConstants.REQUEST_NAV_BEGIN:this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_END:this.disableNext();break;case jet.AppConstants.REQUEST_NAV_NORMAL:this.enableAll();break;case jet.AppConstants.REQUEST_NAV_SUSPEND:this.disableNext();this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_HIDE:this.disableNext();this.disablePrevious();this.hideNext();this.hidePrevious();break;case jet.AppConstants.REQUEST_NAV_NEXT:this.enableNext();break;case jet.AppConstants.REQUEST_NAV_BACK:this.enablePrevious();break;case jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON:this.showCheckAnswer();break;case jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON:this.hideCheckAnswer();break;case jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON:this.disableCheckButton();break;case jet.AppConstants.SHOW_FEEDBACK_MESSAGE:this.showFeedbackMessage(d.getBody());break;case jet.AppConstants.REQUEST_NAV_DISABLE_BACK:this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD:this.disableNext();break;case jet.AppConstants.REQUEST_NAV_DISABLE:this.disableNext();this.disablePrevious();break;case jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR:if(this.automateProgressBar==true){this.updateProgressBar(d.getBody())}break;case jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR:this.automateProgressBar=false;this.updateProgressBar(d.getBody());break;case jet.AppConstants.ADD_SETTINGS:var b=d.getBody();var a=b.settings;if(a!=null&&a.displayNAV!=null){this.viewComponent.displayNAV(a.displayNAV)}if(a!=null&&a.displayPagination!=null){this.viewComponent.displayPagination(a.displayPagination)}break}},onRegister:function(){this.setViewComponent(new jet.view.navigation.NavigationComponent(this));this.hideNext();this.hidePrevious();this.hideCheckAnswer()},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},moveForward:function(){this.sendNotification(jet.AppConstants.FORWARD,null)},moveBackward:function(){this.sendNotification(jet.AppConstants.BACK,null)},enableAll:function(){this.viewComponent.enableNext();this.viewComponent.enablePrevious()},enableNext:function(){this.viewComponent.disableNext();this.viewComponent.enableNext()},enablePrevious:function(){this.viewComponent.disableNext();this.viewComponent.disablePrevious();this.viewComponent.enablePrevious()},disablePrevious:function(){this.viewComponent.disablePrevious()},disableNext:function(){this.viewComponent.disableNext()},hideNext:function(){this.viewComponent.hideNext()},hidePrevious:function(){this.viewComponent.hidePrevious()},showCheckAnswer:function(){this.viewComponent.showCheckAnswer()},hideCheckAnswer:function(){this.viewComponent.hideCheckAnswer()},disableCheckButton:function(){this.viewComponent.disableCheckButton()},showFeedbackMessage:function(a){this.viewComponent.showFeedbackMessage(a)},processQuestion:function(a){a.sendNotification(jet.AppConstants.REQUEST_USER_ACTIVITY,null)},updateProgressBar:function(a){this.viewComponent.updateProgressBar(a.value,a.max)}},{NAME:"NavigatorComponentMediator"});puremvc.define({name:"jet.view.mediator.PageMediator",parent:puremvc.Mediator},{nodes:[],tocItems:[],resourceItems:[],pageLabels:{},resourceLabels:{},queue:[],index:0,settings:{},direction:jet.AppConstants.FORWARD,listNotificationInterests:function(){return[jet.AppConstants.FORWARD,jet.AppConstants.BACK,jet.AppConstants.REQUEST_NEXT_PAGE,jet.AppConstants.REQUEST_NAV_RESUME,jet.AppConstants.REQUEST_USER_ACTIVITY,jet.AppConstants.REPORT_INTERNALLY,jet.AppConstants.REPORT_FEEDBACK_INTERNALLY,jet.AppConstants.REQUEST_NODE,jet.AppConstants.REQUEST_NODES,jet.AppConstants.JUMP_TO_PAGE,jet.AppConstants.JUMP_TO_VALUE,jet.AppConstants.REQUEST_RESET_PAGE,jet.AppConstants.REQUEST_REMOVE_FROM_FLOW,jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,jet.AppConstants.REQUEST_RESTORE_TO_FLOW_BY_ID,jet.AppConstants.REQUEST_ADD_RESOURCE,jet.AppConstants.REQUEST_REMOVE_RESOURCE,jet.AppConstants.REQUEST_REMOVE_ALL_RESOURCES,jet.AppConstants.OPEN_URL,jet.AppConstants.ADD_OVERLAY,jet.AppConstants.REPORT_TO_JOURNAL,jet.AppConstants.REQUEST_NODE_RESOURCE,jet.AppConstants.REPORT_CONFIRMATION,jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY,jet.AppConstants.REQUEST_ALTERNATIVE_CONTENT,jet.AppConstants.REPORT_OUTCOMES]},handleNotification:function(l){switch(l.getName()){case jet.AppConstants.FORWARD:this.direction=jet.AppConstants.FORWARD;if(this.isCurrentNodeAGate()&&this.queue.length<1){return}this.nextNode();break;case jet.AppConstants.REQUEST_NEXT_PAGE:this.direction=jet.AppConstants.FORWARD;this.nextNode();break;case jet.AppConstants.BACK:this.direction=jet.AppConstants.BACK;this.previousNode();break;case jet.AppConstants.REQUEST_NODE:this.showNode(l.getBody(),true);break;case jet.AppConstants.REQUEST_NODES:this.getNodes(l.getBody());break;case jet.AppConstants.OPEN_URL:this.openURL(l.getBody(),true);break;case jet.AppConstants.JUMP_TO_PAGE:this.jumpToPage(l.getBody(),true);break;case jet.AppConstants.JUMP_TO_VALUE:var m=l.getBody();this.jumpToValue(m);break;case jet.AppConstants.REQUEST_RESET_PAGE:var m=l.getBody();this.resetPage(m);break;case jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY:this.resetInteractivity();break;case jet.AppConstants.REQUEST_REMOVE_FROM_FLOW:this.removePageFromFlow();break;case jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID:this.removePageFromFlowByID(l.getBody());break;case jet.AppConstants.REQUEST_RESTORE_TO_FLOW_BY_ID:this.restorePageToFlowByID(l.getBody());break;case jet.AppConstants.REQUEST_ADD_RESOURCE:this.addNewResourceItem(l.getBody());break;case jet.AppConstants.REQUEST_REMOVE_RESOURCE:this.removeResourceItem(l.getBody());break;case jet.AppConstants.REQUEST_REMOVE_ALL_RESOURCES:this.removeAllResourceItems();break;case jet.AppConstants.ADD_OVERLAY:this.addOverlay(l.getBody(),true);break;case jet.AppConstants.REQUEST_NODE_RESOURCE:this.showNodeAsResource(l.getBody(),true);break;case jet.AppConstants.REQUEST_NAV_RESUME:this.resumeNavigation();break;case jet.AppConstants.REQUEST_USER_ACTIVITY:var f=this.nodes[this.index];var h=f.uid;var n=f.node.evaluateUserActivity();this.facade.sendNotification(jet.AppConstants.SHOW_FEEDBACK_MESSAGE,n);this.reportUserActivity(f.node,h);var a=f.node.getIsUserCorrect();this.processFeedbackAndBranchingOptions(f.node,a,null);this.facade.sendNotification(jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON,null);this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null);this.getReport();var b=a?jet.AppConstants.CORRECT_ANSWER:jet.AppConstants.WRONG_ANSWER;this.facade.sendNotification(b,null);break;case jet.AppConstants.REPORT_CONFIRMATION:var f=this.nodes[this.index];f.node.processNotification(l.getName(),l.getBody());break;case jet.AppConstants.REPORT_OUTCOMES:var f=this.nodes[this.index];f.node.processNotification(l.getName(),l.getBody());break;case jet.AppConstants.REPORT_INTERNALLY:var f=this.nodes[this.index];f.node.processNotification(l.getName(),l.getBody());var d=l.getBody();m=d.userTotal*180/d.scoreTotal;this.setMeter(m);break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLY:var e=l.getBody();var f=this.nodes[this.index];f.node.processNotification(l.getName(),l.getBody());break;case jet.AppConstants.REPORT_TO_JOURNAL:var k=l.getBody();var f=this.nodes[this.index];f.node.processNotification(l.getName(),l.getBody());break;case jet.AppConstants.REQUEST_ALTERNATIVE_CONTENT:this.getAlternativeContent()}},reportUserActivity:function(b,a){var d={uid:a,userPoints:b.getUserPoints(),totalPoints:b.getTotalPoints()};this.facade.sendNotification(jet.AppConstants.REPORT_USER_ACTIVITY,d);this.getReport()},registerOutcome:function(h,b,f){var a="";var e="";var k=null;if(f!=null){k=f.split(":")}if(k.length==2){a=k[0].trim();e=k[1].trim()}else{return}var d={uid:b,outcomeguid:a,shortDesc:e};this.facade.sendNotification(jet.AppConstants.LINK_OUTCOME,d)},reportUserFeedbackActivity:function(b){var a=b.getUserFeedback();this.facade.sendNotification(jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY,a)},getReport:function(){this.facade.sendNotification(jet.AppConstants.GET_REPORT)},requestConfirmation:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CONFIRMATION);var a=this.nodes[this.index];a.node.processNotification(jet.AppConstants.REQUEST_CONFIRMATION)},sendGraphData:function(){var f=[[10],[8],[2]];var d=["My Data"];var e=["#0000FF","#FF0000","#FFFF00"];var a=[{label:"Test 1"},{label:"Test 2"},{label:"Test 3"}];var b={};b.name="BARGRAPH";b.data=f;b.ticks=d;b.seriesColors=e;b.series=a;this.facade.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,b)},recordUserResponse:function(b,d){var a={uid:b,page_ID:d.page_ID,heading:d.heading,response:d.response};setJetValue(d.page_ID,d.response);this.facade.sendNotification(jet.AppConstants.RECORD_USER_RESPONSE,a)},recordUserInteraction:function(a,b){this.facade.sendNotification(jet.AppConstants.RECORD_USER_INTERACTION,b)},processFeedbackAndBranchingOptions:function(h,d,a){var l;branchOptions=new Object();if(a!=null){l=a;a=null}else{var f=h.getBranchOptions();if(f==null){return}branchOptions.checkedOption=f.checkedOption;branchOptions.checkedValue=f.checkedValue;branchOptions.showFeedback=f.showFeedback;branchOptions.feedback=f.feedback;branchOptions.branchOptions=f.branchOptions;branchOptions.branchDelay=f.branchDelay;l=branchOptions}if(l.showFeedback==undefined){l.showFeedback="false";l.branchDelay=0}if(l.showFeedback.toUpperCase()=="TRUE"){var e=l.feedback;e=e.replace(/\|;/gi,"");var o="<p>"+e+"</p>";this.showPopup(o)}var p=parseFloat(l.branchDelay);var m=isNaN(p)?0:p*1000;var k=this.processBranchingOptions;var b=this;switch(l.branchOptions){case jet.AppConstants.BRANCH_IMMEDIATELY:setTimeout(function(){k.call(b,h,d)},m);break;case jet.AppConstants.BRANCH_NEXT_BUTTON:l.branchOptions=jet.AppConstants.BRANCH_IMMEDIATELY;l.branchDelay=0;l.showFeedback="false";var n={node:h,status:d,branchingOptions:l};this.queue.push(n);break;default:k.call(b,h,d);break}},processBranchingOptions:function(a,b){var d=a.getBranchOptions();this.executeBranch(d,b)},processFeedbackAndCalcOptions:function(k,e,a){var f;calcOptions=new Object();if(a!=null){f=a;a=null}else{if(k==null||k.getCalcOptions==null){return}var h=k.getCalcOptions();if(h==null){return}calcOptions.checkedOption=h.checkedOption;calcOptions.checkedValue=h.checkedValue;calcOptions.showFeedback=h.showFeedback;calcOptions.feedback=h.feedback;calcOptions.branchOptions=h.branchOptions;calcOptions.branchDelay=h.branchDelay;f=calcOptions}if(f.showFeedback==undefined){f.showFeedback="false";f.branchDelay=0}if(f.showFeedback.toUpperCase()=="TRUE"){var n="<p>"+f.feedback+"</p>";this.showPopup(n)}var o=parseFloat(f.branchDelay);var l=isNaN(o)?0:o*1000;var d=this.processCalcOptions;var b=this;switch(f.branchOptions){case jet.AppConstants.BRANCH_IMMEDIATELY:setTimeout(function(){d.call(b,k,e)},l);break;case jet.AppConstants.BRANCH_NEXT_BUTTON:f.branchOptions=jet.AppConstants.BRANCH_IMMEDIATELY;f.branchDelay=0;f.showFeedback="false";var m={node:k,status:e,branchingOptions:f};this.queue.push(m);break;default:d.call(b,k,e);break}},processCalcOptions:function(d,e){if(d==null||d.getCalcOptions==null){return}var f=null;var b=null;var a=d.getCalcOptions();if(a!=null&&typeof a!=="undefined"&&a.checkedOption!=null){f=a.checkedOption.trim();b=a.checkedValue.trim();if(f.toUpperCase()!="NO ACTION"&&f!=null&&f!=""&&typeof(f)!="undefined"){this.executeBranch(a,e)}}d.postCalcOptions()},executeBranch:function(k,a){if(k==null||k==undefined){return}if(window.console){console.log("execute branch called "+k.checkedOption)}var d;var l;if(k.uncheckedOption){d=a?k.checkedOption:k.uncheckedOption;l=a?k.checkedValue:k.uncheckedValue}else{d=k.checkedOption;l=k.checkedValue}if(window.console){console.log("which Option "+d)}switch(d){case jet.AppConstants.JUMP_TO_PAGE:if(l.indexOf("ID:")>-1){var o=$.trim(l).replace(/.*\(ID:|\)/g,"");this.hideNodes();this.showNode(o,true);this.resumeNavigation();break}else{var o=this.pageLabels[l.toLowerCase()];if(o!=null&&o!=undefined){this.hideNodes();this.showNode(o,true);this.resumeNavigation();break}}break;case jet.AppConstants.JUMP_TO_VALUE:if(l.indexOf("VARIABLE:")>-1){l=$.trim(l).replace("VARIABLE:","");var m=getJetValue(l);var o=this.pageLabels[String(m).toLowerCase()]}if(o!=null&&o!=undefined){this.hideNodes();this.showNode(o,true);this.resumeNavigation();break}break;case"Go to Next Page":this.nextNode();break;case"Go to Previous Page":this.previousNode();break;case"Reset Page":this.hideNodes();var n=this.getCurrentNode();n.node.enableInteractivity();n.node.clearFeedback();n.node.clearBranchOptions();n.node.setUserPoints(0);this.showNode(n.uid,true);this.resumeNavigation();break;case jet.AppConstants.OPEN_URL:var b=$.trim(l);if(b.match(/^javascript:.+/)){b=b.replace(/javascript:\i\g/,"")}else{window.open(b,"_blank","menubar=1,resizable=1,width=800,height=600")}break;case jet.AppConstants.ADD_OVERLAY:if(l.indexOf("ID:")>-1){var o=$.trim(l).replace(/.*\(ID:|\)/g,"");var n=this.findNode(o)[0];this.showNodeAsOverlay(n)}else{var o=this.pageLabels[l.toLowerCase()];if(o!=null&&o!=undefined){var n=this.findNode(o)[0];this.showNodeAsOverlay(n)}}break;case jet.AppConstants.SET_VALUE:if(l.indexOf("VARIABLE:")>-1){var q=l.split(":");if(q.length==3){var r=q[1];var s=q[2];setJetValue(r,s)}}break;case jet.AppConstants.APPEND_VALUE:if(l.indexOf("VARIABLE:")>-1){var q=l.split(":");if(q.length==3){var r=q[1];var s=q[2];appendJetValue(r,s)}}break;case jet.AppConstants.SHOW_NODE:if(l.indexOf("ID:")>-1){var o=$.trim(l).replace(/.*\(ID:|\)/g,"");var n=this.findNode(o)[0];this.showNodeAsOverlay(n)}else{var o=this.pageLabels[l.toLowerCase()];if(o!=null&&o!=undefined){}}break;case jet.AppConstants.REMOVE_FROM_FLOW:var n=this.getCurrentNode();n.node.setInFlow(false);break;case jet.AppConstants.EXECUTE_COMMAND:if(window.console){console.log("ParserAPIHooks = "+jsParser)}if(typeof jsParser&&typeof jsParser.parseAndExecute!=="undefined"&&jsParser.parseAndExecute!=null){try{var t=jsParser.parseAndExecute(l,getExposedMethods(),10000);if(window.console){console.log("Parser execute called with result: "+t)}}catch(p){window.alert(p)}}break;case jet.AppConstants.LINK_TO_OUTCOME:var n=this.getCurrentNode();var o=n.uid;this.registerOutcome(n,o,l);break;case jet.AppConstants.SHOW_AS_LAYER:this.showPageAsLayer(l);break;case jet.AppConstants.SEND_XAPI_STATEMENT:var q=l.split(":");if(q.length==2){var f=q[0];var h=q[1];sendXAPIStatement(f,h)}}},onRegister:function(){},onRemove:function(){},nextNode:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);updateNavigation=this.updateNavigation;var b=this;if(this.processQueue()){return}if(this.index<this.nodes.length-1){this.index++}var d=this.determineNextNode(true,this.index);if(d==null){return}var a=d.uid;this.hideNodes();setTimeout(function(){b.showNode(a,false);updateNavigation.call(b);d.node.postProcess()},100);if(window.console){console.log("> "+this.index+" "+a+" ")}},previousNode:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);updateNavigation=this.updateNavigation;var b=this;if(this.processQueue()){return}if(this.index>0){this.index--}var d=this.determineNextNode(false,this.index);if(d==null){return}var a=d.uid;this.hideNodes();setTimeout(function(){b.showNode(a,false);updateNavigation.call(b);d.node.postProcess()},100);if(window.console){console.log("< "+this.index+" "+a+" ")}},isCurrentNodeAGate:function(){return this.nodes[this.index].node.getName().match("Gate")},determineNextNode:function(d,a){var b=this.nodes[a];if(b.node.getInFlow()==true&&(!this.isCurrentNodeAGate()||d)){this.index=a;return b}else{if(d){while(a<this.nodes.length){a++;b=this.nodes[a];if(b.node.getInFlow()==true){this.index=a;return b}}return null}else{while(a>0){a--;b=this.nodes[a];if(b.node.getInFlow()==true){this.index=a;return b}}return null}}},processQueue:function(){if(this.queue.length>0){var b=this.queue[0];var d=b.node;var e=b.isCorrect;var a=b.branchingOptions;this.processFeedbackAndBranchingOptions(d,e,a);this.queue.pop();return true}return false},addNode:function(b,a){this.nodes.push({node:b,uid:a})},addTOCItem:function(e,h){var f=null;var k;var a,d;var l=this;$(e).children().find("input").each(function(){var m=$(this).attr("optionStore");if(m=="Checkbox_TOC"){k=$(this).text()}});$(e).children().find("input").each(function(){var m=$(this).attr("optionStore");if(m=="Title"){a=$(this).text();l.pageLabels[a]=h}if(m=="NodeSelector"){d=$(this).text()}});if(k=="true"){var b={title:a,uid:h,parentUid:d};this.tocItems.push(b)}},constructTOC:function(){var a={tocItems:this.tocItems,settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_TOC,a)},constructTitle:function(){var a={settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_TITLE,a)},sendSettings:function(){var a={settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_SETTINGS,a)},addResourceItem:function(e,h){var f=null;var k;var a,d;var l=this;$(e).children().find("input").each(function(){var m=$(this).attr("optionStore");if(m=="Checkbox_Resource"){k=$(this).text()}});$(e).children().find("input").each(function(){var m=$(this).attr("optionStore");if(m=="Title"){a=$(this).text();l.resourceLabels[a]=h}});if(k=="true"){var b={title:a,uid:h,};this.resourceItems.push(b)}},constructResources:function(){var a={tocItems:this.resourceItems,settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_RESOURCES,a)},getNode:function(b){var d=null;for(var a=0;a<this.nodes.length;a++){var e=this.nodes[a];if(e!=null&&e.uid==b){d=e.node;break}}return d},getCurrentNode:function(){var a=this.nodes[this.index];return a},getPreviousNode:function(){var a=null;if(this.index>0){a=this.nodes[this.index-1]}return a},getNextNode:function(){var a=null;if(this.index<this.nodes.length-1){a=this.nodes[this.index+1]}return a},hideNodes:function(){var a=this.index;$.each(this.nodes,function(b,d){d.node.show(false)})},getNodes:function(a){if(a.hasOwnProperty("nodes")){if(isFirstPageShown()){a.nodes=this.nodes}}},showNode:function(d,f){var b;var e=this;var a=null;$.each(this.nodes,function(k,l){l.node.show(false);if(l.uid==d){b=k;e.index=b;a=l.node}});a.show(true);setFirstPageShown();var h=this.nodes[this.index];this.facade.sendNotification(jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON,null);this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_POPUP,null);if(f){if(h&&h.node){h.node.postProcess()}}this.updateNavigation();this.processFeedbackAndCalcOptions(h.node,true)},showNodeAsResource:function(b){var a=null;var e=this;var d=null;$.each(this.nodes,function(f,n){if(n.uid==b){index=f;d=b;if(n.node.getHTMLContent){var k=n.node.getContentAsResource();var l=document.createElement("div");$(l).addClass("colorboxDiv");switch(k){case"CLONE":var p=n.node.getClonedContent();p.css("visibility","visible");p.css("display","block");p.appendTo(l);break;case"REPARENT":var m=n.node.getReParentedContent();var h=$(m.getContentDiv());var o=$(h).css("padding-bottom");$(h).css("padding-bottom",0);a=h.parent().first();h.appendTo(l);m.show(true);break;default:$(l).html(k)}$("body").append(l);$.colorbox({html:l,iframe:false,maxWidth:"98%",overlayClose:true,onClosed:function(){if(h!=null){var q=e.getCurrentNode();e.showNode(q.uid,true);if(d!=q.uid){m.show(false)}$(h).css("padding-bottom",o);h.appendTo(a)}},onComplete:function(){$.colorbox.resize({width:"80%"});e.updateNavigation()}})}}})},showNodeAsLayer:function(a){$.each(this.nodes,function(b,d){if(d.uid==a){d.node.show(true)}})},showFirstNode:function(){if(this.nodes.length>0){var b=this.nodes[0];var a=b.uid;this.showNode(a,true)}this.retrieveSCORMData();this.facade.sendNotification(jet.AppConstants.IS_INTERACTIVE_TRUE,null)},retrieveSCORMData:function(){var a=0;var b=this.facade;var e=this;b.sendNotification(jet.AppConstants.REQUEST_USER_DATA,null);var d=setInterval(function(){a++;if(LMSIsInitialized()||a>5){b.sendNotification(jet.AppConstants.REQUEST_USER_DATA,null);clearInterval(d);$("body").css("cursor","auto")}},1000)},updateNavigation:function(){this.facade.sendNotification(jet.AppConstants.PAUSE_VIDEO,null);if(this.index>=this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}if(this.index<1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}if(this.index>0&&this.index<this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_NORMAL,null)}if(this.index==0&&this.index<this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_NEXT,null)}if(this.index==this.nodes.length-1&&this.index>0){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_BACK,null)}if(this.nodes.length<=1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE,null)}this.facade.sendNotification(jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR,{value:this.index,max:this.nodes.length-1});if(this.getCurrentNode()!=null){this.facade.sendNotification(jet.AppConstants.REQUEST_UPDATE_MENUS,this.getCurrentNode().uid);postCurrentUID(this.getCurrentNode().uid);this.processWallsAndGates();pauseAudio()}},processWallsAndGates:function(){if(this.index>0&&this.nodes[this.index-1].node.getName().match("Wall")){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}if(this.index<this.nodes.length-1&&this.nodes[this.index+1].node.getName().match("Wall")){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}for(var b=this.index-1;b>0;b--){if(this.nodes[b].node.getName()=="Gate"){var d=this.nodes[b].node;var a=d.getNavigationDefault();if(a=="true"){if(d.getAllowNext()=="false"){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}if(d.getAllowBack()=="false"){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}}else{continue}break}}},showCheckAnswerButton:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_HIDE,null);this.facade.sendNotification(jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,null)},setData:function(a){},getProperties:function(a){lxmlProxy=this.facade.retrieveProxy(jet.model.proxy.LXMLProxy.NAME);return lxmlProxy.getProperties(a)},parseProperties:function(a,b){this.facade.sendNotification(jet.AppConstants.PARSE_PROPERTIES,{component:a,properties:b})},handleEvent:function(a){},setMediator:function(a){this.mediator=a},buttonClick:function(){this.facade.sendNotification(jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,null)},requestReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_TO_SCORM_API,null)},requestConfirmationReport:function(){this.facade.sendNotification(jet.AppConstants.GET_REPORT_FROM_SCORM_API,null)},requestFeedbackReport:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_FEEDBACK_REPORT,null)},requestOutcomesReport:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_OUTCOMES_REPORT,null)},requestTerminate:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_TERMINATE,null)},requestJournalReport:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_JOURNAL_REPORT,null)},requestObjectiveAnswersReport:function(){this.facade.sendNotification(jet.AppConstants.RECORD_OBJECTIVE_RESPONSES,null)},resetScore:function(){this.facade.sendNotification(jet.AppConstants.RESET_SCORES,null);for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions();this.nodes[a].node.setUserPoints(0)}},resetInteractivityOnly:function(){for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.setUserPoints(0);this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions()}},resetInteractivity:function(){for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions()}},resetCustomScores:function(a){a=a.replace(/ /g,"");var d=a.split(",");for(var b=0;b<d.length;b++){setJetValue(d[b],0)}},findNode:function(a){return $.grep(this.nodes,function(b){return b.uid==a?true:false})},showNodeAsOverlay:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_OVERLAY,a)},showPageAsLayer:function(a){var d="";var f=null;try{f=JSON.parse(a);var b=f.id;if(b.indexOf("ID:")>-1){d=$.trim(b).replace(/.*\(ID:|\)/g,"");showAsLayer(d,f.value,f.left,f.top,f.zindex,f.captureclicks)}}catch(e){}},showPopup:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_POPUP,a)},showToolTip:function(b,a,e){var d={htmlString:b,xpos:a,ypos:e};this.facade.sendNotification(jet.AppConstants.REQUEST_TOOLTIP,d)},hideToolTip:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_TOOLTIP)},showMeter:function(b,a,e){var d={htmlString:b,xpos:a,ypos:e};this.facade.sendNotification(jet.AppConstants.REQUEST_METER,d)},setMeter:function(a){this.facade.sendNotification(jet.AppConstants.SET_METER,a)},hideMeter:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_METER)},resumeNavigation:function(){this.updateNavigation()},setSettings:function(a){this.settings=a;setProjectSettings(a)},getSettings:function(){return this.settings},startShowTransition:function(h){if(h==null||h==undefined){return}var e=this.getSettings();var k=e.Transition;var b=Number(e["Transition Time"]);switch(k){case"0":h.show();break;case"1":h.fadeIn(b);break;case"2":h.show();var f="-930px";var a="930px";if(this.direction==jet.AppConstants.FORWARD){f="-=930px";a="930px"}else{f="+=930px";a="-930px"}h.css("left",a);h.show();var d=h;h.animate({left:f},b,function(){});break;case"3":h.show({effect:"clip",duration:b});break;case"4":h.show({effect:"highlight",duration:b});break;case"5":h.show({effect:"puff",duration:b});break;case"6":h.show({effect:"blind",duration:b});break;case"7":h.show({effect:"bounce",duration:b});break;default:h.show();break}},startHideTransition:function(d){if(d==null||d==undefined){return}var b=this.getSettings();var e=b.Transition;var a=Number(b["Transition Time"]);if(this.index<1){e="0"}e="0";switch(e){case"0":d.hide();break;case"1":d.fadeOut(a);break;case"2":d.hide();break;case"5":d.hide({effect:"explode",pieces:9,duration:a});break;default:d.hide();break}},jumpToPage:function(a){if(a.length>10&&!isNaN(a)){var b=a;this.hideNodes();this.showNode(b,true);this.resumeNavigation()}else{if(a.indexOf("ID:")>-1){var b=$.trim(a).replace(/.*\(ID:|\)/g,"");this.hideNodes();this.showNode(b,true);this.resumeNavigation()}else{a=a.toLowerCase();a=a.replace(/ /g,"");var d=this.findProperty(this.pageLabels,a);var b=this.pageLabels[d];if(b!=null&&b!=undefined){this.hideNodes();this.showNode(b,true);this.resumeNavigation()}}}},jumpToValue:function(a){if(a.indexOf("VARIABLE:")>-1){a=$.trim(a).replace("VARIABLE:","");var d=getJetValue(a);var b=this.pageLabels[String(d).toLowerCase()]}if(b!=null&&b!=undefined){this.hideNodes();this.showNode(b,true);this.resumeNavigation()}},openURL:function(whichValue){var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");eval(url)}else{window.open(url,"_blank","menubar=1,resizable=1,width=800,height=600")}},addOverlay:function(a){if(a.indexOf("ID:")>-1){var b=$.trim(a).replace(/.*\(ID:|\)/g,"");var d=this.findNode(b)[0];this.showNodeAsOverlay(d)}else{var b=this.pageLabels[a.toLowerCase()];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];this.showNodeAsOverlay(d)}}},resetPage:function(a){var b=null;if(isEmpty(a)){b=this.getCurrentNode()}else{if(a!=null&&a!=undefined){b=this.findNode(a)[0]}}b.node.enableInteractivity();b.node.clearFeedback();b.node.clearBranchOptions();b.node.setUserPoints(0);this.resumeNavigation()},removePageFromFlow:function(){var a=this.getCurrentNode();a.node.setInFlow(false)},removePageFromFlowByID:function(a){var b=this.pageLabels[a.toLowerCase()];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];d.node.setInFlow(false)}},restorePageToFlowByID:function(a){var b=this.pageLabels[a.toLowerCase()];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];d.node.setInFlow(true)}},addNewResourceItem:function(e){var d=this.pageLabels[e];if(typeof d=="undefined"||d==null||d==""){return}if(!this.isResourceItem(e)){this.resourceLabels[e]=d;var b=e.indexOf("{");if(b>0){e=e.substring(0,b)}var a={title:e,uid:d,};this.resourceItems.push(a);this.constructResources()}},removeResourceItem:function(a){this.resourceItems=this.resourceItems.filter(this.resourceFilter,a);this.constructResources()},removeAllResourceItems:function(){this.resourceItems=[];this.constructResources()},resourceFilter:function(d,b,e){var a=d;if(a.title==this){return false}return true},isResourceItem:function(d){for(var b=0;b<this.resourceItems.length;b++){var a=this.resourceItems[b];if(a.title==d){return true}}return false},findProperty:function(d,b){var a=null;for(prop in d){a=prop;prop=prop.toLowerCase();prop=prop.replace(/ /g,"");if(prop==b){return a}}return a},getAlternativeContent:function(){var b=this.getCurrentNode();if(b.node.getAlternativeContent){var a=b.node.getAlternativeContent();this.showPopup(a)}},getIndexOfNode:function(b){for(var a=0;a<this.nodes.length;a++){var d=this.nodes[a];if(d.getUID()==b){return a}}return -999},getPageByLabel:function(a){var b=this.pageLabels[a];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];return d}},},{NAME:"QuestionPageMediator"});puremvc.define({name:"jet.view.mediator.QuestionProcessorMediator",parent:puremvc.Mediator},{report:{},outcomesReport:{},startTime:null,feedbackReport:[],interactionID:-1,interactions:[],outcomes:[],objectiveQuestionInteractions:[],learnerName:"testUser",customTotalScore:null,customUserScore:null,settings:null,intervalDATAChecker:null,listNotificationInterests:function(){return[jet.AppConstants.SET_SCORE,jet.AppConstants.GET_SCORE,jet.AppConstants.SET_CUSTOM_USER_SCORE,jet.AppConstants.SET_CUSTOM_TOTAL_SCORE,jet.AppConstants.GET_REPORT,jet.AppConstants.GET_TOTAL_POINTS,jet.AppConstants.INCREMENT_SCORE,jet.AppConstants.INCREMENT_TOTAL_POINTS,jet.AppConstants.RESET_SCORES,jet.AppConstants.RESET_SECTION_SCORES,jet.AppConstants.REPORT_USER_ACTIVITY,jet.AppConstants.REPORT_TO_SCORM_API,jet.AppConstants.REQUEST_CONFIRMATION,jet.AppConstants.RECORD_USER_RESPONSE,jet.AppConstants.RECORD_USER_INTERACTION,jet.AppConstants.REQUEST_FEEDBACK_REPORT,jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY,jet.AppConstants.REQUEST_JOURNAL_REPORT,jet.AppConstants.REQUEST_USER_DATA,jet.AppConstants.STORE_USER_RESPONSES,jet.AppConstants.RECORD_OBJECTIVE_RESPONSES,jet.AppConstants.ADD_SETTINGS,jet.AppConstants.REQUEST_SUSPEND_DATA,jet.AppConstants.REQUEST_RETRIEVE_DATA,jet.AppConstants.REQUEST_CLEAR_JET_DATA,jet.AppConstants.REQUEST_TERMINATE,jet.AppConstants.SET_COMPLETION_STATUS,jet.AppConstants.LINK_OUTCOME,jet.AppConstants.REQUEST_OUTCOMES_REPORT]},handleNotification:function(m){switch(m.getName()){case jet.AppConstants.INCREMENT_SCORE:this.incrementScore();break;case jet.AppConstants.INCREMENT_TOTAL_POINTS:this.incrementTotalPoints();break;case jet.AppConstants.GET_SCORE:this.getScore();break;case jet.AppConstants.SET_CUSTOM_USER_SCORE:var n=m.getBody();var h=n;this.setCustomUserScore(h);break;case jet.AppConstants.SET_CUSTOM_TOTAL_SCORE:var n=m.getBody();var h=n;this.setCustomTotalScore(h);break;case jet.AppConstants.GET_REPORT:this.getReport();break;case jet.AppConstants.GET_TOTAL_POINTS:this.getTotalPoints();break;case jet.AppConstants.REPORT_USER_ACTIVITY:var n=m.getBody();this.report[n.uid]={userPoints:n.userPoints,totalPoints:n.totalPoints};break;case jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY:var n=m.getBody();this.feedbackReport.push(n);break;case jet.AppConstants.RECORD_USER_RESPONSE:var n=m.getBody();uid=n.uid;heading=n.heading;response=n.response;this.reportUserResponseToSCORMAPI(uid,heading,response);break;case jet.AppConstants.RECORD_OBJECTIVE_RESPONSES:this.reportObjectiveResponsesToSCORMAPI();break;case jet.AppConstants.RECORD_USER_INTERACTION:var n=m.getBody();uid=n.uid;var d=n.questionType;var f=n.question;var l=n.learnerResponse;var k=n.correctResponse;var o=n.result;this.reportUserInteractionToSCORMAPI(uid,d,f,l,k,o);break;case jet.AppConstants.REPORT_TO_SCORM_API:this.getReport();this.reportToSCORMAPI();break;case jet.AppConstants.REQUEST_CONFIRMATION:this.getReportFromSCORMAPIAfterDelay();break;case jet.AppConstants.RESET_SCORES:this.report=null;this.report={};this.feedbackReport=null;this.feedbackReport=[];break;case jet.AppConstants.REQUEST_FEEDBACK_REPORT:this.getFeedbackReport();break;case jet.AppConstants.REQUEST_TERMINATE:window.setTimeout(this.terminate,5000);break;case jet.AppConstants.REQUEST_JOURNAL_REPORT:this.getJournalReport();break;case jet.AppConstants.REQUEST_USER_DATA:this.getUserData();break;case jet.AppConstants.STORE_USER_RESPONSES:this.storeUserResponses();break;case jet.AppConstants.REQUEST_SUSPEND_DATA:this.suspendData();break;case jet.AppConstants.REQUEST_RETRIEVE_DATA:var n=m.getBody();var a="";var b="";if(n&&n.successPage&&n.failPage){a=n.successPage;b=n.failPage}this.retrieveData(a,b);break;case jet.AppConstants.REQUEST_CLEAR_JET_DATA:this.clearData();break;case jet.AppConstants.SET_COMPLETION_STATUS:var n=m.getBody();var h=n;this.setCompletionStatus(h);break;case jet.AppConstants.ADD_SETTINGS:var e=m.getBody();this.settings=e.settings;if(this.settings!=null&&this.settings.enforceSCORM!=null){if(this.settings.enforceSCORM=="0"&&LMSIsInitialized&&!LMSIsInitialized()){alert("You are not connected to a Learning Management System.  No record of your performance will be kept.")}}break;case jet.AppConstants.LINK_OUTCOME:var e=m.getBody();this.registerOutcome(e);break;case jet.AppConstants.REQUEST_OUTCOMES_REPORT:this.reportOutcomes();break}},onRegister:function(){this.startTime=Date.now()},onRemove:function(){},handleEvent:function(a){},addQuestion:function(a,b){questionArray.push({uid:a,keys:b})},incrementScore:function(a){},incrementTotalPoints:function(a){},getScore:function(){},getCustomUserScore:function(){return this.customUserScore},setCustomUserScore:function(a){this.customUserScore=a},getCustomTotalScore:function(){return this.customTotalScore},setCustomTotalScore:function(a){this.customTotalScore=a},getTotalPoints:function(){},getReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_INTERNALLY,this.getReportSummary())},getFeedbackReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_FEEDBACK_INTERNALLY,this.feedbackReport)},terminate:function(){var f="";var a="";var b=doTerminate();if(b=="true"){f="You are now properly disconnected. This is normal. To better your score, wait a couple of minutes and then refresh browser to reconnect."}else{f=""}var e={status:"Terminate",message:f};var d=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);d.sendNotification(jet.AppConstants.REPORT_CONFIRMATION,e)},getJournalReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_TO_JOURNAL,this.interactions)},getReportSummary:function(){if(this.getCustomReportSummary()!=null){return this.getCustomReportSummary()}var b=0;var a=0;$.each(this.report,function(f,e){var h=parseFloat(e.userPoints);h=isNaN(h)?0:h;var d=parseFloat(e.totalPoints);d=isNaN(d)?0:d;a+=h;b+=d});setJetValue("system_report",{userTotal:a,scoreTotal:b});return({userTotal:a,scoreTotal:b})},getCustomReportSummary:function(){var b=this.getCustomTotalScore();var a=this.getCustomUserScore();if(b!=null&&a!=null){return({userTotal:a,scoreTotal:b})}else{return null}},reportToSCORMAPI:function(){var a=this.getReportSummary();var f=a.userTotal;var l=a.scoreTotal;var d=this.getSessionTime();try{var e=f/l;doSetValue("cmi.score.scaled",e);doSetValue("cmi.score.min",0);doSetValue("cmi.score.max",l);doSetValue("cmi.score.raw",f);doSetValue("cmi.session_time",d);var k=this.getCompletionStatus(e);doSetValue("cmi.completion_status",k);var h=this.getSuccessStatus(e);doSetValue("cmi.success_status",h);window.setTimeout(this.executeDoCommit,1000)}catch(b){if(console&&console.log){console.log("QuestionProcessor reports "+b)}}},getCompletionStatus:function(b){if(this.settings.passThreshold&&this.settings.passThreshold=="0"){return"completed"}if(this.settings.completionCondition&&this.settings.completionCondition=="0"){return"completed"}if(this.settings.completionCondition&&this.settings.completionCondition=="1"){if(this.settings.passThreshold){var a=this.settings.passThreshold;a=a/10;if(b>=a){return"completed"}else{return"incomplete"}}}return"completed"},getSuccessStatus:function(b){if(this.settings.passThreshold&&this.settings.passThreshold=="0"){return"completed"}if(this.settings.completionCondition&&this.settings.completionCondition=="0"){return"completed"}if(this.settings.completionCondition&&this.settings.completionCondition=="1"){if(this.settings.passThreshold){var a=this.settings.passThreshold;a=a/10;if(b>=a){return"passed"}else{return"failed"}}}return"completed"},getReportFromSCORMAPIAfterDelay:function(){window.setTimeout(this.getReportFromSCORMAPI,5000)},getReportFromSCORMAPI:function(){var n=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var l=LMSIsInitialized();if(!l){var b="You are not currently connected to a Learning Management System. Your scores are not saved.";var o={status:"Failure",message:b};n.sendNotification(jet.AppConstants.REPORT_CONFIRMATION,o);return}var e=null;var f=null;var k=null;var m=null;var h=null;var d=null;try{k=doGetValue("cmi.score.scaled");m=doGetValue("cmi.score.min");h=doGetValue("cmi.score.max");d=doGetValue("cmi.score.raw");var o={status:"Success",message:"Success",scaledScore:k,minValue:m,maxValue:h,rawValue:d};n.sendNotification(jet.AppConstants.REPORT_CONFIRMATION,o)}catch(a){if(console&&console.log){console.log("QuestionProcessorMediator reports: "+a)}}},reportUserResponseToSCORMAPI:function(d,f,a){this.storeUserResponse(d,f,a);try{this.reportInteractionsToJetStore();var e=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+e+".id","urn:lodestarlearning.com/"+d);doSetValue("cmi.interactions."+e+".type","long-fill-in");doSetValue("cmi.interactions."+e+".learner_response",a);this.storeUserResponses();window.setTimeout(this.executeDoCommit,1000)}catch(b){alert(b)}},reportUserInteractionToSCORMAPI:function(h,d,b,k,f,a){try{var l=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+l+".id","urn:lodestarlearning.com/"+h);doSetValue("cmi.interactions."+l+".type",d);doSetValue("cmi.interactions."+l+".description",b);doSetValue("cmi.interactions."+l+".learner_response",k);doSetValue("cmi.interactions."+l+".correct_responses."+l+".pattern",f);doSetValue("cmi.interactions."+l+".result",a);window.setTimeout(this.executeDoCommit,1000);this.storeObjectiveResponse(h,d,b,k,f,a)}catch(e){alert(e)}},getUserData:function(){var a=this;try{if(LMSIsInitialized()==true){var b=doGetValue("cmi.learner_name");window.setTimeout(function(){if(b!=null&&b!=undefined&&b.length>0){a.learnerName=b}},2000)}}catch(d){}finally{window.setTimeout(function(){var f=null;if(localStorage!=null){var e=localStorage[window.location+"/"+a.learnerName+"/interactions"];if(e!=null&&typeof e!="undefined"){try{f=JSON.parse(e)}catch(h){}}}if(f!=null&&f!=undefined&&f.length>0){a.interactions=f}},2000);window.setTimeout(a.getInteractionsFromJetStore(a),2000)}},getUserResponse:function(d){for(var b=0;b<this.interactions.length;b++){var a=this.interactions[b];if(a.uid==d){return a.response}}return null},getUserResponseObject:function(d){for(var b=0;b<this.interactions.length;b++){var a=this.interactions[b];if(a.uid==d){return a}}return null},getObjectiveResponseObject:function(d){for(var b=0;b<this.objectiveQuestionInteractions.length;b++){var a=this.objectiveQuestionInteractions[b];if(a.uid==d){return a}}return null},storeUserResponses:function(){try{var b=JSON.stringify(this.interactions);localStorage[window.location+"/"+this.learnerName+"/interactions"]=b}catch(a){alert(a)}},reportObjectiveResponsesToSCORMAPI:function(){try{if(this.objectiveQuestionInteractions.length<1){return}var b=JSON.stringify(this.objectiveQuestionInteractions);try{var d=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+d+".id","urn:lodestarlearning.com/"+uid);doSetValue("cmi.interactions."+d+".type","long-fill-in");doSetValue("cmi.interactions."+d+".learner_response",b);window.setTimeout(this.executeDoCommit,1000)}catch(a){alert(a)}}catch(a){alert(a)}},reportInteractionsToJetStore:function(){try{if(this.interactions.length<1){return}try{setJetValue("jet_interactions",this.interactions)}catch(a){alert(a)}}catch(a){alert(a)}},getInteractionsFromJetStore:function(a){if(a.interactions.length<1){var b=getJetValue("jet_interactions");if(b!=null&&typeof b!="undefined"&&b!=""){a.interactions=b}}},storeUserResponse:function(d,e,b){var a=this.getUserResponseObject(d);if(a==null){a={uid:"",heading:"",response:""};this.interactions.push(a)}a.uid=d;a.heading=e;a.response=b},storeObjectiveResponse:function(h,e,d,k,f,a){var b=this.getObjectiveResponseObject(h);if(b==null){b={uid:h,questionType:e,question:d,learnerResponse:k,correctResponse:f,result:a};this.objectiveQuestionInteractions.push(b)}},getSessionTime:function(){var e=Date.now()-this.startTime;var h=e/1000;var f=Math.floor(((h%31536000)%86400)/3600);var b=Math.floor((((h%31536000)%86400)%3600)/60);var a=parseInt((((h%31536000)%86400)%3600)%60);var d="PT"+f+"H"+b+"M"+a+"S";return d},executeDoCommit:function(){doCommit()},suspendData:function(){var a=getJetStore();if(console&&console.log){console.log(String(a))}window.setTimeout(this.executeDoCommit,1000);var b=doSetValue("cmi.suspend_data",a);if(console&&console.log){console.log("LMS reports:"+b)}window.setTimeout(this.executeDoCommit,1000);localStorage[window.location+"/"+this.learnerName+"/jetStore"]=a;this.setCompletionStatus("incomplete")},clearData:function(){clearJetStore()},setCompletionStatus:function(a){var b=doSetValue("cmi.completion_status",a);window.setTimeout(this.executeDoCommit,1000);if(a=="completed"){doSetValue("cmi.exit","logout");if(console&&console.log){console.log("cmi.exit is set to logout")}}else{doSetValue("cmi.exit","suspend");if(console&&console.log){console.log("cmi.exit is set to suspend")}}window.setTimeout(this.executeDoCommit,1000)},retrieveData:function(e,b){var h=this;var f=5;var a=localStorage[window.location+"/"+this.learnerName+"/jetStore"];if(console&&console.log){console.log(a)}if(a!=null&&typeof a!="undefined"&&a!=""){setJetStore(a)}var d=doGetValue("cmi.suspend_data");window.setTimeout(function(){if(!$.isNumeric(d)&&!isEmpty(d)&&isObject(d)){setJetStore(d);h.getUserData();if(console&&console.log){console.log("From LMS: "+d)}if(!$.isNumeric(d)&&!isEmpty(d)){if(typeof e!="undefined"&&e!=null&&e!=""){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.JUMP_TO_PAGE,e)}}else{if(typeof b!="undefined"&&b!=null&&b!=""){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.JUMP_TO_PAGE,b)}}}else{h.intervalDATAChecker=setInterval(function(){f--;h.checkIfSuspendDataIsLoaded(h,f,false,e,b)},5000)}},5000)},checkIfSuspendDataIsLoaded:function(h,f,a,e,b){if(!a&&f>1){var d=doGetValue("cmi.suspend_data");if(console&&console.log){console.log("From LMS ("+f+"): "+d)}if(!$.isNumeric(d)&&!isEmpty(d)){setJetStore(d);h.getUserData();clearInterval(h.intervalDATAChecker);if(typeof e!="undefined"&&e!=null&&e!=""){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.JUMP_TO_PAGE,e)}}}else{clearInterval(h.intervalDATAChecker);if(typeof b!="undefined"&&b!=null&&b!=""){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.JUMP_TO_PAGE,b)}}},registerOutcome:function(a){this.outcomes.push(a)},reportOutcomes:function(){var a=this;var d=0;var b=0;$.each(this.report,function(r,k){var n=a.getOutcomeMatchedbyUID(a,r);for(var l=0;l<n.length;l++){var m=n[l];var p=m.outcomeguid;var f=m.shortDesc;var h=a.outcomesReport[p]!=null?parseFloat(a.outcomesReport[p].userTotal):0;var e=a.outcomesReport[p]!=null?parseFloat(a.outcomesReport[p].scoreTotal):0;var o=parseFloat(k.userPoints);o=isNaN(o)?0:o;var s=parseFloat(k.totalPoints);s=isNaN(s)?0:s;b=o+h;d=s+e;var q={userTotal:b,scoreTotal:d,shortDesc:f,guid:p};a.outcomesReport[p]=q}});this.facade.sendNotification(jet.AppConstants.REPORT_OUTCOMES,a.outcomesReport)},getOutcomeMatchedbyUID:function(f,d){var b=[];for(var a=0;a<f.outcomes.length;a++){var e=f.outcomes[a];if(e.uid==d){b.push(e)}}return b}},{NAME:"QuestionProcessorMediator"});puremvc.define({name:"jet.view.mediator.ViewerComponentMediator",parent:puremvc.Mediator},{overlayComponent:null,popupComponent:null,notesComponent:null,transcriptComponent:null,toolTipComponent:null,audioComponent:null,meterComponent:null,isMeter:false,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_OVERLAY,jet.AppConstants.REQUEST_POPUP,jet.AppConstants.REQUEST_NOTES,jet.AppConstants.REQUEST_TRANSCRIPT,jet.AppConstants.REQUEST_CLOSE_POPUP,jet.AppConstants.REQUEST_TOOLTIP,jet.AppConstants.REQUEST_CLOSE_TOOLTIP,jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.REQUEST_OVERLAY:this.showOverlay(a.getBody());break;case jet.AppConstants.REQUEST_POPUP:this.showPopup(a.getBody());break;case jet.AppConstants.REQUEST_NOTES:this.showNotes();break;case jet.AppConstants.REQUEST_TRANSCRIPT:this.showTranscript();break;case jet.AppConstants.REQUEST_CLOSE_POPUP:this.hidePopup();break;case jet.AppConstants.REQUEST_AUDIO:break;case jet.AppConstants.REQUEST_CLOSE_AUDIO:break;case jet.AppConstants.REQUEST_TOOLTIP:this.showTooltip(a.getBody());break;case jet.AppConstants.REQUEST_CLOSE_TOOLTIP:this.hideTooltip();break;case jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY:this.transcriptComponent.recordActivity(a.getBody());break}},onRegister:function(){this.setViewComponent(new jet.view.component.ViewerComponent);this.setOverlayComponent(new jet.view.component.OverlayComponent(this));this.setPopupComponent(new jet.view.component.PopupComponent(this));this.setNotesComponent(new jet.view.component.NotesComponent(this));this.setTranscriptComponent(new jet.view.component.TranscriptComponent(this));this.settoolTipComponent(new jet.view.component.TooltipComponent(this))},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},setOverlayComponent:function(a){this.overlayComponent=a},showOverlayx:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.overlayComponent.attachNode(a.node);this.overlayComponent.show(true)},showOverlay:function(d){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);var f=d;if(d&&f.node.getHTMLContent){var b=f.node.getContentAsResource();switch(b){case"CLONE":break;case"REPARENT":var e=f.node.getReParentedContent();var a=$(e.getContentDiv());var h=$(a).css("padding-bottom");$(a).css("padding-bottom",0);$originalParent=a.parent().first();this.overlayComponent.reparentNode(a,$originalParent);e.show(true);break;default:this.overlayComponent.sendWarning()}}else{this.overlayComponent.sendWarning()}this.overlayComponent.show(true)},hideOverlay:function(){this.overlayComponent.show(false)},setPopupComponent:function(a){this.popupComponent=a},setNotesComponent:function(a){this.notesComponent=a},setTranscriptComponent:function(a){this.transcriptComponent=a},showPopup:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.popupComponent.setContent(a);this.popupComponent.show(true)},hidePopup:function(a){this.popupComponent.show(false)},showNotes:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.notesComponent.setHeight("70%");this.notesComponent.show(true)},showTranscript:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.transcriptComponent.setHeight("70%");this.transcriptComponent.show(true)},settoolTipComponent:function(a){this.toolTipComponent=a},showTooltip:function(a){this.toolTipComponent.setContent(a.htmlString);this.toolTipComponent.setX(a.xpos);this.toolTipComponent.setY(a.ypos);this.toolTipComponent.show(true)},hideTooltip:function(){this.toolTipComponent.show(false)},requestResumeNavigation:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null)}},{NAME:"ViewerComponentMediator"});puremvc.define({name:"jet.view.mediator.WidgetMediator",parent:puremvc.Mediator},{pageMap:{},registeredWidgets:[],listNotificationInterests:function(){return[]},handleNotification:function(a){switch(a.getName()){}},onRegister:function(){this.registeredWidgets.push(new jet.view.widget.QuestionWidget());this.registeredWidgets.push(new jet.view.widget.ShortAnswerWidget());this.registeredWidgets.push(new jet.view.widget.ImageSliderWidget());this.registeredWidgets.push(new jet.view.widget.DnDWidget());this.registeredWidgets.push(new jet.view.widget.PwgImageSliderWidget());this.registeredWidgets.push(new jet.view.widget.TimelineWidget());this.registeredWidgets.push(new jet.view.widget.WordProblemWidget());this.registeredWidgets.push(new jet.view.widget.EmbeddedVariableWidget());this.registeredWidgets.push(new jet.view.widget.GeolocationWidget());this.registeredWidgets.push(new jet.view.widget.ImageLayoutWidget());this.registeredWidgets.push(new jet.view.widget.TimerWidget());this.registeredWidgets.push(new jet.view.widget.TextLayoutWidget());this.registeredWidgets.push(new jet.view.widget.InputWidget());this.registeredWidgets.push(new jet.view.widget.MatchingWidget());this.registeredWidgets.push(new jet.view.widget.VideoWidget())},onRemove:function(){},findWidgets:function(l,f){var k=$(f).find("div");for(var e=0;e<k.size();e++){var d=k[e];for(var b=0;b<this.registeredWidgets.length;b++){var h=this.registeredWidgets[b];var a=h.getWidgetClassName();if($(d).hasClass(a)){h.processDiv(d,l);console.log(a+" processed")}}}},enableInteractivity:function(d){for(var a=0;a<this.registeredWidgets.length;a++){var b=this.registeredWidgets[a];b.enableInteractivity(d)}},processBasicComponent:function(l,s,m){var o=new jet.view.component.OpenQuestionComponent;l.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(o,m);var p=this.getBackgroundImage(s);if(p!=null&&typeof p!="undefined"){var e=l.getContentDiv();var f="url('./"+p+"')";$(e).css("background-image",f);$(e).css("background-size","cover");$(e).css("background-repeat","no-repeat");$(e).css("background-attachment","scroll")}var q=this.getBackgroundColor(s);if(q!=null&&typeof q!="undefined"){var e=l.getDiv();var f=q;var d=this.convertToRGBA(q,f);$(e).css("background-color",d);var a=this.hexToR(f);var k=this.hexToG(f);var n=this.hexToB(f)}var h=this.stripBodyTags(s);o.setParent(l.contentDiv);o.setText(h);return o},convertToRGBA:function(k,l){if(k.length==9){var h=this.hexToR(k);var f=this.hexToG(k);var d=this.hexToB(k);var e=this.hexToA(k);e=e/255;e=Math.floor(e*100)/100;return"rgba("+h+","+f+","+d+","+e+")"}else{return l}},getBackgroundImage:function(e){var b=/.*<body.*background-image:(.*?jpg|.*?png).*>/i;var a=b.exec(e);if(a==null||a.length<2){return null}var d=a[1];return d},getBackgroundColor:function(e){var b=/.*<body.*background-color:(.*?);.*>/i;var a=b.exec(e);if(a==null||a.length<2){return null}var d=a[1];return d},stripBodyTags:function(e){var d=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=d.exec(e);if(b==null){return e}var a=b[2];if(a.trim()==""){a=this.parseText(e)}if(a.trim()!=""&&a!=null&&typeof a!="undefined"){return a}return e},parseText:function(f){var a="";var e=f.indexOf("<body");if(e<0){return a}var b=f.indexOf(">",e);if(b<0){return a}b+=2;var d=f.indexOf("</body>",b);if(d<0){return a}a=f.substring(b,d);return a.trim()},hexToR:function(a){return parseInt((this.cutHex(a)).substring(0,2),16)},hexToG:function(a){return parseInt((this.cutHex(a)).substring(2,4),16)},hexToB:function(a){return parseInt((this.cutHex(a)).substring(4,6),16)},hexToA:function(a){return parseInt((this.cutHexA(a)).substring(6,8),16)},cutHex:function(a){return(a.charAt(0)=="#")?a.substring(1,7):a},cutHexA:function(a){return(a.charAt(0)=="#")?a.substring(1,9):a}},{NAME:"WidgetMediator"});puremvc.define({name:"jet.view.mediator.YouTubeMediator",parent:puremvc.Mediator},{players:null,videoIndex:0,listNotificationInterests:function(){return[jet.AppConstants.PAUSE_VIDEO,]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.PAUSE_VIDEO:this.pauseVideo(a.getBody());break}},onRegister:function(){this.players=[]},onRemove:function(){},addPlayer:function(b,d){if(typeof(YT)!="undefined"){var a=new YT.Player(b,{wmode:"transparent"});this.players.push(a)}},isYTAvailable:function(){if(typeof(YT)!="undefined"){return true}return false},getVideoIndex:function(){this.videoIndex++;return this.videoIndex},pauseVideo:function(a){$("video").each(function(){$(this).get(0).pause()});if(typeof(YT)!="undefined"){for(var b=0;b<this.players.length;b++){if(typeof this.players[b].pauseVideo==="function"){this.players[b].pauseVideo()}}}},cueYTVideoById:function(b,d,e,f,a){b.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1&start="+f+"&end="+a+"&autoplay=1";$(b).css("width","98%");$(b).css("height","98%")},cueVideoById:function(b,d,e,f,a){e=e+"#t="+f+","+a;$(b).attr("src",e);b.play()},normalizeURL:function(b){if(b.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var a=b.replace(/.*?v=/,"");return a}return""},printMethods:function(d){var b=[];for(var a in d){if(typeof d[a]=="function"){b.push(a)}}alert(b.join(","))}},{NAME:"YouTubeMediator"});puremvc.define({name:"jet.model.proxy.JFXMLProxy",parent:puremvc.Proxy},{layerIndex:11,mediator:null,getUID:function(a){},parseData:function(e,h,b,f){this.layerIndex=11;var a=this;this.mediator=e;var d=$(b).children();if(d==null){return}$(b).find(jet.AppConstants.PAGE).each(function(){a.parseObjectList(a,this,h,f)});e.postProcessGraphics(h)},parseObjectList:function(b,a,f,e){if($(a).children()==null){return}var d=$(a).children();$(d).each(function(){switch(this.nodeName){case jet.AppConstants.JFGROUP:b.parseGroup(b,this,f,e);break;case jet.AppConstants.OBJECTLIST:b.parseObjectList(b,this,f,e);break;case jet.AppConstants.LAYER:b.parseLayer(b,this,f,e);break;case jet.AppConstants.RECTANGLE:b.parseRectangle(b,this,f,e);break;case jet.AppConstants.LINE:b.parseLine(b,this,f,e);break;case jet.AppConstants.POLYGON:b.parsePolygon(b,this,f,e);break;case jet.AppConstants.ELLIPSE:b.parseEllipse(b,this,f,e);break;case jet.AppConstants.JFIMAGE:b.parseImage(b,this,f,e);break;case jet.AppConstants.JFTEXT:b.parseText(b,this,f,e);break;case jet.AppConstants.REGULAR_LINE:b.parseRegularLine(b,this,f,e);break;case jet.AppConstants.LABEL_LINE:b.parseLabelLine(b,this,f,e);break;case jet.AppConstants.ROUNDED_RECTANGLE:b.parseRoundedRectangle(b,this,f,e);break;case jet.AppConstants.DIAMOND:b.parseDiamond(b,this,f,e);break;case jet.AppConstants.PARALLELOGRAM:b.parseParallelogram(b,this,f,e);break;case jet.AppConstants.TRAPEZOID:b.parseTrapezoid(b,this,f,e);break;case jet.AppConstants.ISOSCELESRECTANGLE:b.parseIsoscelesRectangle(b,this,f,e);break;case jet.AppConstants.ARC:b.parseArc(b,this,f,e);break;case jet.AppConstants.CHORD:b.parseChord(b,this,f,e);break;case jet.AppConstants.PIE:b.parsePie(b,this,f,e);break}})},parseLayer:function(b,a,e,d){this.layerIndex--;if(this.getLayerVisibility(a)){b.parseObjectList(b,a,e,d)}},parseRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.RECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseGroup:function(d,b,h,f){var e={};e.ID=jet.AppConstants.JFGROUP;e.GroupID=d.getObjectId(b);e.Points=d.getBoundingPoints(b);e.ObjectId=f;d.getGStyle(d,b,e);this.mediator.post(e,h);var a=$(b).children("ObjectList");this.parseObjectList(d,a,h,e.GroupID)},parseRoundedRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ROUNDED_RECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseText:function(b,a,f,e){var d={};d.ID=jet.AppConstants.JFTEXT;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getTextData(a,d);b.getGStyle(b,a,d);b.getFontFormat(a,d);this.mediator.post(d,f)},parseImage:function(b,a,f,e){var d={};d.ID=jet.AppConstants.JFIMAGE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getImageData(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseEllipse:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ELLIPSE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseArc:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ARC;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parseChord:function(b,a,f,e){var d={};d.ID=jet.AppConstants.CHORD;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parsePie:function(b,a,f,e){var d={};d.ID=jet.AppConstants.PIE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parseLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.LINE;d.Points=b.getPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseRegularLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.REGULAR_LINE;d.Points=b.getRegularPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseLabelLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.LABEL_LINE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parsePolygon:function(b,a,f,e){var d={};d.ID=jet.AppConstants.POLYGON;d.Points=b.getPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},getLayerVisibility:function(a){var b=1;if($(a).children("Visible")!=null){b=$(a).children("Visible:first").text()}return b=="1"?true:false},getPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("PolyNode").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},parseParallelogram:function(b,a,f,e){var d={};d.ID=jet.AppConstants.PARALLELOGRAM;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseTrapezoid:function(b,a,f,e){var d={};d.ID=jet.AppConstants.TRAPEZOID;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseIsoscelesRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ISOSCELESRECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseDiamond:function(b,a,f,e){var d={};d.ID=jet.AppConstants.DIAMOND;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},getRegularPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("RegularNode").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},getObjectId:function(b){var a=null;if($(b).children("objectId")!=null){a=$(b).children("objectId:first").text()}return a},getBoundingPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("Node").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},getAnchorPoints:function(b,d){var a=[];if($(b).children("leftTopX:first")!=null){d.leftTopX=$(b).children("leftTopX:first").text()}if($(b).children("leftTopY:first")!=null){d.leftTopY=$(b).children("leftTopY:first").text()}if($(b).children("rightTopX:first")!=null){d.rightTopX=$(b).children("rightTopX:first").text()}if($(b).children("rightTopY:first")!=null){d.rightTopY=$(b).children("rightTopY:first").text()}if($(b).children("leftBottomX:first")!=null){d.leftBottomX=$(b).children("leftBottomX:first").text()}if($(b).children("leftBottomY:first")!=null){d.leftBottomY=$(b).children("leftBottomY:first").text()}if($(b).children("rightBottomX:first")!=null){d.rightBottomX=$(b).children("rightBottomX:first").text()}if($(b).children("rightBottomY:first")!=null){d.rightBottomY=$(b).children("rightBottomY:first").text()}this.normalizeAnchorPoints(d)},normalizeAnchorPoints:function(a){var n=parseInt(a.leftTopX);var h=parseInt(a.rightTopX);if(h<n){var m=n;n=h;h=m;a.leftTopX=n;a.rightTopX=h}var d=parseInt(a.leftBottomX);var k=parseInt(a.rightBottomX);if(k<d){var m=d;d=k;k=m;a.leftBottomX=d;a.rightBottomX=k}var l=parseInt(a.leftTopY);var b=parseInt(a.leftBottomY);if(b<l){var m=l;l=b;b=m;a.leftTopY=l;a.leftBottomY=b}var e=parseInt(a.rightTopY);var f=parseInt(a.rightBottomY);if(f<e){var m=e;e=f;f=m;a.rightTopY=e;a.rightBottomY=f}},getGStyle:function(b,a,d){b.getLineFormat(a,d);b.getFillFormat(a,d);b.getSettings(a,d);b.getPropertyList(a,d);b.getArrowFormat(a,d)},getLineFormat:function(a,d){var b=$(a).children("LineFormat");if(b!=null){d.LineWidth=b.children("lineWidth:first").text();d.LineColor=b.children("lineColor:first").text()}},getArrowFormat:function(a,d){var b=$(a).children("Arrow");if(b!=null){d.StartArrowType=b.children("startArrowType:first").text();d.EndArrowType=b.children("endArrowType:first").text()}},getFillFormat:function(a,b){var d=$(a).children("FillFormat");if(d!=null){b.FillStyle=d.children("fillStyle:first").text();b.FillColor=d.children("fillColor").text();b.FillColor2=d.children("fillColor2:first").text()}},getFontFormat:function(b,d){var a=$(b).children("FontFormat");if(a!=null){d.FontSize=a.children("fontSize:first").text();d.FontStyle=a.children("fontStyle:first").text();d.FontColor=a.children("fontColor:first").text()}},getImageData:function(a,d){var b=$(a).children("imageData");if(b!=null){d.imageData=b.text()}},getTextData:function(b,d){var a=$(b).children("Label");if(a!=null){d.text=a.children("text:first").text()}},getPropertyListx:function(d,f){var e;var a;var h;var b;e=$(d).children("PropertyList:first");if(e!=null){a=e.children("Property:first")}if(a!=null){h=a.children("value:first");b=a.children("comment:first");f.event=h.text();f.action=b.text()}},getPropertyList:function(d,f){var e;var a;var h;var b;e=$(d).children("PropertyList:first");if(e!=null){propertyElements=e.children("Property");propertyElements.each(function(){var m=$(this).children("value:first");var k=$(this).children("comment:first");var l=$(m).text();switch(l){case jet.AppConstants.CLICK:f.event=l;f.action=k.text();break;case jet.AppConstants.JUMP_TO_PAGE:f.event=l;f.action=k.text();break;case jet.AppConstants.OPEN_URL:f.event=l;f.action=k.text();break;case jet.AppConstants.ADD_OVERLAY:f.event=l;f.action=k.text();break;case jet.AppConstants.SHOW_NODE:f.event=l;f.action=k.text();break;case jet.AppConstants.MOUSE_OVER:f.mouseoverevent=l;f.mouseoveraction=k.text();break;case jet.AppConstants.SET_VALUE:f.setvalueevent=l;f.setvalueaction=k.text();break;case jet.AppConstants.APPEND_VALUE:f.setvalueevent=l;f.setvalueaction=k.text();break}})}},getSettings:function(a,b){b.Transparency=$(a).children("transparency:first").text();b.Invisible=$(a).children("invisible:first").text();b.DisableMotion=$(a).children("disableMotion:first").text();b.DisableModifyingProperties=$(a).children("disableModifyingProperties:first").text();b.LayerIndex=this.layerIndex}},{NAME:"JFXMLProxy"});puremvc.define({name:"jet.model.proxy.LXMLProxy",parent:puremvc.Proxy},{getUID:function(a){var b=$(a).attr("node");return b},getPageType:function(e,d){var f;var h=e.findComboBoxElement(d);f=$(h).text();var a=e.getTypeIndex(h,f);var b=$(h).attr("pageTypes");if(b==undefined||b==null){return"none"}return b.split(";")[a]},getPageTypeIndex:function(d,a){var b;$(d).find("input").each(function(){if(b!=null){return}var h=$(this).attr(a);if(h=="JetOptionComboBox"||h=="JetCustomOptionComboBox"){value=$(this).text();var f=$(this).attr("values");var e=f.split(";");for(b=0;b<e.length;b++){if(e[b]==value){return b}}return -1}});return b},findComboBoxElement:function(a){var b=null;$(a).find("input").each(function(){if(b!=null){return}var d=$(this).attr("type");if(d=="JetOptionComboBox"||d=="JetCustomOptionComboBox"){b=this}});return b},getTypeIndex:function(f,d){var e;var b=$(f).attr("values");if(b==undefined){return}var a=b.split(";");for(e=0;e<a.length;e++){if(a[e]==d){return e}}return e},parseSettings:function(b,a){var d={};if(b==null||b==undefined){return d}$(b).find("input").each(function(){var e=$(this).attr("name");var f=$(this).text();d[e]=f});return d},parseInteractionElement:function(b,a){var d="";if(b==null||b==undefined){return d}d=$(b).attr("projectName");return d},parseOptionStore:function(e,d,a){var b=[];$(e).find("option").each(function(){var f=$(this).attr("type");if(f=="-1"){$(this).find("rule").each(function(){var l=$(this).attr("type");var m=$(this).attr("value");var k={};k[l]=m;b.push(k)})}if(f==d){var h=a;$(this).find("rule").each(function(){var m=$(this).attr("type");var n=$(this).attr("value");var k={};k[m]=n;var l=h.getProperty(b,m);if(l!=null){l[m]=n}else{b.push(k)}})}});return b},getProperties:function(e,h,a){var b=$(e).parents("interaction");var l=$(e).parents("optionPage");var k=$(b).find('optionStore[name="'+h+'"]');var d=a.getPageTypeIndex(l,"type");var f=a.parseOptionStore(k,d,a);return f},parseComponentLevelBranchData:function(b){var a=null;if($(b).siblings("checkedOption")!=null&&$(b).siblings("checkedOption").length>0){a=new Object();a.checkedOption=$(b).siblings("checkedOption").text();a.checkedValue=$(b).siblings("checkedValue").text();a.showFeedback=$(b).siblings("showFeedback").text();a.feedback=$(b).siblings("feedback").text();a.branchOptions=$(b).siblings("branchOptions").text();a.branchDelay=$(b).siblings("branchDelay").text()}return a},parseImageData:function(a){var b=null;if($(a).attr("imageHeight")!=null){b=new Object();b.imageHeight=$(a).attr("imageHeight");b.imageWidth=$(a).attr("imageWidth")}return b},parseAudioData:function(a){var b=null;if($(a).attr("enableAutoPlay")!=null){b=new Object();b.enableAutoPlay=$(a).attr("enableAutoPlay");b.enableController=$(a).attr("enableController");b.volume=$(a).attr("volume");b.fallback=$(a).attr("fallback")}return b},parseCaptionData:function(b){var a=null;if($(b).siblings("imageCaption")!=null){a=new Object();a.imageCaption=$(b).siblings("imageCaption").text();a.imageSource=$(b).siblings("imageSource").text();if(!isEmpty($(b).siblings("imageID"))){a.imageID=$(b).siblings("imageID").text()}if(!isEmpty($(b).siblings("imageDecorator"))){a.imageDecorator=$(b).siblings("imageDecorator").text()}a.mediaController=$(b).siblings("mediaController").text();a.showMiniNav=$(b).siblings("showMiniNav").text();a.enableMiniNav=$(b).siblings("enableMiniNav").text()}return a},parseData:function(e,f){getProperties=this.getProperties;getProperty=this.getProperty;var a=this.parseComponentLevelBranchData;var p=this.parsePageLevelBranchData;var o=this.parseCaptionData;var h=this.parseAudioData;var d=this.parseImageData;var k=null;var n=null;var b=null;var m=this;var l=null;$(e).find("input").each(function(){var s=$(this).attr("type");var r=$(this).attr("optionStore");k=getProperties(this,r,m);n=getProperty(k,"visibility");b=getProperty(k,"player_visibility");if((b!=null&&b.player_visibility=="0")||(b==null&&(n==null||n.visibility=="0"))){return}var u=a(this);switch(s){case"JetOptionHTMLEditor":f.buildComponent(f,jet.AppConstants.TEXT,k,$(this).text(),u);break;case"JetOptionAdvancedHTMLEditor":f.buildComponent(f,jet.AppConstants.TEXT,k,$(this).text(),u);break;case"JetOptionTextArea":f.buildComponent(f,jet.AppConstants.TEXT,k,$(this).text(),u);break;case"JetOptionCheckBox":f.buildComponent(f,jet.AppConstants.CHECKBOX,k,$(this).text(),u);break;case"JetOptionImageArea":var t=d(this);var q=o(this);f.buildComponent(f,jet.AppConstants.IMAGE,k,$(this).text(),q,t);break;case"JetOptionVideoArea":f.buildComponent(f,jet.AppConstants.VIDEO,k,$(this).text(),q,t);break;case"JetOptionResourceImportButton":f.buildComponent(f,jet.AppConstants.RESOURCE,k,$(this).text(),q,t);break;case"JetOptionAudio":var w=h(this);f.buildComponent(f,jet.AppConstants.AUDIO,k,$(this).text(),w);break;case"JetOptionNodesManagerButton":var v=u;f.buildComponent(f,jet.AppConstants.NODES_MANAGER,k,$(this).text(),v);break;case"JetOptionCrossword":f.buildComponent(f,jet.AppConstants.CROSSWORD,k,$(this).text(),u);break;case"JetOptionDataInput":f.buildComponent(f,jet.AppConstants.DATA_INPUT,k,$(this).text(),u);break;case"JetComboBox":f.buildComponent(f,jet.AppConstants.COMBO_BOX,k,$(this).text(),u);break;case"JetOptionAccessibilitySelector":f.buildComponent(f,jet.AppConstants.ACCESSIBILITY_TEXT,k,$(this).text(),u);break}});f.processComponents()},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e}},{NAME:"LXMLProxy"});puremvc.define({name:"jet.view.navigation.HeaderComponent",constructor:function(a){this.mediator=a;this.headerDiv=document.createElement("div");this.headerDiv.className="header";getJetWrapper().append(this.headerDiv);this.adaButton=document.createElement("a");this.adaButton.className="ada";$(this.adaButton).attr("tabindex","0");$(this.adaButton).attr("Title","Accessible Version");$(this.adaButton).hide();$(this.headerDiv).append(this.adaButton);$(this.adaButton).html("<a href='sec508.htm'><img width='30' height='30' alt='Click here for Accessible Version' src='lib/css/accessibility.png' /></a>");$(this.adaButton).hover(function(){$(this.adaButton).tooltip()});this.accessibilityButton=document.createElement("a");this.accessibilityButton.className="ada";$(this.accessibilityButton).attr("tabindex","0");$(this.accessibilityButton).attr("Title","Accessible Version for Current Page");$(this.accessibilityButton).hide();$(this.headerDiv).append(this.accessibilityButton);$(this.accessibilityButton).html("<img width='30' height='30' src='lib/css/accessibilityPage.png' />");$(this.accessibilityButton).click(function(){$(this.accessibilityButton).tooltip()});$(this.accessibilityButton).click(function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_ALTERNATIVE_CONTENT)});this.printButton=document.createElement("a");this.printButton.className="ada";$(this.printButton).attr("tabindex",0);$(this.printButton).attr("Title","Print");$(this.printButton).hide();$(this.printButton).html("<a href='print.htm'><img width='30' height='30' src='lib/css/print.png' /></a>");$(this.printButton).hover(function(){$(this.printButton).tooltip()});this.notesButton=document.createElement("a");this.notesButton.className="ada";$(this.notesButton).attr("tabindex",0);$(this.notesButton).attr("Title","Personal Notes");$(this.notesButton).css("cursor","pointer");$(this.notesButton).hide();$(this.notesButton).click(function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NOTES)});$(this.notesButton).hover(function(){$(this.notesButton).tooltip()});$(this.headerDiv).append(this.notesButton);$(this.notesButton).html("<img width='30' height='30' src='lib/css/notes.png' />");this.transcriptButton=document.createElement("a");this.transcriptButton.className="ada";$(this.transcriptButton).attr("tabindex",0);$(this.transcriptButton).attr("Title","Transcript");$(this.transcriptButton).css("cursor","pointer");$(this.transcriptButton).hide();$(this.transcriptButton).click(function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_TRANSCRIPT)});$(this.transcriptButton).hover(function(){$(this.transcriptButton).tooltip()});$(this.headerDiv).append(this.transcriptButton);$(this.transcriptButton).html("<img width='30' height='30' src='lib/css/transcript.png' />");this.ePubButton=document.createElement("a");this.ePubButton.className="ePub";$(this.ePubButton).attr("tabindex",0);$(this.ePubButton).hide();$(this.headerDiv).append(this.ePubButton);this.mapButton=document.createElement("button");this.mapButton.className="mapButton";$(this.mapButton).attr("tabindex",0);$(this.mapButton).text("Show Map");$(this.mapButton).hide();$(this.headerDiv).append(this.mapButton);this.showLocationButton=document.createElement("button");this.showLocationButton.className="showLocationButton";$(this.showLocationButton).text("My Location");$(this.showLocationButton).hide();$(this.headerDiv).append(this.showLocationButton);this.bannerText=document.createElement("div");this.bannerText.className="bannerText";$(this.bannerText).addClass("banner");$(this.bannerText).attr("tabindex",0);$(this.bannerText).text("");$(this.bannerText).hide();getJetWrapper().append(this.bannerText);this.addControls()}},{headerDiv:null,selectDiv:null,adaButton:null,mapButton:null,notesButton:null,transcriptButton:null,showLocationButton:null,printButton:null,accessibilityButton:null,ePubButton:null,menuButton:null,bannerText:null,isMenuOpen:false,handleEvent:function(a){},addControls:function(){var a=this.mediator},getContrastYIQ:function(h){h=h.substring(1);var e=parseInt(h.substr(0,2),16);var d=parseInt(h.substr(2,2),16);var a=parseInt(h.substr(4,2),16);var f=((e*299)+(d*587)+(a*114))/1000;return(f>=128)?"black":"white"},getContrastYIQ_withAlpha:function(n){n=n.substring(1);var f=1;if(n.length==8){var e=parseInt(n.substr(6,2),16);f=1-e/255}var l=parseInt(n.substr(0,2),16)*(1+f);var k=parseInt(n.substr(2,2),16)*(1+f);var d=parseInt(n.substr(4,2),16)*(1+f);var m=((l*299)+(k*587)+(d*114))/1000;var h=(m>=128)?"black":"white";return h},calculateColor:function(f,m,l){if(m.length==7){return f.getContrastYIQ_withAlpha(m)}if(m.length==9){colorValue=m.substring(1);var k=parseInt(colorValue.substr(0,2),16);var h=parseInt(colorValue.substr(2,2),16);var d=parseInt(colorValue.substr(4,2),16);var e=parseInt(colorValue.substr(6,2),16);if(e<1&&!l){return m.substr(0,7)}if(e<255&&l){return"black"}else{return f.getContrastYIQ_withAlpha(m)}}return("black")},getProjectName:function(){var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).getProjectName();return a},handleProjectName:function(){$(this.ePubButton).html("<a href='"+this.getProjectName()+".epub'><img width='30' height='30' src='lib/css/epub.png' /></a>")},getOuterBackgroundColor:function(a,d){if(d===undefined){d=false}var b=this;$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(e){$(e).find("outerBgColor").each(function(){var f=$(this).text();$(a).css("color",b.calculateColor(b,f,d))})},error:function(){}})},getHeaderFileName:function(a){$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(b){$(b).find("headerFileName").each(function(){var d=$(this).text();$(a).css("background-size","cover");$(a).css("background-image","url(./base/"+d+")")})},error:function(){}})},getOuterBackgroundColorxx:function(a){var b=this;$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(d){$(d).find("outerBgColor").each(function(){var e=$(this).text();$(a).css("color",b.getContrastYIQ(e))})},error:function(){}})},addDivIfSupported:function(a,d){var b=this;$.ajax({type:"GET",url:"./layout/default.xml",dataType:"xml",success:function(e){$(e).find("supportsTabs").each(function(){var f=$(this).text();$(a).prependTo(f);b.addNav3Tabs(d)})},error:function(){return false}})},updateMenu:function(a){$("nav#menu ul li").removeClass("mm-selected");$("nav#menu ul li a").filter("[href='"+a+"']").parent().addClass("mm-selected");$("nav#menu a").filter("[href='"+a+"']").parent().addClass("mm-selected")},addMenu_1:function(l){if(l.length<1){return}var a=document.createElement("nav");$(a).addClass("mm-menu mm-horizontal");$(a).attr("id","menu");getJetWrapper().append(a);var b=this.mediator;var r;r="<a style='cursor: pointer;z-index:10;color:black;position:absolute;left:150px;top:0px' id='navMenuButton'>&#9664;</a><ul>";for(var f=0;f<l.length;f++){var n=l[f].parentUid;var o="";try{if(n!=""){o=n.match(/.*\(ID:(.*)\)/)[1].trim()}}catch(q){}if(o==""||o==undefined||o==l[f].uid){var p="<li><a href = '"+l[f].uid+"'>"+l[f].title+"</a></li>";r+=p}}r+="</ul>";$("nav#menu").html(r);var d=false;while(!d){d=true;for(var e=0;e<l.length;e++){var m=l[e].uid;var k=$('nav#menu a[href="'+m+'"]')[0];if(k!=undefined){continue}var n=l[e].parentUid;var o="";try{if(n!=""){o=n.match(/.*\(ID:(.*)\)/)[1].trim()}var h=$('nav#menu a[href="'+o+'"]')[0]}catch(q){}if(h!=null&&h!=undefined){d=false;var p="<li class='subtopic'><a href = '"+l[e].uid+"'>"+l[e].title+"</a></li>";$(h).parent().append(p)}}}this.getOuterBackgroundColor("nav#menu ul");this.getOuterBackgroundColor("nav#menu ul li.subtopic a");this.getOuterBackgroundColor("#navMenuButton");this.addMenuButton();$("nav#menu ul").click(function(v){v.preventDefault();var s=v.target.href;var t=s.lastIndexOf("/")>0?s.lastIndexOf("/")+1:0;s=s.substring(t);var u=s.match(/\d+/);b.requestNode(u)});$("nav#menu").mmenu({classes:"mm-slide",close:true,preventDefault:true,blockUI:true,offCanvas:false});$("nav#menu").hide()},addMenu_3:function(n){var u=$(".mainWrapper");$(u).css("display","flex");var d=getJetWrapper();$(u).append(d);if(n.length<1){return}var a=document.createElement("nav");$(a).addClass("mm-menu mm-horizontal");$(a).attr("id","menu");$(a).addClass("splitpanelmenu");$(a).css("border","none");$(a).css("margin-right","10px");$(u).append(a);var b=this.mediator;var t;t="<a style='cursor: pointer;z-index:10;color:black;left:20px;top:0px' id='navMenuButton'>&#9664;</a><ul>";for(var k=0;k<n.length;k++){var p=n[k].parentUid;var q="";try{if(p!=""){q=p.match(/.*\(ID:(.*)\)/)[1].trim()}}catch(s){}if(q==""||q==undefined||q==n[k].uid){var r="<li><a href = '"+n[k].uid+"'>"+n[k].title+"</a></li>";t+=r}}t+="</ul>";$("nav#menu").html(t);var e=false;while(!e){e=true;for(var f=0;f<n.length;f++){var o=n[f].uid;var m=$('nav#menu a[href="'+o+'"]')[0];if(m!=undefined){continue}var p=n[f].parentUid;var q="";try{if(p!=""){q=p.match(/.*\(ID:(.*)\)/)[1].trim()}var l=$('nav#menu a[href="'+q+'"]')[0]}catch(s){}if(l!=null&&l!=undefined){e=false;var r="<li class='subtopic'><a href = '"+n[f].uid+"'>"+n[f].title+"</a></li>";$(l).parent().append(r)}}}this.getOuterBackgroundColor("nav#menu ul");this.getOuterBackgroundColor("nav#menu ul li.subtopic a");this.getOuterBackgroundColor("#navMenuButton");this.addMenuButton();var h=$(window).width();if(h>950&&n.length>0){}$("nav#menu ul").click(function(y){y.preventDefault();var v=y.target.href;var w=v.lastIndexOf("/")>0?v.lastIndexOf("/")+1:0;v=v.substring(w);var x=v.match(/\d+/);b.requestNode(x)});$("nav#menu").mmenu({classes:"mm-slide",close:true,preventDefault:true,blockUI:true,offCanvas:false});$("nav#menu").hide()},addMenuButton:function(){this.menuButton=document.createElement("a");this.menuButton.className="ada";$(this.menuButton).attr("Title","Table of Contents");$(this.headerDiv).append(this.menuButton);$(this.menuButton).html("<a style='cursor: pointer;'><img width='30' height='30' src='lib/css/menu.png'/></a>");this.isMenuOpen=false;var a=this;$(this.menuButton).click(function(){a.menuButtonClickHandler(a)});$("#navMenuButton").click(function(){a.menuButtonClickHandler(a)});$(this.menuButton).hover(function(){$(this.menuButton).tooltip()})},menuButtonClickHandler:function(a){var b="1%";$("nav").animate({left:b},250,function(){if(a.isMenuOpen){$("nav#menu,nav#nav_2").fadeIn();$(a.menuButton).find("img").attr("src","lib/css/menuX.png")}else{$("nav#menu,nav#nav_2").fadeOut();$(a.menuButton).find("img").attr("src","lib/css/menu.png")}});a.isMenuOpen=!a.isMenuOpen},showTOC:function(b){var a=this;if(b==true){a.isMenuOpen=false;a.menuButtonClickHandler(a)}else{a.isMenuOpen=true;a.menuButtonClickHandler(a)}},addTOC:function(d){if(d.length<1){return}var e=this.mediator;var f;f="<select>";for(var b=0;b<d.length;b++){var a="<option value = '"+d[b].uid+"'>"+d[b].title+"</option>";f+=a}f+="</select>";this.selectDiv=document.createElement("selection");this.selectDiv.className="TOC";$(this.selectDiv).html(f);$(this.selectDiv).change(function(){var h=$(this).find(":selected").val();e.requestNode(h)});$(this.headerDiv).append(this.selectDiv)},addMenu_2:function(l){if(l.length<1){return}var a=document.createElement("nav");$(a).addClass("mm-menu mm-horizontal");$(a).attr("id","nav_2");getJetWrapper().append(a);var b=this.mediator;var r="<a style='cursor: pointer;z-index:10;color:black;position:absolute;left:130px;top:0px' id='navMenuButton'>&#9664;</a>";r+="<ul id='menu_2'>";for(var f=0;f<l.length;f++){var q="<li><a href = '"+l[f].uid+"'>"+l[f].title+"</a></li>";r+=q}r+="</ul>";$("nav#nav_2").html(r);var d=false;while(!d){d=true;for(var e=0;e<l.length;e++){var n=l[e].uid;var k=$('nav#nav_2 a[href="'+n+'"]')[0];if(k!=undefined){continue}var m=l[e].parentUid;var o="";try{if(m!=""){o=m.match(/.*\(ID:(.*)\)/)[1].trim()}var h=$('nav#nav_2 a[href="'+o+'"]')[0]}catch(p){}if(h!=null&&h!=undefined){d=false;var q="<li class='subtopic'><a href = '"+l[e].uid+"'>"+l[e].title+"</a></li>";$(h).parent().append(q)}}}this.getOuterBackgroundColor("#nav_2 ul li a");this.getOuterBackgroundColor("#navMenuButton");this.addMenuButton();$("nav#nav_2").hide();$("ul#menu_2 li a").click(function(v){v.preventDefault();var s=v.target.href;var t=s.lastIndexOf("/")>0?s.lastIndexOf("/")+1:0;s=s.substring(t);var u=s.match(/\d+/);b.requestNode(u)});$("nav#nav_2").mmenu({classes:"mm-slide",close:true,preventDefault:true,blockUI:true,offCanvas:false})},addNav3Tabs:function(d){var e=this.mediator;htmlString="<ul>";for(var b=0;b<d.length;b++){var a="<li><a href = '"+d[b].uid+"'>"+d[b].title+"</a></li>";htmlString+=a}htmlString+="</ul>";$("#nav_3").html(htmlString);this.getOuterBackgroundColor("#nav_3 ul li a");$("#nav_3").tabs({active:false,collapsible:false,select:function(l,m){var f=l.currentTarget.href;var h=f.lastIndexOf("/")>0?f.lastIndexOf("/")+1:0;f=f.substring(h);var k=f.match(/\d+/);e.requestNode(k)}});$(".ui-widget-header").css("background-color","transparent");$(".ui-widget-header").css("border","none");$("#nav_3").css("width","100%")},addResourceTabs_1:function(d){$("#tabs").remove();if(d.length<1){return}var h=document.createElement("div");$(h).attr("id","tabs");$(h).css("max-width","98%");$(h).css("height","auto");getJetWrapper().append(h);var e=this.mediator;var f;f="<ul id='resources'>";for(var b=0;b<d.length;b++){var a="<li><a href = '"+d[b].uid+"'>"+d[b].title+"</a></li>";f+=a}f+="</ul>";$(h).html(f);this.getOuterBackgroundColor("#tabs ul li a",true);$("#tabs").tabs({active:100,collapsible:true,select:function(k,l){k.preventDefault();var m=k.currentTarget;var n=$(m).attr("href");if(n.length>1){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE_RESOURCE,n)}}})},addTitle:function(a){$(".header").prepend("<span id='headerTitle'>"+a+"</span>")},displayADA:function(a){switch(a){case"0":$(this.adaButton).show();break;case"1":$(this.adaButton).hide();break;default:$(this.adaButton).hide()}},displayMap:function(a){switch(a){case"0":$(this.mapButton).show();$(this.showLocationButton).show();break;case"1":$(this.mapButton).hide();$(this.showLocationButton).hide();break;default:$(this.mapButton).hide();$(this.showLocationButton).hide()}},displayPrint:function(a){switch(a){case"0":$(this.printButton).show();break;case"1":$(this.printButton).hide();break;default:$(this.printButton).hide()}},displayNotes:function(a){switch(a){case"0":$(this.notesButton).show();break;case"1":$(this.notesButton).hide();break;default:$(this.notesButton).show()}},displayTranscript:function(a){switch(a){case"0":$(this.transcriptButton).show();break;case"1":$(this.transcriptButton).hide();break;default:$(this.transcriptButton).show()}},displayAccessibilityPage:function(a){switch(a){case"0":$(this.accessibilityButton).show();break;case"1":$(this.accessibilityButton).hide();break;default:$(this.accessibilityButton).show()}},displayEpub:function(a){switch(a){case"0":$(this.ePubButton).show();break;case"1":$(this.ePubButton).hide();break;default:$(this.ePubButton).hide()}},displayBannerText:function(b,a){if(!isEmpty(b)){$(this.bannerText).css("width","100%");$(this.bannerText).addClass("banner");$(this.bannerText).css("color",a);$(this.bannerText).text(b);$(this.bannerText).show()}else{$(this.bannerText).text("");$(this.bannerText).hide()}},displayHeaderBackground:function(){this.getHeaderFileName(this.bannerText);$(this.bannerText).show()},},{});puremvc.define({name:"jet.view.navigation.NavigationComponent",constructor:function(a){this.mediator=a;this.navDiv=document.createElement("div");this.navDiv.className="navigator";getJetWrapper().append(this.navDiv);this.addControls();this.addFeedback();this.addProgressBar();this.addPagination()}},{navDiv:null,feedbackDiv:null,mediator:null,previousButton:null,previousButtonG:null,nextButton:null,nextButtonG:null,checkButton:null,progressBar:null,DISABLED:0,ENABLED:1,HOVER:3,DOWN:4,pagination:null,handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},addControls:function(){var b=this.mediator;var a=document.createElement("aside");a.className="controls";$(a).attr("role","navigation");$(a).attr("aria-label","Previous and next page buttons");this.previousButton=document.createElement("button");$(this.previousButton).attr("aria-label","Previous Page");this.nextButton=document.createElement("button");$(this.nextButton).attr("aria-label","Next Page");$(this.previousButton).attr("alt","Previous Page");$(this.nextButton).attr("alt","Next Page");$(this.navDiv).append(a);$(a).append(this.nextButton);$(a).append(this.previousButton);this.previousButton.className="left";this.nextButton.className="right";this.disablePrevious();this.hideNext()},addControlsX:function(){var e=this.mediator;var b=document.createElement("aside");b.className="controls";this.previousButton=document.createElement("div");this.nextButton=document.createElement("div");$(this.navDiv).append(b);$(b).append(this.nextButton);$(b).append(this.previousButton);this.previousButton.className="left";this.nextButton.className="right";var a=document.createElement("canvas");$(a).css("top","0px");$(a).css("left","0px");a.width=40;a.height=40;$(this.nextButton).append(a);this.nextButtonG=a.getContext("2d");this.drawNextButton("#cccccc");var d=document.createElement("canvas");$(d).css("top","0px");$(d).css("left","0px");d.width=40;d.height=40;$(this.previousButton).append(d);this.previousButtonG=d.getContext("2d");this.drawPreviousButton("#cccccc");this.disablePrevious();this.enableNext()},addProgressBar:function(){var a=this.mediator;progressBar=document.createElement("progress");progressBar.className="progressBar";$(this.navDiv).append(progressBar)},updateProgressBar:function(b,a){if(isNaN(b)||isNaN(a)){return}if(progressBar){progressBar.value=b;progressBar.max=a}this.updatePagination(b,a)},addPagination:function(){var b=this.mediator;this.pagination=document.createElement("div");this.pagination.className="pagination";var a=document.createElement("span");$(a).css("display","block");$(a).css("text-align","center");$(a).addClass("paginationField");$(a).attr("id","pagination");$(this.pagination).append(a);getOuterBackgroundColor(this.pagination);$(this.pagination).css("position","absolute");$(this.pagination).css("left","40%");$(this.pagination).css("right","40%");$(this.pagination).css("bottom","0px");$(this.pagination).css("width","20%");$(this.pagination).css("margin-bottom","5px");$(this.pagination).css("background","none");$(this.navDiv).append(this.pagination)},displayPagination:function(a){switch(a){case"0":$(this.pagination).show();break;case"1":$(this.pagination).hide();break;default:$(this.pagination).show()}},updatePagination:function(b,a){if(isNaN(b)||isNaN(a)){return}if(this.pagination){$(this.pagination).find(".paginationField").html((b+1)+" of "+(a+1))}},addFeedback:function(){var a=this.mediator;this.feedbackDiv=document.createElement("div");this.feedbackDiv.className="feedback";$(this.navDiv).append(this.feedbackDiv);this.checkButton=document.createElement("input");this.checkButton.type="button";this.checkButton.value="Check";this.checkButton.className="checkButton";$(this.checkButton).css("background-color","black");$(this.checkButton).css("color","white");$(this.checkButton).css("border","1px solid white");$(this.feedbackDiv).append(this.checkButton)},showFeedback:function(){$(this.feedbackDiv).show()},showFeedbackMessage:function(a){this.checkButton.value=a},hideFeedback:function(){$(this.feedbackDiv).hide()},showCheckAnswer:function(){var a=this.mediator;this.showFeedback();this.checkButton.value="Submit";$(this.checkButton).unbind("click");$(this.checkButton).unbind("mouseenter");$(this.checkButton).unbind("mouseleave");$(this.checkButton).bind("click",function(){a.processQuestion(a);a.hideCheckAnswer()});$(this.checkButton).removeAttr("disabled")},hideCheckAnswer:function(){this.hideFeedback();$(this.checkButton).unbind("click")},disablePrevious:function(){var a=this.previousButton;$(a).unbind("click");$(a).unbind("dblclick");$(a).unbind("mouseenter");$(a).unbind("mouseleave");$(a).unbind("mousedown");this.updatePreviousButton(this.DISABLED)},disableNext:function(){var a=this.nextButton;$(a).unbind("click");$(a).unbind("dblclick");$(a).unbind("mouseenter");$(a).unbind("mouseleave");$(a).unbind("mousedown");this.updateNextButton(this.DISABLED)},hidePrevious:function(){var a=this.previousButton;$(a).hide()},hideNext:function(){var a=this.nextButton;$(a).hide()},enablePrevious:function(){this.disablePrevious();var b=this;var a=this.mediator;$(this.previousButton).css("cursor","pointer");b.updatePreviousButton(b.ENABLED);$(this.previousButton).bind("click",function(){a.moveBackward()});$(this.previousButton).bind("mouseenter",function(){b.updatePreviousButton(b.HOVER)});$(this.previousButton).bind("mouseleave",function(){b.updatePreviousButton(b.HOVER)});$(this.previousButton).bind("mousedown",function(){b.updatePreviousButton(b.DOWN)})},enableNext:function(){this.disableNext();var b=this;var a=this.mediator;$(this.nextButton).css("cursor","pointer");b.updateNextButton(this.ENABLED);$(this.nextButton).bind("click",function(){a.moveForward()});$(this.nextButton).bind("mouseenter",function(){b.updateNextButton(b.HOVER)});$(this.nextButton).bind("mousedown",function(){b.updateNextButton(b.DOWN)});$(this.nextButton).bind("mouseleave",function(){b.updateNextButton(b.ENABLED)})},disableCheckButton:function(){$(this.checkButton).attr("disabled","disabled")},drawNextButton:function(e){var b=[];b.push({x:17,y:6});b.push({x:30,y:19});b.push({x:17,y:33});b.push({x:11,y:28});b.push({x:20,y:19});b.push({x:11,y:11});b.push({x:17,y:6});var d=this.nextButtonG;this.drawOuterBox(d);this.drawInnerBox(d);d.strokeStyle="#FFFFFF";d.lineWidth=1;d.fillStyle=e;d.beginPath();d.moveTo(b[0]["x"],b[0]["y"]);for(var a=1;a<b.length;a++){d.lineTo(b[a]["x"],b[a]["y"])}d.closePath();d.stroke();d.fill()},drawProgressBar:function(b){var a=this.progressBarG;a.strokeStyle="#FFFFFF";a.lineWidth=1;a.fillStyle=b;a.fillRect(0,0,900,0);a.beginPath();a.closePath();a.stroke();a.fill()},updateNextButton:function(a){switch(a){case this.DISABLED:$(".navigator .controls .right").attr("disabled","disabled");break;case this.ENABLED:$(".navigator .controls .right").removeAttr("disabled","disabled");$(".navigator .controls .right").show();break;case this.HOVER:break;case this.DOWN:break}},updateNextButtonX:function(b){var a=this.nextButtonG;a.fillStyle=b;a.fill()},drawPreviousButton:function(e){var b=[];b.push({x:21,y:6});b.push({x:27,y:11});b.push({x:18,y:19});b.push({x:27,y:28});b.push({x:21,y:33});b.push({x:8,y:19});b.push({x:21,y:6});var d=this.previousButtonG;this.drawOuterBox(d);this.drawInnerBox(d);d.strokeStyle="#FFFFFF";d.lineWidth=1;d.fillStyle=e;d.beginPath();d.moveTo(b[0]["x"],b[0]["y"]);for(var a=1;a<b.length;a++){d.lineTo(b[a]["x"],b[a]["y"])}d.closePath();d.stroke();d.fill()},updatePreviousButton:function(a){switch(a){case this.DISABLED:$(".navigator .controls .left").attr("disabled","disabled");break;case this.ENABLED:$(".navigator .controls .left").removeAttr("disabled","disabled");$(".navigator .controls .left").show();break;case this.HOVER:break;case this.DOWN:break}},updatePreviousButtonX:function(b){var a=this.previousButtonG;a.fillStyle=b;a.fill()},drawOuterBox:function(a){a.rect(1,1,38,38);a.strokeStyle="#a7a7a7";a.lineWidth=2;a.stroke()},drawInnerBox:function(b){b.rect(3,3,33,33);var a=b.createLinearGradient(3,3,33,33);a.addColorStop(0,"#e7e7e7");a.addColorStop(1,"#111111");b.fillStyle=a;b.strokeStyle="#000000";b.lineWidth=1;b.fill()},displayNAV:function(a){switch(a){case"0":$(".controls").show();break;case"1":$(".controls").hide();break;default:$(".controls").show()}},},{});puremvc.define({name:"jet.controller.command.util.GraphicsUtils",constructor:function(){}},{page:null,calcMagnitude:function(e,d){var b=Math.abs(d.x-e.x);var a=Math.abs(d.y-e.y);var f=Math.sqrt(Math.pow(b,2)+Math.pow(a,2));return f},calcLength:function(b,a){return Math.abs(a-b)},isObjectRotated:function(k){var e=k.Points;if(e.length>=2){var d=e[0];var b=e[1];var h=null;var f=null;h=b.x-d.x;f=b.y-d.y;var l=Math.atan2(f,h);var a=180/Math.PI*l;if(a==0){return false}else{return true}}return false},setRotation:function(w,s,h,k){var p=w.Points;if(p.length>=2){var e=p[0];var d=p[1];var b=p[2];var a=p[3];var l=this.calcMagnitude(e,d);var v=this.calcMagnitude(d,a);var o={x:l,y:v};var r=this.isNormalOrientation(w);if(!r){this.flipVertical(s,p[0],o)}var f=null;var n=null;var u=null;var m=-1;n=d.x-e.x;u=d.y-e.y;f={x:l/2,y:v/2};m=1;var t=Math.atan2(u,n);var q=180/Math.PI*t;this.rotateObject(s,f,m,t,h,k);return q}return 0},isNormalOrientation:function(a){var p=parseInt(a.leftTopX);var o=parseInt(a.leftTopY);var d={x:p,y:o};var l=parseInt(a.rightTopX);var e=parseInt(a.rightTopY);var f=parseInt(l,e);var m=parseInt(a.rightBottomX);var k=parseInt(a.rightBottomY);var b={x:m,y:k};var h=this.calcCenterPoint(d,b);var n=this.isControlPointWithRange(d,b,f,h);return n},calcCenterPoint:function(e,b){var a=(e.x+b.x)/2;var d=(e.y+b.y)/2;return{x:a,y:d}},isControlPointWithRange:function(t,r,e,v){var m=this.calcMagnitude(v,t);var w=this.calcAngle(v,t);var s=180/Math.PI*w;var u=this.calcAngle(v,r);var q=180/Math.PI*u;var k=this.calcAngle(t,e);var x=0;var a=this.normalizeAngle(w);var z=this.normalizeAngle(u);var n=this.normalizeAngle(k);var d=180/Math.PI*a;var p=180/Math.PI*z;var o=180/Math.PI*n;var h=null;var l=null;if(a>z){var b=Math.PI*2-a;h=Math.abs(b+z)}else{h=Math.abs(z-a)}if(a>n){b=Math.PI*2-a;l=Math.abs(b+n)}else{l=Math.abs(n-a)}var y=180/Math.PI*h;var f=180/Math.PI*l;if(h<l){return false}return true},calcAngle:function(b,a){var d=a.y-b.y;var e=a.x-b.x;var h=Math.atan2(d,e);var f=180/Math.PI*h;return h},normalizeAngle:function(a){if(a<0){a=2*Math.PI-Math.abs(a)}return a},flipVertical:function(d,b,a){d.setTransform(1,0,0,-1,0,0);d.setTransform(1,0,0,1,0,a.y+b.y);d.translate(0,b.y-a.y)},flipHorizontal:function(d,b,a){d.setTransform(-1,0,0,1,0,0);d.setTransform(1,0,0,1,a.x+b.x,0);d.translate(b.x-a.x,0)},rotateObject:function(f,d,a,h,e,b){if(b){f.translate(-1*(d.x-e.x/2),-1*(d.y-e.y/2))}f.translate(1*d.x,1*d.y);f.rotate(a*h);f.translate(-1*d.x,-1*d.y)},calculateCanvasDimensions:function(m,a){var n=10000;var k=10000;var e=-10000;var d=-10000;for(var f=0;f<m.length;f++){var h=parseInt(m[f]["x"]);var l=parseInt(m[f]["y"]);n=h<n?h:n;k=l<k?l:k;e=h>e?h:e;d=l>d?l:d}var b=e-n;var o=d-k;a.x=b;a.y=o;a.top=k;a.left=n;return a},convertFromCharCode:function(e){var f="";if(e!=null){try{for(var b=0;b<=e.length-2;b+=2){var d=e.substring(b,b+2);f+=this.hexToDec(d)}}catch(a){}}return f},hexToDec:function(d){var f=parseInt(this.convertChar(d.substring(0,1)));var b=parseInt(this.convertChar(d.substring(1)));var a=f*16+b;var e=String.fromCharCode(a);return e},convertChar:function(a){var b=a.toUpperCase();switch(b){case"A":return"10";case"B":return"11";case"C":return"12";case"D":return"13";case"E":return"14";case"F":return"15";default:return b}},calcSlope:function(d,b){if(d.x-b.x==0){return jet.AppConstants.LARGE_VALUE}var a=(d.y-b.y)/(d.x-b.x);return a},projectPoint:function(e,d,f){var b={x:null,y:null};var a=e.x+d*(Math.cos(f));var h=e.y+d*(Math.sin(f));b.x=a;b.y=h;return b},calcMidPointFromPoints:function(f,d){var k={};var b=(d.x-f.x)/2;var h=(d.y-f.y)/2;var a=f.x+b;var e=f.y+h;k.x=a;k.y=e;return k},isFlipped:function(D,y,m){var f=m;var F=m;var h=this.calcAngle(D,y);var e=y.y-D.y;var L=y.x-D.x;var s=this.calcMidPointFromPoints(D,y);var t=this.calcMagnitude(F,D);var H=this.calcAngle(F,D);var A=this.calcAngle(s,D);var z=180/Math.PI*H;var E=this.calcAngle(F,y);var J=this.calcAngle(s,y);var x=180/Math.PI*E;var o=this.calcAngle(D,f);var k=this.calcAngle(s,f);var I=0;var a=this.normalizeAngle(H);var G=this.normalizeAngle(A);var M=this.normalizeAngle(E);var B=this.normalizeAngle(J);var u=this.normalizeAngle(o);var C=this.normalizeAngle(k);var d=180/Math.PI*a;var w=180/Math.PI*M;var v=180/Math.PI*u;var r=0;Number;var q=0;var n=0;var p=0;if(G>B){var b=Math.PI*2-G;r=Math.abs(b+B)}else{r=Math.abs(B-G)}if(G>C){b=Math.PI*2-G;q=Math.abs(b+C)}else{q=Math.abs(C-G)}if(a>M){b=Math.PI*2-a;n=Math.abs(b+M)}else{n=Math.abs(M-a)}if(a>u){b=Math.PI*2-a;p=Math.abs(b+u)}else{p=Math.abs(u-a)}var K=180/Math.PI*n;var l=180/Math.PI*p;if(r<q){return true}else{return false}},calculateOffset:function(e){var a=$(e);var k={};var d=0;var h=0;var f=0;var b=0;while($(a).attr("class").indexOf("content")<0){f=parseInt(a.css("left"));if($.isNumeric(f)){d=f+d}b=parseInt(a.css("top"));if($.isNumeric(b)){h=b+h}a=a.parent()}k.x=d;k.y=h;return k}},{NAME:"GraphicsUtils"});puremvc.define({name:"jet.view.component.ViewComponent",constructor:function(){this.div=document.createElement("div");this.contentDiv=document.createElement("div");this.div.className="componentX";this.contentDiv.className="text"}},{page:null,div:null,contentDiv:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv)},setParentAndPosition:function(b,d,a){this.page=d;switch(a){case"prepend":$(b).prepend(this.div);$(b).prepend(this.contentDiv);break;default:$(b).append(this.div);$(b).append(this.contentDiv)}},removeFromParent:function(){$(this.div).remove();$(this.contentDiv).remove()},initialize:function(){},setPositioning:function(a){switch(a){case"static":$(this.div).removeAttr("style");$(this.contentDiv).removeAttr("style");$(this.div).css("position","static");$(this.contentDiv).css("position","static");break;case"absolute":$(this.div).removeAttr("style");$(this.contentDiv).removeAttr("style");$(this.div).css("position","absolute");$(this.contentDiv).css("position","absolute");break}},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)},removeContentClass:function(a){$(this.contentDiv).removeClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",0);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.contentDiv).text()},getHTML:function(){return $(this.contentDiv).html()},getDiv:function(){return this.div},getContentDiv:function(){return this.contentDiv},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},setComponentLevelBranchOptions:function(a){this.branchOptions=a},getComponentLevelBranchOptions:function(){return this.branchOptions},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).unbind("mouseenter");$(this.contentDiv).unbind("mouseleave");$(this.contentDiv).attr("disabled","disabled")},enable:function(){}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.ARComponent",constructor:function(){var a=this;this.gParams.myNodesInterval=setInterval(this.checkForNodes.bind(a),1000)}},{gParams:{nodesMessage:{nodes:null},myNodesInterval:null,geoLocations:[],geoLock:false,currentUID:"",bestChoiceUID:"",bestChoiceTitle:"",geoLocationDebug:false,geoLocationReportDiv:null,precision:25,geoLocationInterval:5000,errorMessageDelivered:false},intervalIndex:0,headingCandidate:"-",currentHeading:"-1",headingIndex:0,createReportDiv:function(){var a=document.createElement("div");this.gParams.geoLocationReportDiv=a;$(a).css("opacity",".5");$(a).css("backgroundColor","#000000");$(a).css("color","#FFFFFF");$(a).width("100%");$(a).height("5%");$(a).css("position","fixed");$(a).css("top","95%");$("body").append(this.gParams.geoLocationReportDiv)},checkForNodes:function(){console.log("ARMaker checking for nodes...");jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODES,this.gParams.nodesMessage);if(this.gParams.nodesMessage&&this.gParams.nodesMessage.nodes!=null){clearInterval(this.gParams.myNodesInterval);this.createLocations(this.gParams.nodesMessage.nodes);this.printLocations(this.gParams.geoLocations);this.createReportDiv();this.startLocationFinder()}},createAudio:function(){var a=document.createElement("audio");$(a).attr("src","base/audio/tone.mp3");this.gParams.audio=a;this.gParams.audio.play()},createGeoLocation:function(e,l,f,b,k,h,d){var a={};a.uid=e;a.latitude=l;a.longitude=f;a.latitudeProximity=b;a.longitudeProximity=k;a.title=h;a.geoheading=d;return a},createLocations:function(b){var p=null;var k=null;var e=null;var o=null;for(var l=0;l<b.length;l++){var d=b[l];var m=d.uid;var f=d.node;if(f&&f.getLatitude&&f.getLongitude){var n=this.normalizeCoordinate(f.getLatitude());var a=this.normalizeCoordinate(f.getLongitude());if(f.getLatitudeProximity){p=this.normalizeProximity(f.getLatitudeProximity(),true)}if(f.getLongitudeProximity){k=this.normalizeProximity(f.getLongitudeProximity(),false)}if(f.getTitle){o=f.getTitle()}if(f.getGeoheading){e=f.getGeoheading()}var h=this.createGeoLocation(m,n,a,p,k,o,e);this.insertLocation(h)}}},normalizeCoordinate:function(b){if(b!=null&&b!=undefined){var a=b.split(" ");if(a.length>0){b=this.convertTokens(a)}return b}return 0},normalizeProximity:function(d,b){var e=b?60.76:80;if(isNaN(d)){d=e}else{d=Number(d)}var a=(d/e)/3600;return a},convertTokens:function(b){var f=0;var e=0;var a=0;var d=0;if(b.length>0){e=Number(b[0])}if(b.length>1){a=Number(b[1])}if(b.length>2){d=Number(b[2])}f=e+((a*60)+d)/3600;return f},insertLocation:function(a){var d=0;var b=parseFloat(a.latitude);if(this.gParams.geoLocations.length==0){this.gParams.geoLocations.push(a);return}while(d<this.gParams.geoLocations.length){var e=parseFloat(this.gParams.geoLocations[d].latitude);if(b<e){this.gParams.geoLocations.splice(d,0,a);return}d++}this.gParams.geoLocations.push(a);return},printLocations:function(a){for(var b=0;b<a.length;b++){var d=a[b];console.log(d.uid+"> "+d.latitude+","+d.longitude);console.log(d.latitudeProximity+","+d.longitudeProximity);console.log(d.geoheading+","+d.geoheading)}},startLocationFinder:function(){var a={enableHighAccuracy:true,timeout:120000,maximumAge:10000};id=navigator.geolocation.watchPosition(this.handleLocation.bind(this),this.handleError.bind(this),a)},onProgress:function(a){console.log(a)},isCorrectBearing:function(l,k,d){try{if(l==null||typeof l=="undefined"||k==null||typeof k=="undefined"){return true}var h=false;var a=false;if(!l.geoheading||l.geoheading==-1||typeof l.geoheading=="undefined"){return true}if(!k.heading||k.heading==null||typeof k.heading=="undefined"){return true}h=!isNaN(l.geoheading);a=!isNaN(k.heading);if(!h||!a){return true}var e=d.getCurrentHeading(k.heading,d);var b=Number(l.geoheading);var m=b+360;if(Math.abs(Number(e)-b)<=20){return true}else{if(Math.abs(Number(e)-m)<=20){return true}else{return false}}return true}catch(f){alert(f);return true}},getCurrentHeading:function(a,b){var d=b.convertHeadingtoLetters(a);if(b.headingIndex<3){if(d==b.headingCandidate){b.headingIndex++}else{b.headingCandidate=d;b.headingIndex=0}}else{b.currentHeading=a;b.headingIndex=0}return b.currentHeading},handleLocation:function(d){if(d==null||d==undefined){return}this.displayMessage("Accuracy:"+d.coords.accuracy+"m");if(d.coords.accuracy<=this.gParams.precision&&!this.gParams.geoLock){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_GEOLOCATION,d);var b=d.coords;var a=this;this.findPage(b,a)}},findPage:function(n,l){l.gParams.bestChoiceUID="";l.gParams.bestChoiceTitle="";bestCandidate=1000000;smallestLatDifference=1000000;smallestLongDifference=1000000;l.gParams.geoLock=true;for(var f=0;f<l.gParams.geoLocations.length;f++){var d=l.gParams.geoLocations[f];var o=d.latitudeProximity;var e=d.longitudeProximity;var h=Math.abs(n.latitude-d.latitude);var k=Math.abs(n.longitude-d.longitude);l.updateDisplay(h,k,smallestLatDifference,smallestLongDifference,d);try{if(!l.isCorrectBearing(d,n,l)){continue}}catch(m){alert(m)}smallestLatDifference=h<smallestLatDifference?h:smallestLatDifference;smallestLongDifference=k<smallestLongDifference?k:smallestLongDifference;if(h<=o&&k<=e){var b=l.calcHyp(h,k);if(b<bestCandidate){bestCandidate=b;l.gParams.bestChoiceUID=d.uid;l.gParams.bestChoiceTitle=d.title;if(l.gParams.geoLocationDebug){var a=l.convertDegreesToFeet(l.calcHyp(h,k));alert("found best choice: "+l.gParams.bestChoiceUID+"at "+a+" feet.")}}}}if(l.gParams.bestChoiceUID!=l.gParams.currentUID&&l.gParams.bestChoiceUID!=null&&l.gParams.bestChoiceUID!=""&&l.gParams.bestChoiceUID!=undefined){l.getPage(l.gParams.bestChoiceUID);l.sendMapAlert(l.gParams.bestChoiceUID);l.gParams.currentUID=l.gParams.bestChoiceUID}l.gParams.geoLock=false},updateDisplay:function(d,f,l,b,e){var h=this.calcHyp(d,f);var k=this.calcHyp(l,b);var a=this.convertHeadingtoLetters(this.currentHeading);if(h<k){$(this.gParams.geoLocationReportDiv).html("<center>You are within "+this.convertDegreesToFeet(h)+" feet of "+e.title+". Heading: "+a+"</center>")}},calcHyp:function(a,b){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2))},showDistance:function(b,a){var d=this.calcHyp(b,a);if(true){$(this.gParams.geoLocationReportDiv).html("<center>You are within "+this.convertDegreesToFeet(d)+" feet of the closest position.</center>")}},displayMessage:function(a){$(this.gParams.geoLocationReportDiv).html("<center>"+a+"</center>")},getPage:function(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,a)},sendMapAlert:function(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.ALERT_MAP,a)},setVisitedMarker:function(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_MARKER,a)},convertDegreesToFeet:function(a){return Math.ceil(a*288200)},convertHeadingtoLetters:function(a){if(isNaN(a)){return"-"}if(a>=350){return"N"}if(a>=281){return"NW"}if(a>=261){return"W"}if(a>=191){return"SW"}if(a>=171){return"S"}if(a>=101){return"SE"}if(a>=81){return"E"}if(a>=11){return"NE"}if(a>=0){return"N"}return"-"},handleError:function(a){if(this.gParams.errorMessageDelivered==false){this.gParams.errorMessageDelivered=true;alert("This app was unable to get a precise GPS coordinate.  Please move out of doors and restart app.")}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.AnchorTileComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");this.div.className="tileSpacing";this.contentDiv=document.createElement("div");this.contentDiv.className="tileLabel";this.dragDiv=document.createElement("div");this.dragDiv.className="dragHandle"}},{dragDiv:null,indexInComponentArray:null,page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.dragDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a);$(this.contentDiv).css("opacity",a)},setText:function(a){$(this.contentDiv).html(a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},setZindex:function(a){$(this.div).css("z-index",a)},getGutter:function(){var a=10;return a},enable:function(){$(this.div).fadeTo("fast",1);$(this.contentDiv).fadeTo("fast",1)},disable:function(){$(this.div).fadeTo("fast",0.8);$(this.contentDiv).fadeTo("fast",0.8)},getUserInput:function(){},getIndexInArray:function(){return this.indexInComponentArray},makeDraggable:function(b,e,a,d){this.indexInComponentArray=d;$(this.div).unbind("dragstop");$(this.div).unbind("dragstart");$(this.div).draggable();$(this.div).bind("dragstop",function(){a.dragStop(this,d)});$(this.div).bind("dragstart",function(){a.dragStart(this)});this.addDragHandle();this.loadDragImage()},enableDraggable:function(){$(this.div).draggable("option","disabled",false)},disableDraggable:function(){$(this.div).draggable("disable")},addDragHandle:function(){var d=this.componentWidth*1.3;var a=this.componentWidth*0.3;var b=this.componentHeight;$(this.div).css("width",d);$(this.dragDiv).css("top","0px");$(this.dragDiv).css("left",this.componentWidth+"px");$(this.dragDiv).css("width",a);$(this.dragDiv).css("height",b)},loadDragImage:function(){$(this.dragDiv).html("<img src= './lib/css/drag_handle.png' />")}},{});puremvc.define({name:"jet.view.component.AudioComponent",constructor:function(d){this.mediator=d;this.enableAutoPlay="0";this.enableController="1";this.volume=0.8;this.div=document.createElement("div");this.show(false);this.audioDiv=document.createElement("div");this.audioDiv.className="audio_hostFrame";$(this.audioDiv).draggable();this.contentDiv=document.createElement("div");this.jpTypeSingle=document.createElement("div");this.jpGui=document.createElement("div");this.jpControls=document.createElement("ul");this.playControlDiv=document.createElement("a");this.div.className="jp-jplayer";this.contentDiv.id="jp_container_1";this.contentDiv.className="jp-audio";this.jpTypeSingle.className="jp-type-single";this.jpGui.className="jp-gui jp-interface";var a='<div class="jp-progress">';a+='<div class="jp-seek-bar">';a+='<div class="jp-play-bar"></div></div></div>';a+='<div class="jp-current-time"></div>';a+='<div class="jp-duration"></div>';$(this.jpGui).html(a);this.jpControls.className="jp-controls";var b="hello";var e='<li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>';e+='<li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>';e+='<li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>';$(this.jpControls).html(e);this.setParent($("body")[0])}},{mediator:null,div:null,audioDiv:null,contentDiv:null,jpTypeSingle:null,jpGui:null,jpControls:null,playControlDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,mediaURL:null,enableAutoPlay:null,enableController:null,volume:null,fallback:null,audioMarkedDivs:null,setParent:function(b){var a=this;$(b).append(this.audioDiv);var e=this.div;$(this.audioDiv).append(this.div);$(this.audioDiv).append(this.contentDiv);$(this.contentDiv).append(this.jpTypeSingle);$(this.jpTypeSingle).append(this.jpGui);$(this.jpGui).append(this.jpControls);$(this.jpControls).append(this.playControlDiv);$(this.div).jPlayer({timeupdate:function(f){a.handleTimeUpdate(f,a)},size:{width:"1px",height:"1px"},solution:"html",supplied:"mp3,wav",wmode:"window"});var d="./base/audio/"+this.getMediaURL()},setClass:function(a){$(this.div).attr("class",a)},show:function(k){if(k){$(this.div).removeAttr("disabled","disabled");var e="./base/audio/"+this.getMediaURL();var l="./base/audio/"+this.fallback;$(".jp-jplayer").jPlayer("clearMedia");$(this.div).jPlayer("setMedia",{mp3:e,wav:l});if(this.enableAutoPlay=="1"){$(this.div).jPlayer("play")}if(this.enableController=="1"){$(this.audioDiv).show()}else{$(this.audioDiv).hide()}$(this.div).jPlayer("volume",this.volume);var n=parseInt($(".viewer").css("width"));var h=parseInt($(".viewer").css("height"));var a=parseInt($(".viewer").css("left"));var o=parseInt($(".viewer").css("top"));var d=parseInt($(".viewer").css("width"));var m=parseInt($(".viewer").css("height"));var b=parseInt($(this.div).width());var f=parseInt($(this.div).height());$(this.audioDiv).draggable();this.getAudioMarkedDivs()}else{$(this.div).jPlayer("stop");$(this.closeButton).unbind("click")}},play:function(){$(this.div).jPlayer("play")},initialize:function(){},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a;$(this.div).jPlayer({size:{width:this.getWidth()+"px",height:this.getHeight()+"px"}});$(this.audioDiv).css("width",this.getWidth()+"px");$(".jp-interface").css("width",this.getWidth()+"px")},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a;$(this.div).jPlayer({size:{width:this.getWidth()+"px",height:this.getHeight()+"px"}});$(this.audioDiv).css("height",this.getHeight()+"px");$(".jp-interface").css("height",this.getHeight()+"px")},getHeight:function(){return this.componentHeight},setX:function(a){$(this.audioDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.audioDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a);this.bindButton()},setMediaURL:function(a){this.mediaURL=a},getMediaURL:function(){return this.mediaURL},setAudioOptions:function(a){this.enableAutoPlay=a.enableAutoPlay;this.enableController=a.enableController;this.volume=parseInt(a.volume)/100;this.fallback=a.fallback},getAudioMarkedDivs:function(){var a=this;var b=$(a.audioDiv).parent();this.audioMarkedDivs=b.find("[data-audio_in]");$(a.audioMarkedDivs).each(function(){var d=$(this).attr("data-effect_in");a.handleInitialVisibility(this,d)})},handleInitialVisibility:function(a,b){switch(b){case"none":$(a).hide();break;case"show":$(a).hide();break;case"hide":$(a).hide();break;case"fadeIn":$(a).hide();break;case"fadeOut":$(a).hide();break;case"slideDown":$(a).hide();break;case"slideUp":$(a).hide();break;case"scrollTo":$(a).show();break;default:$(a).hide()}},handleTimeUpdate:function(d,a){var b=d.jPlayer.status.currentTime;$(a.audioMarkedDivs).each(function(){var h=$(this).attr("data-audio_in");var f=$(this).attr("data-speed");if(Math.abs(b-h)<1){var e=$(this).attr("data-effect_in");a.handleEffect(this,e,f)}});$(a.audioMarkedDivs).each(function(){var h=$(this).attr("data-audio_out");var f=$(this).attr("data-speed");if(Math.abs(b-h)<1){var e=$(this).attr("data-effect_out");a.handleEffect(this,e)}})},handleEffect:function(a,b,d){switch(d){case"fast":d=200;break;case"slow":d=2000;break;default:d=500;break}switch(b){case"none":$(a).show();break;case"show":$(a).show();break;case"hide":$(a).hide();break;case"fadeIn":$(a).fadeIn(d);break;case"fadeOut":$(a).fadeOut(d);break;case"slideDown":$(a).slideDown(d);break;case"slideUp":$(a).slideUp(d);break;case"scrollTo":$(a).show();$("html, body").animate({scrollTop:$(a).offset().top-70},d);default:$(a).show()}}},{});puremvc.define({name:"jet.view.component.CheckBoxComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");$(this.div).css("width","50px");$(this.div).css("height","50px");$(this.div).css("float","left");this.div.className="checkboxparent";this.contentDiv=document.createElement("input");this.contentDiv.className="checkbox";this.contentDiv.type="checkbox"}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){},setCheck:function(a){this.contentDiv.checked=a},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(e){e.stopPropagation();if(b.checked){d.setBranchingComponent(a)}d.handleEvent(jet.AppConstants.CHECKBOX,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).attr("disabled","disabled")},getUserInput:function(){if(this.contentDiv.checked==true){return"true"}else{return"false"}},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)}},{});puremvc.define({name:"jet.view.component.DashboardComponent",constructor:function(){this.div=document.createElement("div");this.div.className="dashboard";$(this.div).css("pointer-events","none");getJetWrapper().append(this.div)}},{div:null,handleEvent:function(a){switch(a.type){}},doDashboardLayout:function(){$(this.div).layout({type:"flow",resize:false,alignment:"left"})},initialize:function(){},},{});puremvc.define({name:"jet.view.component.HTMLAudioComponent",constructor:function(a){this.show(false);this.audioMediator=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).retrieveMediator(jet.view.mediator.AudioMediator.NAME);this.audioDiv=this.audioMediator.getAudioPlayer()}},{mediator:null,audioMediator:null,div:null,audioDiv:null,parentDiv:null,audioMarkedDivs:null,sourceDiv:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,mediaURL:null,enableAutoPlay:null,enableController:null,volume:null,animators:null,setParent:function(a){this.parentDiv=a},setClass:function(a){$(this.div).attr("class",a)},setAnimators:function(a){this.animators=a;this.audioMediator.setAnimators(a)},show:function(a){if(a){$(this.parentDiv).prepend(this.audioDiv);var b=$(this.parentDiv).css("background-color");var d=this;$(this.div).removeAttr("disabled","disabled");var e="./base/audio/"+this.getMediaURL();d.audioMediator.setSource(e);d.audioMediator.updateColors(b);if(d.enableAutoPlay=="1"){d.audioMediator.setAutoplay(true)}else{d.audioMediator.setAutoplay(false)}if(this.enableController=="1"){$(this.audioDiv).show()}else{$(this.audioDiv).hide()}this.audioMarkedDivs=this.getAudioMarkedDivs();this.audioMediator.setaudioMarkedDivs(this.audioMarkedDivs)}else{if(this.audioMediator){this.audioMediator.requestPause()}}},animatePosition:function(a,d,b){},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){},getWidth:function(){return this.componentWidth},setHeight:function(a){},getHeight:function(){return this.componentHeight},setX:function(a){},setInitialX:function(a){},getInitialX:function(){},setInitialY:function(a){},getInitialY:function(){},getX:function(){},setY:function(a){},getY:function(){},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){},setBackgroundColor:function(a){},updatePosition:function(){},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a);this.bindButton()},setMediaURL:function(a){this.mediaURL=a},getMediaURL:function(){return this.mediaURL},setAudioOptions:function(a){this.enableAutoPlay=a.enableAutoPlay;this.enableController=a.enableController;this.volume=parseInt(a.volume)/100},getAudioMarkedDivs:function(){var a=this;this.audioMarkedDivs=$(this.parentDiv).find("[data-audio_in]");$(a.audioMarkedDivs).each(function(){var b=$(this).attr("data-effect_in");a.handleInitialVisibility(this,b)});return this.audioMarkedDivs},handleInitialVisibility:function(a,b){switch(b){case"none":$(a).hide();break;case"show":$(a).hide();break;case"hide":$(a).hide();break;case"fadeIn":$(a).hide();break;case"fadeOut":$(a).hide();break;case"slideDown":$(a).hide();break;case"slideUp":$(a).hide();break;case"scrollTo":$(a).show();break;default:$(a).hide()}}},{});puremvc.define({name:"jet.view.component.ImageComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");this.div.className="imageparent";this.contentDiv=document.createElement("img");this.contentDiv.className="image";this.captionDiv=document.createElement("div");this.captionDiv.className="caption"}},{page:null,captionOptions:null,captionDiv:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv)},setParentAndPosition:function(b,d,a){this.page=d;switch(a){case"prepend":$(b).prepend(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv);break;default:$(b).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv)}},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setCaptionOptions:function(f){this.captionOptions=f;if(this.captionOptions!=null){var h="<p>"+this.captionOptions.imageCaption+"</p><p>"+this.captionOptions.imageSource+"</p>";$(this.captionDiv).html(h);var e=parseInt(this.getY());var a=parseInt(this.getHeight());var d=20;var b=e+a+d;var k=parseInt(this.getX());if(!isEmpty(this.captionOptions.imageID)){$(this.contentDiv).attr("id",this.captionOptions.imageID)}}},getCaptionOptions:function(){return this.captionOptions},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setText:function(a){if(a.length>0){this.contentDiv.src="base/"+a}else{$(this.contentDiv).hide()}},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).attr("disabled","disabled")},enable:function(){},setWidth:function(a){},getWidth:function(){return this.componentWidth},setHeight:function(a){},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",0+"px");this.componentX=a},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",0+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getImageParent:function(){return this.div},getContentDiv:function(){return this.contentDiv}},{});puremvc.define({name:"jet.view.component.InputTextComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("input");this.div.className="inputbox";$(this.div).addClass("chip_extralight");$(this.div).addClass("d_field");this.div.type="text";this.isCheckButtonRequested=false}},{page:null,isCheckButtonRequested:false,setParent:function(a,b){this.page=b;if(a!=null){$(a).append(this.div)}this.enable()},resetDiv:function(a){this.div=a;this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},setPrompt:function(a){$(this.div).attr("placeholder",a)},enable:function(){var a=this.page;a.isCheckButtonRequested=false;this.disable();$(this.div).removeAttr("disabled","disabled");$(this.div).bind("keydown",function(b){if(!a.isCheckButtonRequested){a.showCheckAnswerButton();a.isCheckButtonRequested=true}})},disable:function(){$(this.div).unbind("keydown");$(this.div).attr("disabled","disabled")},getUserInput:function(){return $.trim($(this.div).val())}},{});puremvc.define({name:"jet.view.component.MeterComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.meterNeedleDiv=document.createElement("div");this.contentDiv=document.createElement("canvas");this.meterNeedleDivContent=document.createElement("canvas");this.meterPieDivContent=document.createElement("canvas");this.div.className="dbMeterDiv";this.meterNeedleDiv.className="dbMeterNeedleDiv";this.contentDiv.className="dbMeterDivContent";this.meterNeedleDivContent.className="dbMeterNeedleDivContent";this.graphicsUtils=new jet.controller.command.util.GraphicsUtils()}},{mediator:null,div:null,contentDiv:null,meterNeedleDiv:null,meterNeedleDivContent:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,graphicsUtils:null,isMeterAnimating:false,lastNeedlePosition:0,enabled:"false",setParent:function(d){$(d).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.meterNeedleDiv);$(this.meterNeedleDiv).append(this.meterNeedleDivContent);$(this.div).append(this.meterPieDivContent);this.initMeter();var b=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var a=b.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);a.layoutDashboard()},setClass:function(a){},show:function(a){if(a){if(this.enabled=="true"){$(".dbMeterDiv").css("visibility","visible")}else{$(".dbMeterDiv").css("visibility","hidden")}$(this.div).show()}else{$(this.div).hide()}},initialize:function(){},initMeter:function(){var h=this;this.clearCanvas(this.contentDiv);var f=0.5;var a=150;var e=parseInt(a*f);var l=parseInt(a*0.25);var d=parseInt(l*f);var b="#FFFFFF";var k=b;this.drawPie(this.contentDiv,a/2+10,e+10,2,e,0,144,"#FFFFFF");this.drawPie(this.contentDiv,a/2+10,e+10,2,e,144,180,"#00FF00");this.highlightChord(this.contentDiv,a/2,e,a,e,"rgba(255,255,255,.1)","lightgray",10);this.drawChord(this.contentDiv,a/2,e,a,e,"rgba(255,255,255,.1)","black",1);this.drawChord(this.contentDiv,a/2,e,l,d,k,"black",10);this.setMeter(2)},setMeter:function(d){var e=0.5;var a=150;var b=parseInt(a*e);if(this.isMeterAnimating){return}d=Math.max(d,2);this.isMeterAnimating=true;this.animNeedle(this.meterNeedleDivContent,a/2+10,b+5,2,b-5,this.lastNeedlePosition,d)},setProperties:function(a){this.properties=a},setX:function(a){$(this.div).css("left",a+"px");$(this.meterNeedleDiv).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");$(this.meterNeedleDiv).css("top",a+"px");this.componentY=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},setEnabled:function(a){this.enabled=a},getEnabled:function(){return this.enabled},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a)},clearCanvas:function(a){g=this.contentDiv.getContext("2d");g.clearRect(0,0,a.width,a.height)},drawChord:function(I,B,A,D,P,b,L,F){var O={};var z={};g=this.contentDiv.getContext("2d");g.shadowBlur=0;var k=parseInt(D/2);var t={x:B-k,y:A};var p={x:B+k,y:A};var l={x:B,y:A-P};var a=F;var d=this.graphicsUtils.calcAngle(t,p);var e=this.graphicsUtils.calcMidPointFromPoints(t,p);var K=this.graphicsUtils.calcMagnitude(l,e);var R=this.graphicsUtils.calcMagnitude(t,p);var u=((R*R)/(8*K))+(K/2);var N=this.graphicsUtils.calcAngle(l,e);var s=u*Math.cos(N);var v=u*Math.sin(N);var r=l.x+s;var o=l.y+v;var Q=d;var B=a;var A=a;var q=t.y-o;var J=t.x-r;var n=p.y-o;var H=p.x-r;var M=Math.atan2(q,J);var G=Math.atan2(n,H);var f=this.graphicsUtils.isFlipped(t,p,l);g.beginPath();g.fillStyle=b;g.strokeStyle=L;g.lineWidth=F;var E=10;var C=10;g.moveTo(r+E,o+C);g.arc(r+E,o+C,u,M,G,f);g.moveTo(r+E-u,o+C);g.lineTo(r+E+u+(a/2),o+C);g.stroke();g.fill()},highlightChord:function(I,B,A,D,P,b,L,F){var O={};var z={};g=this.contentDiv.getContext("2d");g.shadowBlur=10;g.shadowColor=L;var k=parseInt(D/2);var t={x:B-k,y:A};var p={x:B+k,y:A};var l={x:B,y:A-P};var a=F;var d=this.graphicsUtils.calcAngle(t,p);var e=this.graphicsUtils.calcMidPointFromPoints(t,p);var K=this.graphicsUtils.calcMagnitude(l,e);var R=this.graphicsUtils.calcMagnitude(t,p);var u=((R*R)/(8*K))+(K/2);var N=this.graphicsUtils.calcAngle(l,e);var s=u*Math.cos(N);var v=u*Math.sin(N);var r=l.x+s;var o=l.y+v;var Q=d;var B=a;var A=a;var q=t.y-o;var J=t.x-r;var n=p.y-o;var H=p.x-r;var M=Math.atan2(q,J);var G=Math.atan2(n,H);var f=this.graphicsUtils.isFlipped(t,p,l);g.beginPath();g.fillStyle=b;g.strokeStyle=L;g.lineWidth=a;var E=10;var C=10;g.moveTo(r+E,o+C);g.arc(r+E,o+C,u,M,G,f);g.moveTo(r+E-u,o+C);g.lineTo(r+E+u+(a/2),o+C);g.stroke()},animNeedle:function(e,n,l,o,h,k,b){var f=k;var d=this;var m=1;if(k>b){m=-1}var a=setInterval(function(){f+=m;if(m==1&&f<b){d.drawNeedle(e,n,l,o,h,f)}else{if(m==-1&&f>b){d.drawNeedle(e,n,l,o,h,f)}else{clearInterval(a);a=null;d.isMeterAnimating=false;d.lastNeedlePosition=b}}},30)},drawNeedle:function(d,p,o,q,f,b){d.width=d.width;var e=(180-b)*Math.PI/180;var h=p+(f*Math.cos(e));var a=o-(f*Math.sin(e));var l=d.getContext("2d");l.beginPath();var n={x:h,y:a};var m={x:p,y:o};var k=q;l.lineWidth=k;l.strokeStyle="rgba(0,0,0, 1)";l.moveTo(n.x,n.y);l.lineTo(m.x,m.y);l.stroke();l.closePath()},drawPie:function(d,s,r,n,h,o,b,k){var m=d.getContext("2d");var e=o;m.beginPath();while(e<=b){var f=(180-e)*Math.PI/180;var l=s+(h*Math.cos(f));var a=r-(h*Math.sin(f));var q={x:l,y:a};var p={x:s,y:r};m.lineWidth=n;m.strokeStyle=k;m.moveTo(q.x,q.y);m.lineTo(p.x,p.y);m.stroke();e++}m.closePath()},displayBackground:function(a){var b=a.getContext("2d");var d=new Image();d.src="./lib/css/meter.png";b.drawImage(d,0,0)}},{});puremvc.define({name:"jet.view.component.NotesComponent",constructor:function(b){var a=this;this.mediator=b;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="popup";$(this.div).attr("role","alert");$(this.div).css("background-color","#fdfdbe");$(this.contentDiv).attr("aria-activedescendant","popupContent");this.contentDiv.className="popupContent";$(this.contentDiv).attr("id","popupContent");$(this.contentDiv).attr("aria-live","assertive");$(this.contentDiv).attr("role","alert");$(this.contentDiv).css("background-color","#fdfdbe");this.commitButton=document.createElement("input");this.commitButton.type="button";this.commitButton.className="notesButton";$(this.commitButton).css("position","absolute");$(this.commitButton).val("Save");$(this.commitButton).css("width","50px");$(this.commitButton).css("height","30px");$(this.commitButton).css("margin-bottom","10px");$(this.commitButton).click(function(){a.saveNotes()});$(this.contentDiv).append(this.commitButton);this.printButton=document.createElement("input");this.printButton.type="button";this.printButton.className="notesButton";$(this.printButton).css("position","absolute");$(this.printButton).val("Print");$(this.printButton).css("left","60px");$(this.printButton).css("width","50px");$(this.printButton).css("height","30px");$(this.printButton).css("margin-bottom","10px");$(this.printButton).css("margin-left","10px");$(this.printButton).click(function(){a.printNotes()});$(this.contentDiv).append(this.printButton);this.notesDiv=document.createElement("textarea");this.notesDiv.className="notesContent";this.notesDiv.type="text";$(this.notesDiv).attr("id","notesContent");$(this.notesDiv).attr("aria-live","assertive");$(this.notesDiv).attr("role","alert");$(this.notesDiv).css("position","absolute");$(this.notesDiv).css("top","60px");$(this.notesDiv).css("width","95%");$(this.notesDiv).css("height","80%");$(this.notesDiv).css("max-height","485px");$(this.notesDiv).css("border","none");$(this.notesDiv).css("padding-left","10px");$(this.notesDiv).css("resize","none");$(this.notesDiv).css("border-left","4px double rgba(238, 150, 122, .75)");$(this.notesDiv).css("background-color","#fdfdbe");$(this.contentDiv).append(this.notesDiv);this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,notesDiv:null,commitButton:null,learnerName:"testUser",setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show().focus();this.getNotes();this.bindButton()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},saveNotes:function(){try{var b=JSON.stringify($(this.notesDiv).attr("value"));localStorage[window.location+"/"+this.learnerName+"/notes"]=b}catch(a){alert(a)}},printNotes:function(){try{var d=$(this.notesDiv).attr("value");d=this.processUserResponse(d);var a=window.open("","my div","height=400,width=600");a.document.write("<html><head><title>My Notes</title>");a.document.write("</head><body >");a.document.write(d);a.document.write("</body></html>");a.document.close();a.focus();a.print();a.close();return true}catch(b){alert(b)}},getNotes:function(){if(localStorage!=null){var response=eval(localStorage[window.location+"/"+this.learnerName+"/notes"])}if(response!=null&&response!=undefined&&response.length>0){$(this.notesDiv).attr("value",response)}},processUserResponse:function(d){var e=/\r\n|\n\r|\n|\r/g;var f=d.split(e);var b="";for(var a=0;a<f.length;a++){b+=f[a]+"<br>"}return b},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a)},getLearnerName:function(){if(LMSIsInitialized()==true){var a=doGetValue("cmi.learner_name");if(a!=null&&a!=undefined&&a.length>0){this.learnerName=a}}}},{});puremvc.define({name:"jet.view.component.OpenQuestionComponent",constructor:function(){this.div=document.createElement("div");this.contentDiv=document.createElement("div");this.div.className="component";this.contentDiv.className="text";this.answerKeys=[];this.userInputComponents=[]}},{page:null,div:null,contentDiv:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,answerKeys:null,userInputComponents:null,sourceText:null,hasEmbeddedVariables:false,show:function(a){if(a){if(typeof MathJax!=="undefined"&&MathJax.Hub){}}},initialize:function(){},setParent:function(a,b){this.page=b;$(a).append(this.contentDiv)},removeFromParent:function(){$(this.div).remove();$(this.contentDiv).remove()},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},addQuestionStem:function(b){var a=new jet.view.component.ViewComponent;a.setContentClass("stem");a.setParent(this.contentDiv);a.setText(b)},addDistractor:function(d,a){var e=document.createElement("div");$(e).attr("class","distractorContainer");$(this.contentDiv).append(e);var b=new jet.view.component.CheckBoxComponent;b.setParent(e,this.page);b.setContentClass("distractorcheckbutton");this.page.answerKeys.push(a);this.page.userInputComponents.push(b);b.setIndexInArray(this.userInputComponents.length-1);var b=new jet.view.component.ViewComponent;b.setContentClass("distractor");b.setParent(e,this.page);b.setText(d)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.contentDiv).text()},getContentDiv:function(){return this.contentDiv},setSourceText:function(a){this.sourceText=a},getSourceText:function(){return this.sourceText},getDiv:function(){return this.div},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},setComponentLevelBranchOptions:function(a){this.branchOptions=a},getComponentLevelBranchOptions:function(){return this.branchOptions},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).attr("disabled","disabled")},enable:function(){},evaluateEmbeddedVariables:function(){if(this.hasEmbeddedVariables||$(this.contentDiv).text().match(/({)(\S*)(})/)!=null){this.hasEmbeddedVariables=true;if(this.getSourceText()==null){this.setSourceText($(this.contentDiv).html())}$(this.contentDiv).html(this.getSourceText());var d=$(this.contentDiv).find("p:contains('{')");for(var b=0;b<d.length;b++){var e=$(d[b]).text();captureGroups=e.match(/({)(\S*)(})/);if(captureGroups!=null&&captureGroups.length>2){var a=captureGroups[2];var f=getJetValue(a);if(f!=null&&f!=undefined){e=e.replace(/{.*}/,f);$(d[b]).html(e)}}}}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.OverlayComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="overlay";this.contentDiv.className="overlayContent";$(this.contentDiv).css("margin-top","50px");this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,originalOverlayContentParent:null,overlayContent:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.closeButton).css("z-index","20");$(this.div).append(this.contentDiv)},bindButton:function(){var b=this;var e=this.div;var a=this.closeButton;var d=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(e).hide();$(a).unbind("click");d.requestResumeNavigation();d.hideOverlay();$(b.contentDiv).html("")})},bindButtonForReparentedContent:function(d,a){var f=this.div;var b=this.closeButton;var e=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(a).append(d);$(f).hide();$(b).unbind("click");e.requestResumeNavigation();e.hideOverlay()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},attachNode:function(a){this.overlayContent=a.getHTMLContent();$(this.contentDiv).html(this.overlayContent);this.bindButton()},reparentNode:function(b,a){$(this.contentDiv).append(b);this.bindButtonForReparentedContent(b,a)},sendWarning:function(){var a="<p style='text-align: center;'><font face='Segoe UI'><br></font></p><p style='text-align: center;'><font face='Arial'>This type of page cannot be displayed as an overlay.</font></p>";$(this.contentDiv).html(a);this.bindButton()}},{});puremvc.define({name:"jet.view.component.PopupComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="popup";$(this.div).addClass("chip_light");$(this.div).attr("role","alert");$(this.div).css("overflow-y","scroll");$(this.div).css("max-height","500px");$(this.div).css("z-index","10000");$(this.contentDiv).attr("aria-activedescendant","popupContent");this.contentDiv.className="popupContent";$(this.contentDiv).addClass("chip_light");$(this.contentDiv).attr("id","popupContent");$(this.contentDiv).attr("aria-live","assertive");$(this.contentDiv).attr("role","alert");$(this.contentDiv).css("overflow-y","visible");$(this.contentDiv).attr("tabindex","0");this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";$(this.closeButton).css("position","absolute");$(this.closeButton).css("right","5px");$(this.closeButton).css("bottom","5px");$(this.closeButton).attr("alt","Press escape to close.");this.setParent($("body")[0]);$(this.div).css("border","2px solid black");$(this.div).css("border-radius","5px");$(this.div).css("box-shadow","10px 10px 5px #aaaaaa");$(this.div).css("width","33%");$(this.div).css("max-width","500px");$(this.div).css("top","33%");$(this.div).css("left","33%");$(this.contentDiv).css("outline","none");$(this.contentDiv).css("width","90%");$(this.contentDiv).css("padding","10px");$(this.contentDiv).css("background-color","#FFFFFF");$(this.closeButton).css("border","2px solid black");$(this.closeButton).css("border-radius","5px")}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show()}else{$(this.closeButton).unbind("click");$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);getOuterBackgroundColor(this.contentDiv);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show();$(this.contentDiv).focus()}else{$(this.div).hide()}},setContent:function(b){var a=this;$(this.contentDiv).html(b);getOuterBackgroundColor(this.contentDiv);this.bindButton();$(this.contentDiv).on("keydown",function(d){a.keyboardHandler(d,a)})},keyboardHandler:function(b,a){var d=b.keyCode;switch(d){case 27:$(a.closeButton).click();break}}},{});puremvc.define({name:"jet.view.component.RadioButtonComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");$(this.div).css("width","50px");$(this.div).css("height","50px");$(this.div).css("float","left");this.div.className="checkboxparent";this.contentDiv=document.createElement("input");this.contentDiv.className="checkbox";this.contentDiv.type="radio";this.contentDiv.name="radioGrp"}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){},setCheck:function(a){this.contentDiv.checked=a},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(e){e.stopPropagation();if(b.checked){d.setBranchingComponent(a)}d.handleEvent(jet.AppConstants.CHECKBOX,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).attr("disabled","disabled")},getUserInput:function(){if(this.contentDiv.checked==true){return"true"}else{return"false"}},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)}},{});puremvc.define({name:"jet.view.component.TextAreaComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("textarea");this.div.className="longAnswer";$(this.div).addClass("d_field")}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},enable:function(){var a=this.page;this.disable();$(this.div).removeAttr("disabled","disabled");$(this.div).bind("focus",function(){a.showCheckAnswerButton()})},disable:function(){$(this.div).unbind("focus");$(this.div).attr("disabled","disabled")},getUserInput:function(){var a=$.trim(this.div.value);var b=document.createTextNode(a);a=$(b).text();return a},setUserInput:function(a){$(this.div).val(a)}},{});puremvc.define({name:"jet.view.component.TooltipComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="tooltip";this.contentDiv.className="tooltipContent";this.closeButton=document.createElement("input");this.closeButton.type="button";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.contentDiv)},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},setContent:function(a){$(this.contentDiv).html(a)}},{});puremvc.define({name:"jet.view.component.TranscriptComponent",constructor:function(b){var a=this;this.mediator=b;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="popup";$(this.div).attr("role","alert");$(this.div).css("background-color","#fffff");$(this.contentDiv).attr("aria-activedescendant","popupContent");this.contentDiv.className="popupContent";$(this.contentDiv).attr("id","popupContent");$(this.contentDiv).attr("aria-live","assertive");$(this.contentDiv).attr("role","alert");$(this.contentDiv).css("background-color","#FFFFF");this.printButton=document.createElement("input");this.printButton.type="button";this.printButton.className="notesButton";$(this.printButton).css("position","absolute");$(this.printButton).val("Print");$(this.printButton).css("left","60px");$(this.printButton).css("width","50px");$(this.printButton).css("height","30px");$(this.printButton).css("margin-bottom","10px");$(this.printButton).css("margin-left","10px");$(this.printButton).click(function(){a.printNotes()});$(this.contentDiv).append(this.printButton);this.transcriptDiv=document.createElement("textarea");this.transcriptDiv.className="transcriptContent";this.transcriptDiv.type="text";$(this.transcriptDiv).attr("id","transcriptContent");$(this.transcriptDiv).attr("aria-live","assertive");$(this.transcriptDiv).attr("role","alert");$(this.transcriptDiv).css("position","absolute");$(this.transcriptDiv).css("top","60px");$(this.transcriptDiv).css("width","75%");$(this.transcriptDiv).css("height","80%");$(this.transcriptDiv).css("max-height","485px");$(this.transcriptDiv).css("border","none");$(this.transcriptDiv).css("padding-left","10px");$(this.transcriptDiv).css("resize","none");$(this.transcriptDiv).css("border-left","4px double rgba(238, 150, 122, .75)");$(this.transcriptDiv).css("background-color","#ffffff");$(this.transcriptDiv).css("color","#00000");$(this.contentDiv).append(this.transcriptDiv);this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,transcriptDiv:null,learnerName:"testUser",transcriptRecord:[],setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show().focus();this.getNotes();this.bindButton()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},saveNotes:function(){try{var b=JSON.stringify($(this.transcriptDiv).attr("value"));localStorage[window.location+"/"+this.learnerName+"/notes"]=b}catch(a){alert(a)}},printNotes:function(){try{var d=$(this.transcriptDiv).attr("value");d=this.processUserResponse(d);var a=window.open("","my div","height=400,width=600");a.document.write("<html><head><title>My Notes</title>");a.document.write("</head><body >");a.document.write(d);a.document.write("</body></html>");a.document.close();a.focus();a.print();a.close();return true}catch(b){alert(b)}},getNotes:function(){var d="";for(var a=0;a<this.transcriptRecord.length;a++){var b=this.transcriptRecord[a];d+="\n\nQUESTION: "+b.question;d+="\nRESPONSE: "+b.learnerResponse;d+="\nCORRECT RESPONSE: "+b.correctResponse;d+="\nFEEDBACK: "+b.feedBack;d+="\n------------------------------------------"}$(this.transcriptDiv).attr("value",d)},processUserResponse:function(d){var e=/\r\n|\n\r|\n|\r/g;var f=d.split(e);var b="";for(var a=0;a<f.length;a++){b+=f[a]+"<br>"}return b},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a)},getLearnerName:function(){if(LMSIsInitialized()==true){var a=doGetValue("cmi.learner_name");if(a!=null&&a!=undefined&&a.length>0){this.learnerName=a}}},recordActivity:function(a){this.transcriptRecord.push(a)}},{});puremvc.define({name:"jet.view.component.ViewerComponent",constructor:function(){var a=document.createElement("div");a.className="viewer";$(a).css("min-height","445px");$(a).attr("role","main");getJetWrapper().append(a)}},{handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}}},{});puremvc.define({name:"jet.view.gadget.Gadget",constructor:function(){this.div=document.createElement("div");this.div.className="gadget";var a=jet.ApplicationFacade.getIntance();this.setMediator(a.retrieveMediator(jet.view.mediator.DashboardMediator.NAME))}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},setParent:function(a,b){this.gadget=b;$(a).append(this.div)},removeFromParent:function(){$(this.div).remove()},setDataObject:function(a){},setPositioning:function(a){switch(a){case"static":$(this.div).removeAttr("style");$(this.div).css("position","static");break;case"absolute":$(this.div).removeAttr("style");$(this.div).css("position","absolute");break}},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.div!=null){$(this.div).css("opacity",a)}},setText:function(a){$(this.div).html(a);if(this.foregroundOpacity!=null){$(this.div).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.div).text()},getHTML:function(){return $(this.div).html()},getDiv:function(){return this.div},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.div).unbind("click");$(this.div).unbind("hover");$(this.div).unbind("mousedown");$(this.div).unbind("mouseout");$(this.div).attr("disabled","disabled")},enable:function(){},setMediator:function(a,b){this.mediators[a]=b},getMediator:function(a){return this.mediators[a]},setVisible:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}}},{TEXT_CHANGED:"textChanged",NAME:"Gadget"});puremvc.define({name:"jet.view.gadget.BarGraphGadget",parent:jet.view.gadget.Gadget,constructor:function(){this.div=document.createElement("div");$(this.div).addClass("bargraphgadget");$(this.div).attr("id","barGraph");$(".dashboard").append(this.div);var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);this.dashBoardMediator=a.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);this.dashBoardMediator.layoutDashboard()}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},dashBoardMediator:null,setDataObject:function(b){var d=null;var l=null;var a=null;var e=null;var k=null;var f=null;if(b.hasOwnProperty("data")){d=b.data}if(b.hasOwnProperty("ticks")){l=b.ticks}if(b.hasOwnProperty("minValue")){k=b.minValue}if(b.hasOwnProperty("maxValue")){f=b.maxValue}if(b.hasOwnProperty("seriesColors")){a=b.seriesColors}if(b.hasOwnProperty("series")){e=b.series}var m={seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{fillToZero:true}},seriesColors:a,series:e,legend:{show:false},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:l,},yaxis:{pad:1.05,min:k,max:f}}};var h=$.jqplot("barGraph",d,m);h.replot(d)},handleEvent:function(a){switch(a.type){}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.gadget.LegendGadget",parent:jet.view.gadget.Gadget,constructor:function(){this.div=document.createElement("div");$(this.div).addClass("legendgadget");$(this.div).attr("id","legendgadget");$(".dashboard").append(this.div);var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);this.dashBoardMediator=a.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);this.dashBoardMediator.layoutDashboard()}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},dashBoardMediator:null,setDataObject:function(b){$(this.div).empty();var e=null;var d=null;if(b.hasOwnProperty("data")){e=b.data}if(b.hasOwnProperty("seriesColors")){d=b.seriesColors}for(var a=0;a<e.length;a++){this.createLegendPart(e[a],this.div,d[a])}$(this.div).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:5})},createLegendPart:function(d,e,a){var b=document.createElement("div");b.className="legendGadgetPart";$(e).append(b);$(b).html(d+" <font color="+a+">&#x2588;</font>")},handleEvent:function(a){switch(a.type){}}},{TEXT_CHANGED:"textChanged",NAME:"LegendGadget"});puremvc.define({name:"jet.view.page.Node",parent:jet.view.component.ViewComponent,constructor:function(a){this.uid=a}},{uid:null,manualHide:false,mediators:{},setUID:function(a){this.uid=a},getUID:function(){return this.uid},setManualHide:function(a){this.manualHide=a},getManualHide:function(){return this.manualHide},setMediator:function(a,b){this.mediators[a]=b},getMediator:function(a){return this.mediators[a]},getHTMLContent:function(){},getContentAsResource:function(){var a="<p style='text-align: center;'><font face='Segoe UI'><br></font></p><p style='text-align: center;'><font face='Arial'>This type of page cannot be displayed as a resource.</font></p>";return a},getClonedContent:function(){},getReParentedContent:function(){},show:function(a){},postProcess:function(){},postCalcOptions:function(){},processNotification:function(a){},handleEvent:function(b,a){},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e}},{NAME:"Node"});puremvc.define({name:"jet.view.page.Page",parent:jet.view.page.Node,constructor:function(a){this.uid=a;this.branchOptions={uid:a}}},{myDiv:null,contentDiv:null,totalPoints:0,userPoints:0,backgroundColor:"",userFeedback:"",branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},calcOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},isUserCorrect:null,isInFlow:true,isLayer:false,alternativeContent:"No alternative content for this page.",show:function(a){},buildComponent:function(d,b,a,e){},hideComponents:function(b){for(var a=0;a<b.length;a++){b[a].show(false)}},showComponents:function(b){for(var a=0;a<b.length;a++){b[a].show(true)}},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setCalcOptions:function(a){this.calcOptions=a},getCalcOptions:function(){return this.calcOptions},setBranchingComponent:function(a){},setTotalPoints:function(a){this.totalPoints=a},getTotalPoints:function(){return this.totalPoints},setUserPoints:function(a){this.userPoints=a},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(a){this.backgroundColor=a},setUserFeedback:function(a){this.userFeedback=a},enableInteractivity:function(){},disableInteractivity:function(){},getUserPoints:function(){return Math.max(0,this.userPoints)},getUserFeedback:function(){return this.userFeedback},getTag:function(a){var b=this.getProperty(a,"tag");if(b!=null&&b!=undefined){return b.tag}return null},getDOMParent:function(){return $(this.myDiv).parent()},getDiv:function(){return this.myDiv},getContentDiv:function(){return this.contentDiv},setDiv:function(a){this.myDiv=a},getIsUserCorrect:function(){return this.isUserCorrect},setIsUserCorrect:function(a){this.isUserCorrect=a},handleEvent:function(b,a){},getName:function(){return"Page"},clearFeedback:function(){},clearBranchOptions:function(){},processNotification:function(b,a){},setInFlow:function(a){this.isInFlow=a},getInFlow:function(){return this.isInFlow},setIsLayer:function(a){this.isLayer=a},getIsLayer:function(){return this.isLayer},isPageLevelBranchOption:function(a){if(a==null||a==undefined){return false}if(a.checkedOption!=null&&a.checkedOption!=""&&a.checkedOption!="No Action"){return true}if(a.showFeedback!=null&&a.showFeedback!=""&&a.showFeedback!="false"){return true}return false},setAlternativeContent:function(a){this.alternativeContent=a},getAlternativeContent:function(){return this.alternativeContent},},{NAME:"Page"});puremvc.define({name:"jet.view.page.CategoriesPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("CategoriesPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.dragComponents=[];this.anchorComponents=[];this.randomNumbers=[];this.answerKeys=[];this.feedBackComponents=[]}},{tempXPos:0,tempYPos:0,originalAnchorTilePositions:[],originalDragTilePositions:[],answerKeys:null,feedBackComponents:null,components:null,userInputComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,isUserCorrect:null,questionStem:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,f,d,m,l){switch(f){case jet.AppConstants.AUDIO:if(m.length<1){return}var h=new jet.view.component.HTMLAudioComponent;h.setMediaURL(m);h.setAudioOptions(l);h.setParent(b.contentDiv);h.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,d);this.components.push(h);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(m);break}var n=b.getTag(d);var h;if(n=="totalpoints"){b.setTotalPoints(m)}else{if(n=="flowstatus"){if(m=="true"){b.setInFlow("false")}}else{if(f==jet.AppConstants.NODES_MANAGER){b.branchOptions=l;if(n=="checkedNodeOptions"){b.checkedBranchOptions=l}if(n=="uncheckedNodeOptions"){b.unCheckedBranchOptions=l}}else{if(f==jet.AppConstants.TEXT&&m.length>0){var k=getProperty(d,"tag");if(k!=null){if(k.tag=="instructions"){h=this.createComponent(b,d,m);this.setQuestionStem(m)}if(k.tag.indexOf("draggable_a")>-1){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");h=this.createComponent(b,d,m);h.addClass("dragTile");this.dragComponents.push(h);var e=parseInt(this.getProperty(d,"player_y").player_y,10);this.originalDragTilePositions.push(e);h.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}if(k.tag.indexOf("draggable_b")>-1){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");h=this.createComponent(b,d,m);h.addClass("dragTile");this.dragComponents.push(h);var e=parseInt(this.getProperty(d,"player_y").player_y,10);this.originalDragTilePositions.push(e);h.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}else{if(k.tag=="anchored"){h=this.createComponent(b,d,m);h.addClass("categoryTitle");this.anchorComponents.push(h)}}}}}}}},postProcess:function(){$(this.myDiv).attr("id",this.uid)},createComponent:function(d,b,e){var a=new jet.view.component.AnchorTileComponent;a.setParent(d.myDiv);a.setProperties(b);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(e);return a},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].enableDraggable();this.dragComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].disableDraggable();this.dragComponents[a].disable()}},evaluateUserActivity:function(){this.disableInteractivity();var f="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var h=this.getTotalPoints()/this.dragComponents.length;for(var d=0;d<this.dragComponents.length;d++){var e=this.getProperty(this.dragComponents[d].getProperties(),"tag").tag=="draggable_a"?0:1;var b=this.anchorComponents[e];if(this.dragComponents[d].getX()!=this.anchorComponents[e].getX()){f="\u2718";this.setIsUserCorrect(false);var a=parseInt((this.getUserPoints()-h)*10)/10;this.setUserPoints(a);this.addFeedback(this.dragComponents[d],false)}else{this.addFeedback(this.dragComponents[d],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return f},getBranchOptions:function(){return this.branchOptions},processComponents:function(){for(var b=0;b<this.dragComponents.length;b++){this.randomNumbers.push(b)}this.shuffle(this.randomNumbers);if(this.dragComponents.length<=0){return}var h=this.dragComponents[0].getHeight();for(var b=0;b<this.dragComponents.length;b++){var e=this.randomNumbers[b];var a=this.dragComponents[e];var d=parseInt($(".viewer").css("width"));var f=480;a.setX(f);a.setInitialX(f);a.setY(30);a.setInitialY(b*h);a.setZindex(10+b)}},shuffle:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},dragStart:function(a){},dragStop:function(l,n){this.showCheckAnswerButton();var m=parseInt($(l).css("left"),10);var k=parseInt($(l).css("top"),10);for(var h=0,d=10000,s=0;h<this.anchorComponents.length;h++){var f=Math.abs(m-this.anchorComponents[h].getX());if(f<d){d=f;s=h}}var b=this.anchorComponents[s];var o=this.dragComponents[n];var q=parseInt(b.getX(),10);var p=parseInt(o.getY(),10);var r=Math.abs(q-o.getX());if(r<o.getWidth()){for(var h=0,a=10000,s=0;h<this.originalDragTilePositions.length;h++){var e=Math.abs(k-this.originalDragTilePositions[h]);if(e<a){a=e;s=h}p=parseInt(this.originalDragTilePositions[s],10)}o.setX(q);o.setY(p)}else{o.animatePosition(o.getInitialX(),o.getInitialY(),1000)}},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("z-index","1");$(b).css("top",d.getY());$(b).css("left",d.getX()-13);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},},{NAME:"CategoriesPage"});puremvc.define({name:"jet.view.page.ChallengerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="challengerPage";$(this.myDiv).addClass("page");$(this.myDiv).css("padding","10px");$(this.myDiv).addClass("chip_background");$(this.myDiv).addClass("d_panel");this.myDiv.id=a;this.instructionsDiv=document.createElement("div");this.instructionsDiv.className="chip_instructions";$(this.instructionsDiv).css("width","75%");$(this.instructionsDiv).css("padding","10px");$(this.instructionsDiv).css("margin-left","10%");$(this.instructionsDiv).css("margin-right","10%");$(this.instructionsDiv).css("margin-bottom","20px");$(this.myDiv).append(this.instructionsDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="challengerContent";$(this.contentDiv).css("display","flex");$(this.contentDiv).css("flex-wrap","wrap");$(this.contentDiv).addClass("chip_background");$(this.contentDiv).css("min-height","300px");$(this.contentDiv).css("max-height","430px");$(this.contentDiv).css("overflow-y","auto");this.spacer=document.createElement("div");this.spacer.className="spacer";$(this.spacer).css("width","90%");$(this.spacer).css("order","-1");$(this.spacer).css("display","none");$(this.contentDiv).append(this.spacer);$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.categoryArray=[];this.categoryButtonArray=[];this.tileArray=[];this.tileDivArray=[];this.stateMap={};this.feedback=""}},{rowHeight:40,initialLeft:700,mediator:null,xml:null,uid:null,components:null,categoryArray:null,categoryButtonArray:null,tileArray:null,tileDivArray:null,stateMap:null,spacer:null,feedback:null,primaryState:"",backgroundTile:null,instructionsDiv:null,branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},show:function(a){if(a){$(this.myDiv).show();this.getMediator(jet.view.mediator.PageMediator.NAME).reportUserActivity(this,this.uid)}else{$(this.myDiv).hide()}},showCheckAnswerButton:function(){this.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()},buildComponent:function(f,d,a,h,b){if(d==jet.AppConstants.DATA_INPUT&&h.length>0){var e=f.processXML(h);this.xml=h}if(d==jet.AppConstants.TEXT&&h.length>0){var k=f.getTag(a);if(k=="totalpoints"){f.setTotalPoints(h)}if(k=="instructions"){$(this.instructionsDiv).text(h);$(this.instructionsDiv).css("color","black")}}if(d==jet.AppConstants.IMAGE){this.backgroundTile=h;$(this.myDiv).css("background-image","url(base/"+h+")")}if(d==jet.AppConstants.ACCESSIBILITY_TEXT&&h.length>0){this.setAlternativeContent(h)}},processXML:function(m){this.xml=m;xmlDoc=$.parseXML(m);var l=$(xmlDoc).find("dataPage");for(var k=0;k<l.length;k++){var e=l[k];var o=$(e).find("uid")[0].textContent.trim();var r=$(e).find("Title")[0].textContent.trim();var b=$(e).find("Category")[0].textContent.trim();var a=$(e).find("Random_State")[0].textContent.trim();var t=$(e).find("Dependency_On")[0].textContent.trim();var s=$(e).find("Points")[0].textContent.trim();var h=$(e).find("Correct_Response")[0].textContent.trim();var f=$(e).find("Resource")[0].textContent.trim();var q=$(e).find("Feedback_A")[0].textContent.trim();var n=$(e).find("Feedback_B")[0].textContent.trim();if($(e).find("Optional_Image")[0]!=null&&$(e).find("Optional_Image")[0].textContent!=null){var d=$(e).find("Optional_Image")[0].textContent.trim()}var p={UID:o,Title:r,Category:b,Random_State:a,Dependency_On:t,Points:s,Correct_Response:h,Resource:f,Feedback_If_Selected:q,Feedback_If_Omitted:n,Selected:false,Optional_Image:d,Div:null};this.tileArray.push(p);this.addToCategories(b);this.addToStateMap(p)}this.createCategories();this.createTiles();this.randomizeStates();this.primaryState=this.getPrimaryState()},getTilesDiv:function(){return this.tilesDiv},getDropDiv:function(){return this.dropDiv},createCategories:function(){var d=this;var f=null;for(var a=0;a<this.categoryArray.length;a++){var b=this.categoryArray[a];var e=document.createElement("button");$(e).data("data-selected",false);this.categoryButtonArray.push(e);$(e).on("click",function(){d.categoryButtonHandler(this,d)});$(this.contentDiv).append(e);$(e).html(b);$(e).data("data-category",b);$(e).height(40);$(e).css("order","-2");$(e).css("width","200px");$(e).css("min-width","200px");$(e).css("margin","10px");$(e).css("border","1px solid black");$(e).css("border-radius","10px");$(e).css("background-color","#4d4d4d");$(e).addClass("chip_medium");$(e).addClass("d_header");$(e).css("color","white");f=e}},categoryButtonHandler:function(f,l){$(f).data("data-selected",true);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_REMOVE_ALL_RESOURCES);$(l.contentDiv).find("button").css("background-color","#4d4d4d");$(l.contentDiv).find(".chip_dark").addClass("chip_medium");$(l.contentDiv).find(".chip_dark").removeClass("chip_dark");$(f).css("background-color","#000000");$(f).removeClass("chip_medium");$(f).addClass("chip_dark");$(".ChallengerTileDiv").css("display","none");var k=$(f).data("data-category");var a=false;for(var e=0;e<l.tileArray.length;e++){var h=l.tileArray[e];if(h.Category==k&&h.Random_State=="Yes"&&h.Selected==true){$(h.Div).css("order","-1");$(h.Div).css("display","");$(h.Div).css("width","90%");$(h.Div).css("text-align","center");$(h.Div).css("margin-top","50px");$(h.Div).addClass("chip_light");$(h.Div).css("color","black");a=true;this.showResource(h)}}if(a==false){$(l.spacer).css("display","")}else{$(l.spacer).css("display","none")}for(var e=0;e<l.tileArray.length;e++){var d=l.tileArray[e];if(d.Category==k&&d.Random_State!="Yes"){$(d.Div).css("display","");$(d.Div).addClass("chip_extralight");this.showResource(d)}}var b=true;for(var e=0;e<this.categoryButtonArray.length;e++){if($(this.categoryButtonArray[e]).data("data-selected")!=true){b=false}}if(b){this.showCheckAnswerButton()}},showResource:function(a){if(a.Resource!=""){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_ADD_RESOURCE,a.Resource)}},checkboxHandler:function(b,a){var d=$(a).parent().find("img");if(d!=null){if($(a).prop("checked")!=false){$(d).css("border","5px solid lightgreen")}else{$(d).css("border","5px solid white")}}},createTiles:function(){var h=this;var f=this.getMediator(jet.view.mediator.PageMediator.NAME);for(var d=0;d<this.tileArray.length;d++){var l=this.tileArray[d];var b=document.createElement("div");this.tileDivArray.push(b);$(this.contentDiv).append(b);$(b).width(300);$(b).css("display","none");$(b).css("margin","20px");$(b).css("padding","10px");$(b).css("font-family","Arial");$(b).css("border","2px solid gray");$(b).data("Title",l.Title);$(b).addClass("ChallengerTileDiv");if(l.Random_State!="Yes"){var e=document.createElement("input");$(e).attr("id","checkbox_"+d);$(e).attr("type","checkbox");var a=document.createElement("label");$(a).attr("for","checkbox_"+d);$(a).html(l.Title);$(a).css("margin-left","20px");$(b).append(e);$(b).append(a);$(e).on("change",function(){h.checkboxHandler(h,this)});if(l.Optional_Image!=""){var k=document.createElement("img");$(k).attr("src","base/"+l.Optional_Image);$(k).css("float","right");$(k).css("margin","20px");$(k).css("outline","1px solid black");$(k).addClass("d_image");$(k).on("click",function(){h.clickCheckBox(this)});$(b).append(k)}}else{$(b).html(l.Title);if(l.Optional_Image!=""){var k=document.createElement("img");$(k).attr("src","base/"+l.Optional_Image);$(k).css("float","right");$(k).css("margin","20px");$(k).css("outline","1px solid black");$(k).css("border","5px solid white");$(b).append(k)}}l.Div=b}},clickCheckBox:function(a){$(a).parent().find("input").click()},evaluateUserActivity:function(){var b="";this.disableInteractivity();var e="";var a=this.calculateUserScore();var d=this.calculateTotalScore();this.provideFeedback(a,d);var f=a/d*this.getTotalPoints();this.setUserPoints(f)},calculateUserScore:function(){var m=0;this.feedback="";for(var f=0;f<this.tileArray.length;f++){var a=false;var e={uid:"",questionType:"Challenger",question:this.primaryState,learnerResponse:"",correctResponse:"undisclosed",feedBack:"",result:""};var h=this.tileArray[f];if(h.Random_State=="Yes"){continue}var d=this.getChecked(h.Div);var l=this.getCorrectState(h.Correct_Response);if(d&&l==1){var b="You correctly selected '"+h.Title+"'. ";this.feedback+=b+"<br>";e.learnerResponse=h.Title;e.correctResponse=h.Title;e.feedBack=b.replace("<br>","");a=true;if(!isNaN(h.Points)){var k=Number(h.Points);m+=k}}else{if(d&&l==2){b="You incorrectly selected '"+h.Title+"'. ";this.feedback+=b+"<br>";if(!isNaN(h.Points)){var k=Number(h.Points);m-=k}e.learnerResponse=h.Title;e.feedBack=b.replace("<br>","");a=true}else{if(!d&&l==2){b="You correctly omitted '"+h.Title+"'. ";b+=h.Feedback_If_Selected+"<br>";e.learnerResponse=h.Title;e.feedBack=b.replace("<br>","");a=true}else{if(!d&&l==1){b="You incorrectly omitted '"+h.Title+"'. ";b+=h.Feedback_If_Selected+"<br>";this.feedback+=b+"<br>";if(!isNaN(h.Points)){var k=Number(h.Points);m-=k}e.learnerResponse=h.Title;e.feedBack=b.replace("<br>","");a=true}else{if(d&&this.isDependenciesSelected(h)){var b="You correctly selected '"+h.Title+"'. ";this.feedback+=b+"<br>";e.learnerResponse=h.Title;e.correctResponse=h.Title;e.feedBack=b.replace("<br>","");a=true;if(!isNaN(h.Points)){var k=Number(h.Points);m+=k}}else{if(d&&!this.isDependenciesSelected(h)){var b="";if(!this.isRandomStateDependenciesSelected(h)){b="You incorrectly selected '"+h.Title+"'. ";b+=h.Feedback_If_Selected+"<br>";if(!isNaN(h.Points)){var k=Number(h.Points);m-=k}}else{b="'"+h.Title+"' is missing something important. ";if(!isNaN(h.Points)){var k=Number(h.Points);m-=k}}this.feedback+=b+"<br>";e.learnerResponse=h.Title;e.feedBack=b.replace("<br>","");a=true}else{if(!d&&this.isDependenciesSelected(h)){var b="You incorrectly omitted '"+h.Title+"'. ";b+=h.Feedback_If_Omitted+"<br>";this.feedback+=b+"<br>";e.learnerResponse="unselected";e.correctResponse=h.Title;e.feedBack=b.replace("<br>","");a=true}}}}}}}if(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,e)}}return Math.max(m,0)},isDependenciesSelected:function(e){var h=true;var a=e.Dependency_On.split(";");for(var d in a){var b=a[d];if(b==""||b=="None"){continue}var e=this.findTile(b);if(e==null||typeof e=="undefined"){h=false;continue}var f=e.Selected||this.getChecked(e.Div);if(!f){h=false}}return h},isRandomStateDependenciesSelected:function(h){var k=true;var a=h.Dependency_On.split(";");for(var f in a){var e=a[f];if(e==""||e=="None"){continue}var b=this.findTile(e);if(b==null||typeof b=="undefined"||b.Random_State!="Yes"){continue}var d=b.Selected;if(!d){k=false}}return k},getPrimaryState:function(){var d="unknown";for(var a=0;a<this.tileArray.length;a++){var b=this.tileArray[a];if(b.Random_State=="Yes"&&b.Selected){return b.Title}}return d},calculateTotalScore:function(){var b=0;for(var a=0;a<this.tileArray.length;a++){var e=this.tileArray[a];if(e.Random_State=="Yes"){continue}if(e.Correct_Response=="Never Correct"){continue}if(this.isPathSelected(e)){if(!isNaN(e.Points)){var d=Number(e.Points);b+=d}}}return b},isPathSelected:function(f){var h=true;var a=f.Dependency_On.split(";");for(var e in a){var d=a[e];if(d==""||d=="None"){continue}var b=this.findTile(d);if(b!=null&&typeof b!="undefined"){if(b.Random_State=="Yes"&&!b.Selected){return false}else{this.isPathSelected(b)}}}return h},provideFeedback:function(b,d){var a="You achieved "+b+"/"+d+". <br><br>";a+=this.feedback;a=a.replace(new RegExp(",$"),".");jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,a)},getChecked:function(a){var b=$(a).find("input").prop("checked");return b},getCorrectState:function(a){if(a.toUpperCase()=="ALWAYS CORRECT"){return 1}if(a.toUpperCase()=="NEVER CORRECT"){return 2}if(a.toUpperCase()=="CORRECT IF DEPENDENCY EXISTS"){return 3}return 4},getUIDFromString:function(d){var a="";var b=/.*\(ID:(.*)\)/g;match=b.exec(d);if(match!=null&&match.length>1){a=match[1];return a}return"-9999"},findTile:function(e){var b=this.getUIDFromString(e);for(var a in this.tileArray){var d=this.tileArray[a];if(d.UID==b){return d}}for(var a in this.tileArray){var d=this.tileArray[a];if(d.Title==e){return d}}return null},enableInteractivity:function(){for(var d=0;d<this.tileArray.length;d++){var b=this.tileArray[d].Div;var a=$(b).find("input");if(a!=null){$(a).attr("disabled",false)}}},disableInteractivity:function(){for(var d=0;d<this.tileArray.length;d++){var b=this.tileArray[d].Div;var a=$(b).find("input");if(a!=null){$(a).attr("disabled",true)}}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},postProcess:function(){},addToCategories:function(b){if($.trim(b)==""){return}for(var a=0;a<this.categoryArray.length;a++){var d=this.categoryArray[a];if(b==d){return}}this.categoryArray.push(b)},addToStateMap:function(a){if(a.Random_State.toUpperCase()!="YES"){return}var b=a.Category;if(this.stateMap[b]==null){this.stateMap[b]=new Array();this.stateMap[b].push(a)}else{this.stateMap[b].push(a)}},checkDependencies:function(f){var h=f.Dependency_On;var a=h.split(";");if(a[0]==""&&a.length<2){return true}for(var e=0;e<a.length;e++){var d=a[e];var b=this.isTileSelected(d);if(b){return true}}return false},produceDependencyFeedback:function(f){var b="";var h=f.Dependency_On;var a=h.split(";");if(a[0]==""||a[0]=="None"){return b}else{b="which has been correctly associated with "}for(var e=0;e<a.length;e++){var d=a[e];b+=d+","}b=b.replace(new RegExp(",$"),".");return b},isTileSelected:function(a){var d=this.getUIDFromString(a);for(var b=0;b<this.tileArray.length;b++){var e=this.tileArray[b];if(e.UID==d&&e.Selected==true){return true}}return false},randomizeStates:function(){for(var d in this.stateMap){var b=this.stateMap[d];b=this.pickValidStates(b);this.jumble(b);var a=b[0];if(typeof a=="undefined"){continue}a.Selected=true;$(a.Div).css("color","white")}},pickValidStates:function(a){var d=new Array();for(var b=0;b<a.length;b++){var e=a[b];var f=this.checkDependencies(e);if(f){d.push(e)}}return d},jumble:function(a){for(var d=a.length-1;d>0;d--){var b=a[d];var f=Math.floor(Math.random()*(d+1));var e=a[f];a[f]=b;a[d]=e}}},{NAME:"ChallengerPage"});puremvc.define({name:"jet.view.page.CrosswordPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("CrosswordPage");$(this.myDiv).css("padding","5px");$(this.myDiv).addClass("chip_light");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.crosswordDiv=document.createElement("div");$(this.contentDiv).append(this.crosswordDiv);this.crosswordDiv.id="crosswordDiv";this.acrossHintsDiv=document.createElement("div");$(this.contentDiv).append(this.acrossHintsDiv);this.acrossHintsDiv.id="acrossHintsDiv";this.acrossHintsDiv.className="hintsDiv";$(this.acrossHintsDiv).css("width","40%");$(this.acrossHintsDiv).css("visibility","hidden");this.downHintsDiv=document.createElement("div");$(this.contentDiv).append(this.downHintsDiv);this.downHintsDiv.id="downHintsDiv";this.downHintsDiv.className="hintsDiv";$(this.downHintsDiv).css("width","40%");$(this.downHintsDiv).css("visibility","hidden");this.directionDiv=document.createElement("div");$(this.contentDiv).append(this.directionDiv);this.directionDiv.id="directionDiv";this.directionDiv.className="directionDiv";$(this.directionDiv).html("&#x21E8");this.hintFieldDiv=document.createElement("div");$(this.crosswordDiv).after(this.hintFieldDiv);this.hintFieldDiv.id="hintFieldDiv";$(this.hintFieldDiv).width("80%");$(this.hintFieldDiv).height("100px");$(this.hintFieldDiv).css("word-wrap","break-word");$(this.hintFieldDiv).css("background","transparent");$(this.hintFieldDiv).css("color","black");$(this.hintFieldDiv).css("padding","10px");$(this.hintFieldDiv).css("margin","5px");$(this.hintFieldDiv).css("text-align","center");$(this.hintFieldDiv).css("clear","both");$(this.hintFieldDiv).text("Click on numbered squares for hints.");$(this.hintFieldDiv).addClass("chip_instructions");$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.puzzle={row:[]};this.clues={across:[],down:[]};this.crosswordObjects=[]}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,NA:"_NA_",EMPTYCELL:"_",currentCellColor:"#FFFF33",normalCellColor:"#FFFFFF",currentCell:"#C0302",currentRow:"3",currentColumn:"2",direction:"across",determineDirectionFlag:true,numberOfNormalRows:11,numberOfOrphansAllowed:4,numberOfRows:15,numberOfColumns:"20",cellSize:"35",margin:"1",hintNumber:0,LEFT:37,RIGHT:39,UP:38,DOWN:40,ACROSS_DIRECTION:"across",DOWN_DIRECTION:"down",crosswordDiv:null,hintFieldDiv:null,acrossHintsDiv:null,downHintsDiv:null,directionDiv:null,acrossSelect:null,downSelect:null,puzzle:null,clues:null,xml:null,crosswordObjects:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,k,e){switch(f){case jet.AppConstants.NODES_MANAGER:var l=h.getTag(d);if(l=="checkedNodeOptions"){h.checkedBranchOptions=e}if(l=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.CROSSWORD:this.processXML(k,this.puzzle,this.clues);this.makeCrossword();this.makeHints();break;case jet.AppConstants.TEXT:var l=h.getTag(d);if(l=="totalpoints"){h.setTotalPoints(k)}break;case jet.AppConstants.CHECKBOX:var l=h.getTag(d);if(l=="hideAnswer"){h.setHideAnswer(k)}else{if(l=="flowstatus"){if(k=="true"){h.setInFlow("false")}}else{if(l=="randomstatus"){if(k=="true"){h.setRandomStatus("true")}}else{var b=new jet.view.component.CheckBoxComponent;b.setParent(h.contentDiv,this);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);this.answerKeys.push($.trim(k));this.userInputComponents.push(b);b.setIndexInArray(this.userInputComponents.length-1);b.addContentClass(l);var a=document.createElement("div");a.className="feedback";this.feedBackComponents.push(a)}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(k);break;case jet.AppConstants.AUDIO:if(k.length<1){return}this.audioComponent=new jet.view.component.HTMLAudioComponent;this.audioComponent.setMediaURL(k);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},evaluateCrossWord:function(){var l=this.getUserPoints();var b=$(this.crosswordDiv).find(".puzzleInput");var a=b.length;var f=a;for(var e=0;e<b.length;e++){var d=b[e];var h=$(d).data("answer").toUpperCase();var k=$(d).val().toUpperCase();if(h==k){$(d).css("background-color","#5DFC0A")}else{--f;$(d).css("background-color","#FF0000");$(d).val("\u2718");this.setIsUserCorrect(false)}}this.setUserPoints(Math.ceil(f/a*l))},evaluateUserActivity:function(){var a="";this.disableInteractivity();var b="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());this.evaluateCrossWord();if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){a=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){a=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=a}return this.getHideAnswer()=="false"?b:"Sent"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},processXML:function(l,s,m){xmlDoc=$.parseXML(l);var u=$(xmlDoc).find("crosswords");var p=u.attr("rowCount");var o=u.attr("colCount");if(p>0&&o>0){this.numberOfColumns=Number(o);this.numberOfNormalRows=Number(p)}this.initPuzzle(s);var n=$(xmlDoc).find("crossword");for(var k=0;k<n.length;k++){var q=n[k];var b=$(q).find("word")[0].textContent.trim();var d=$(q).find("orientation")[0].textContent;var f=1*$(q).find("column")[0].textContent;var t=1*$(q).find("row")[0].textContent;var h=$(q).find("hint")[0].textContent.trim();var r={word:b,orientation:d,row:t,column:f,hint:h,hintNumber:""};this.crosswordObjects.push(r);this.placeInPuzzle(b,d,f,t,s);this.placeInHints(h,b,d,f,t,m)}var e=$(xmlDoc).find("orphan");var a=this.numberOfNormalRows+Number(1);for(var k=0;k<e.length&&k<this.numberOfOrphansAllowed;k++){var q=e[k];var b=$(q).find("word")[0].textContent.trim();if(b.length<=this.numberOfColumns){var d="horiz";var f=0;var t=a++;var h=$(q).find("hint")[0].textContent.trim();var r={word:b,orientation:d,row:t,column:f,hint:h,hintNumber:""};this.crosswordObjects.push(r);this.placeInPuzzle(b,d,f,t,s);this.placeInHints(h,b,d,f,t,m)}}},initPuzzle:function(b){for(var a=0;a<this.numberOfRows+this.numberOfOrphansAllowed;a++){this.puzzle.row.push("___________________________________________________________________")}},placeInPuzzle:function(a,b,d,n,l){switch(b){case"horiz":var h=l.row[n];var f=h.substring(0,d);var m=h.substring(d+a.length,h.length);h=f+a+m;l.row[n]=h;break;case"vert":var k=0;for(var e=n;e<n+a.length;e++){var h=l.row[e];var f=h.substring(0,d);var m=d<h.length-1?h.substring(d+1,h.length):"";h=f+a.substring(k,k+1)+m;k++;l.row[e]=h}}},placeInHints:function(h,e,a,b,f,d){switch(a){case"horiz":var h={no:b,text:h,word:e,row:f,column:b};d.across.push(h);break;case"vert":var h={no:f,text:h,word:e,row:f,column:b};d.down.push(h);break}},getCellID:function(b,a){return"input_"+this.uid+"_"+(b*1000+a)},getAnswer:function(b,a){return $("#"+this.getCellID(b,a)).data("answer")},makeCrossword:function(){$(this.crosswordDiv).width(this.numberOfColumns*this.cellSize*this.margin+5);$(this.crosswordDiv).height(this.numberOfRows*this.cellSize*this.margin+5);_number=1;for(rowIndex=0;rowIndex<this.numberOfRows;rowIndex++){for(cIndex=0;cIndex<this.numberOfColumns;cIndex++){var a=document.createElement("div");$(a).addClass("square");$(a).width(this.cellSize+"px");$(a).height(this.cellSize+"px");$(a).css("position","absolute");$(a).css("top",rowIndex*(this.margin*this.cellSize)+"px");$(a).css("left",cIndex*(this.margin*this.cellSize)+"px");c=this.puzzle.row[rowIndex].substring(cIndex,cIndex+1);this.differentiateCell(a,c);$(this.crosswordDiv).append(a)}}},makeHints:function(){this.sortHints(this.clues.across);this.sortHints(this.clues.down);this.initHints(this.acrossHintsDiv,this.clues.across,this.ACROSS_DIRECTION);this.initHints(this.downHintsDiv,this.clues.down,this.DOWN_DIRECTION);var a=this;$(this.acrossSelect).change(function(b){a.hintClick(b,"across",a)});$(this.downSelect).change(function(b){a.hintClick(b,"down",a)})},sortHints:function(e){var b=false;while(!b){b=true;for(var d=0;d<e.length;d++){if(d<e.length-1){var a=e[d];if(a.row>e[d+1].row){e[d]=e[d+1];e[d+1]=a;b=false}}}}b=false;while(!b){b=true;for(var d=0;d<e.length;d++){if(d<e.length-1){var a=e[d];if(a.row==e[d+1].row){if(a.column>e[d+1].column){e[d]=e[d+1];e[d+1]=a;b=false}}}}}},differentiateCell:function(e,h){var k=this;if(h==this.EMPTYCELL){$(e).attr("class","emptySquare")}else{var l=document.createElement("input");var a=this.getCellID(rowIndex,cIndex);l.type="text";l.maxLength=1;l.id=a;$(l).addClass("puzzleInput");$(l).css("font-size","12pt");$(l).css("line-height","10pt");$(l).css("padding","0 0 2.5pt 5.5pt");$(l).css("box-shadow","5px 5px 5px #aaaaaa");$(l).width(this.cellSize*0.95+"px");$(l).height(this.cellSize*0.95+"px");$(l).data("answer",h);$(l).data("row",rowIndex);$(l).data("col",cIndex);var d=[{word:""},{word:""}];if(this.isInitial(rowIndex,cIndex,d)){$(l).css("background-color","#c7c7ff");$(l).data("hintNumber",++this.hintNumber);this.assignHintNumberToCrosswordObject(d,this.hintNumber);var f=document.createElement("div");$(f).addClass("hintNumber");$(f).css("width",this.cellSize/3);$(f).css("height",this.cellSize/3);$(f).css("left",2);$(f).css("top",2);$(f).css("position","absolute");$(f).css("font-size","6pt");$(f).html(this.hintNumber);$(e).append(f)}var m=this.EMPTYCELL;var b=this.EMPTYCELL;if(cIndex>0){m=this.puzzle.row[rowIndex].substring(cIndex-1,cIndex)}if(cIndex<this.puzzle.row.length-1){b=this.puzzle.row[rowIndex].substring(cIndex+1,cIndex+2)}if(m!=this.EMPTYCELL||b!=this.EMPTYCELL){$(l).data("orientation","horiz")}else{$(l).data("orientation","vert")}$(l).click(function(n){k.inputClick(n,true);k.showCheckAnswerButton()});$(l).bind("keyup",function(n){});$(l).bind("keydown",function(n){k.keyDownHandler(n)});$(l).bind("keypress",function(n){k.keyPressHandler(n)});$(e).append(l);this.normalCellColor=$(e).css("background-color")}},isInitial:function(h,f,e){var b=0;var a=false;for(var d=0;d<this.crosswordObjects.length;d++){if(h==this.crosswordObjects[d].row&&f==this.crosswordObjects[d].column){e[b++].word=this.crosswordObjects[d].word;a=true}}return a},assignHintNumberToCrosswordObject:function(b,d){for(var a=0;a<b.length;a++){if(this.getCrossWordObject(b[a].word)!=null){this.getCrossWordObject(b[a].word).hintNumber=d}}return},getCrossWordObject:function(b){for(var a=0;a<this.crosswordObjects.length;a++){if(b==this.crosswordObjects[a].word){return this.crosswordObjects[a]}}return null},keyDownHandler:function(b){if(b.which==this.LEFT||b.which==this.RIGHT||b.which==this.UP||b.which==this.DOWN){this.move(b.which);var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));var d=a.attr("id");this.moveToCell("#"+d,false);b.preventDefault();return}},keyPressHandler:function(d){d.preventDefault();if(d.currentTarget.tagName!="INPUT"){return}if(d.which==this.LEFT||d.which==this.RIGHT||d.which==this.UP||d.which==this.DOWN){return}this.clearCurrentCell();var a=d.which||d.keyCode;var b=String.fromCharCode(a);$(d.currentTarget).val(b);this.keyUpHandler(d)},keyUpHandler:function(b){if(b.currentTarget.tagName!="INPUT"){return}if(b.which==this.LEFT||b.which==this.RIGHT||b.which==this.UP||b.which==this.DOWN){this.move(b.which);var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));var d=a.attr("id");this.moveToCell("#"+d,false);return}if(this.direction==this.ACROSS_DIRECTION){this.move(this.RIGHT)}else{this.move(this.DOWN)}var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));this.determineDirectionFlag=false;a.click()},inputClick:function(b,a){if(this.determineDirectionFlag==false){this.determineDirectionFlag=true;this.moveToCell("#"+b.currentTarget.id,false)}else{this.moveToCell("#"+b.currentTarget.id,true)}this.getHint(this.currentRow,this.currentColumn)},clearCurrentCell:function(){$(this.currentCell).val("")},hintClick:function(d,a,f){this.determineDirectionFlag=false;$("#acrossSelect").blur();$("#downSelect").blur();f.setDirection(a);clueIndex=d.target.selectedIndex;var h=this.clues[a][clueIndex].word;var b=this.getCrossWordObject(h);var e=b.hintNumber;var k=b.hint;$(this.hintFieldDiv).text(a+": "+k);for(rowIndex=0;rowIndex<this.numberOfRows;rowIndex++){for(cIndex=0;cIndex<this.numberOfColumns;cIndex++){var l="#"+this.getCellID(rowIndex,cIndex);if($(l).data("hintNumber")==e){$(l).click();break}}}this.resetCells();this.highlightCells(b.row,b.column,b.word,a,true)},resetCells:function(){for(var d=0;d<this.crosswordObjects.length;d++){var b=this.crosswordObjects[d];var h=b.row;var e=b.column;var f=b.word;var a=b.orientation;this.highlightCells(h,e,f,a,false)}},highlightCells:function(k,e,h,b,f){switch(b){case"horiz":case this.ACROSS_DIRECTION:for(var d=0;d<h.length;d++){var l="#"+this.getCellID(k,e++);var a=f?this.currentCellColor:"white";$(l).css("background-color",a)}break;case"vert":case this.DOWN_DIRECTION:for(var d=0;d<h.length;d++){var l="#"+this.getCellID(k++,e);var a=f?this.currentCellColor:"white";$(l).css("background-color",a)}break}},moveToCell:function(d,b){if(d.indexOf("input")<0){return}$(this.currentCell).css("background-color","white");$(d).css("background-color",this.currentCellColor);this.currentRow=$(d).data("row");this.currentColumn=$(d).data("col");if(b==true){var a=$(d).data("orientation");if(a=="horiz"){this.setDirection(this.ACROSS_DIRECTION)}if(a=="vert"){this.setDirection(this.DOWN_DIRECTION)}}this.currentCell="#"+this.getCellID(this.currentRow,this.currentColumn);$(this.currentCell).focus()},move:function(d){if(this.isValidMove(d)==false){return}var b=this.currentRow;var a=this.currentColumn;switch(d){case this.UP:this.setDirection(this.DOWN_DIRECTION);this.currentRow--;if(this.currentRow<0){this.currentRow=b}break;case this.DOWN:this.setDirection(this.DOWN_DIRECTION);this.currentRow++;if(this.currentRow>this.numberOfRows){this.currentRow=b}break;case this.LEFT:this.setDirection(this.ACROSS_DIRECTION);this.currentColumn--;if(this.currentColumn<0){this.currentColumn=a}break;case this.RIGHT:this.setDirection(this.ACROSS_DIRECTION);this.currentColumn++;if(this.currentColumn>this.numberOfColumns){this.currentColumn=a}break}},isValidMove:function(a){switch(a){case this.RIGHT:if(this.currentColumn+1>this.puzzle.row[this.currentRow].length||this.puzzle.row[this.currentRow].charAt(this.currentColumn+1)==this.EMPTYCELL){return false}break;case this.LEFT:if(this.currentColumn<1||this.puzzle.row[this.currentRow].charAt(this.currentColumn-1)==this.EMPTYCELL){return false}break;case this.UP:if(this.currentRow<1||this.puzzle.row[this.currentRow-1].charAt[this.currentColumn]==this.EMPTYCELL){return false}break;case this.DOWN:if(this.currentRow+1>this.puzzle.row.length||this.puzzle.row[this.currentRow+1].charAt(this.currentColumn)==this.EMPTYCELL){return false}break}return true},initHints:function(k,e,h){var f=document.createElement("select");f.id=h+"Select_"+this.uid;f.className="hintsSelect";$(f).css("width","100%");if(h=="across"){this.acrossSelect=f}else{this.downSelect=f}$(f).attr("size",e.length+1);$(k).append(f);var l=document.createElement("label");$(l).attr("for",h+"Select");$(l).text(h.toUpperCase());$(k).prepend(l);for(index=0;index<e.length;index++){var a=e[index].word;var b=h+e[index].no+"_"+this.uid;var d=this.getCrossWordObject(a);var m=d.hintNumber+"\t"+e[index].text;var n=document.createElement("option");n.id=b;$(n).data("crossWordObject",d);$(n).text(m);$(f).append(n)}},setDirection:function(a){this.direction=a;if(a==this.ACROSS_DIRECTION){$(this.directionDiv).html("&#x21E8")}else{$(this.directionDiv).html("&#x21E9")}},getHint:function(k,a){var f=$(this.hintFieldDiv).text();$(this.hintFieldDiv).text("");var r=Number(k);var b=Number(a);var m=$(this.acrossSelect).children();for(var h=0;h<m.length;h++){var p=m[h];$(p).css("background-color","#FFFFFF");var e=$(p).data("crossWordObject");var o=Number(e.row*1);var n=Number(e.column*1);if((o==r)&&(n==b)){$(p).css("background-color","#aaaaff");$(this.acrossSelect).val("");var l=$(p).data("crossWordObject");var d=l.hint;$(this.hintFieldDiv).text("across: "+d)}}m=$(this.downSelect).children();for(var h=0;h<m.length;h++){var p=m[h];$(p).css("background-color","#FFFFFF");var e=$(p).data("crossWordObject");var o=Number(e.row*1);var n=Number(e.column*1);if((o==r)&&(n==b)){$(p).css("background-color","#c7c7c7");$(this.downSelect).val("");var l=$(p).data("crossWordObject");var d=l.hint;var q=$(this.hintFieldDiv).text()+"        down: "+d;$(this.hintFieldDiv).text(q)}}if($(this.hintFieldDiv).text().length<1){$(this.hintFieldDiv).text(f)}},},{NAME:"CrosswordPage"});puremvc.define({name:"jet.view.page.DialogPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{this.initGadgets();b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="checkedNodeOptions"){f.checkedBranchOptions=d}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(k.match("dialog1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}}else{if(k.match("dialog2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}}else{if(k.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(k.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(k=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var k=f.getTag(b);if(k=="questionTypes"){this.createQuestionType(h)}if(k=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var k=f.getTag(b);if(k=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(k=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="hideAnswer"){f.setHideAnswer(h)}if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.DialogPage.USER_METRICS;var f=jet.view.page.DialogPage.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,f);this.sendGraphData(b,f);var k="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){k="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){k="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var a=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.getUID(),questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:a};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),d);return true?k:"Submitted"},sendGraphData:function(q,s){var n=this.scaleData("Criminal",q.Criminal);var f=this.scaleData("Education",q.Education);var o=this.scaleData("Family",q.Family);var r=this.scaleData("Leisure",q.Leisure);var k=this.scaleData("Companions",q.Companions);var w=this.scaleData("Alcohol",q.Alcohol);var b=this.scaleData("Procriminal",q.Procriminal);var a=this.scaleData("Antisocial",q.Antisocial);var v=[[o],[k],[n],[f],[r],[w],[b],[a]];var u=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var l=0;var t=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=v;d.ticks=u;d.seriesColors=e;d.series=h;d.minValue=l;d.maxValue=t;var m=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var p={};p.name="LEGEND";p.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];p.seriesColors=e;m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,p)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},initGadgets:function(){if(jet.view.page.DialogPage.INIT_GADGETS){return}jet.view.page.DialogPage.INIT_GADGETS=true;var l=1;var n=2;var f=1;var d=5;var p=1;var a=3;var r=1;var m=1;var k=[[f],[p],[l],[n],[d],[a],[r],[m]];var q=["2=Low, 3=Med, 4=High"];var b=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var e={};e.name="BARGRAPH";e.data=k;e.ticks=q;e.seriesColors=b;e.series=h;var s=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);s.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,e);var o={};o.name="LEGEND";o.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];o.seriesColors=b;s.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,o)},scaleData:function(b,a){88;switch(b){case"Criminal":case"Education":switch(a){case 0:case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 1;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 1;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"DialogPage"});puremvc.define({name:"jet.view.page.DragNDropPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.initialCanvasPositions=[];this.clickTouchEvents={};this.clickTouchAreaID=0;this.feedBackComponents=[];this.layers={};this.groups={};this.shapeProperties=["EnableClickTouch","EnableBranch","EnableMouseOver"];this.hideAnswer="false";this.hideCheckButton="false"}},{contentDiv:null,answerKeys:null,components:null,initialCanvasPositions:null,clickTouchEvents:null,clickTouchAreaID:0,feedBackComponents:null,layers:null,groups:null,ignoreXPosition:false,ignoreYPosition:false,branchOptions:null,shapeProperties:null,hideAnswer:"false",hideCheckButton:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,e,d,k,h){var l=b.getTag(d);var f;if(l=="totalpoints"){b.setTotalPoints(k)}if(l=="IgnoreXPosition"){this.ignoreXPosition=k=="true"?true:false}if(l=="IgnoreYPosition"){this.ignoreYPosition=k=="true"?true:false}if(l=="hideAnswer"){this.setHideAnswer(k)}if(l=="hideCheckButton"){this.setHideCheckButton(k)}if(l=="flowstatus"){if(k=="true"){b.setInFlow("false")}}switch(e){case jet.AppConstants.IMAGE:var a=b.getMediator(jet.view.mediator.GraphicsMediator.NAME);if(k.length>=6){var m=k.substring(0,6);a.getXMLData(m,b)}break;case jet.AppConstants.NODES_MANAGER:b.branchOptions=h;break;case jet.AppConstants.AUDIO:if(k.length<1){return}var f=new jet.view.component.HTMLAudioComponent;f.setMediaURL(k);f.setAudioOptions(captionOptions);f.setParent(b.contentDiv);f.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);this.components.push(f);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},showCheckAnswerButton:function(){if(this.getHideCheckButton()=="false"){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()}},processGraphicsObject:function(d,e,a){var k=this;var l=$(d).attr("class");if(k.isShapeProperty(l)){if(l.indexOf("EnableClickTouch")>-1){var m=++k.clickTouchAreaID;$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");k.clickTouchEvents[m]={action:e.action,userClicked:false,canvas:d,objectMap:e};e.enabled=true;$(d).unbind("click");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("click",function(){k.clickTouch(d,k,e,m)})}if(l.indexOf("EnableBranch")>-1){$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");e.enabled=true;$(d).unbind("click");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("click",function(){k.clickAndBranch(d,k,e)})}if(l.indexOf("EnableMouseOver")>-1){var h=parseInt($(d).css("left"));var b=parseInt($(d).css("top"));$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");e.enabled=true;$(d).unbind("mouseenter");$(d).unbind("mouseleave");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("mouseenter",function(){k.mediators[jet.view.mediator.PageMediator.NAME].showToolTip(e.mouseoveraction,h,b)});$(d).bind("mouseleave",function(){k.mediators[jet.view.mediator.PageMediator.NAME].hideToolTip()})}return}if(l.indexOf("EnableMotion")>-1&&l.indexOf("EnableModify")>-1){var f={};f.canvas=d;f.x=$(d).css("left");f.y=$(d).css("top");f.height=a.y;f.width=a.x;f.objectMap=e;this.initialCanvasPositions.push(f);$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("dragstop",function(){k.dragStop(d,k)});$(this.div).bind("dragstart",function(){})}},postProcessGraphics:function(){$(this.myDiv).attr("id",this.uid);this.randomizeComponents()},clickTouch:function(d,e,f,a){var b=f.enabled;if(b){var h=0;e.showCheckAnswerButton();this.clickTouchEvents[a].userClicked=true;e.setJetValue(f);if(this.getHideCheckButton()=="true"){this.evaluateUserActivity()}else{$(d).css({border:"2px dashed #000000"})}}},clickAndBranch:function(b,d,e){var a=e.enabled;if(a){branchOptions={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};branchOptions.checkedOption=e.event;branchOptions.checkedValue=e.action;d.setJetValue(e);this.mediators[jet.view.mediator.PageMediator.NAME].executeBranch(branchOptions,true)}},dragStop:function(b,l){var q=new jet.controller.command.util.GraphicsUtils();l.showCheckAnswerButton();var o=l.initialCanvasPositions;var k=parseInt($(b).css("left"),10);var f=parseInt($(b).css("top"),10);var p={};p.x=k;p.y=f;var s=10000;var a=null;for(var h=0;h<o.length;h++){var r={};r.x=parseInt(o[h]["x"]);r.y=parseInt(o[h]["y"]);var e=q.calcMagnitude(p,r);if(e<s){s=e;a=r}}if(s<100){$(b).css("left",a.x);$(b).css("top",a.y)}else{var n=700;var m=200;var d=0;for(var h=0;h<l.initialCanvasPositions.length;h++){if(b===l.initialCanvasPositions[h]["canvas"]){d=l.initialCanvasPositions[h]["InitialPosition"]}}$(b).animate({left:n,top:d},{queue:false,duration:1000,easing:"swing"})}if(this.getHideCheckButton()=="true"){this.evaluateUserActivity()}},enableInteractivity:function(){var d=this;for(var b=0;b<this.initialCanvasPositions.length;b++){var a=this.initialCanvasPositions[b]["canvas"];$(a).draggable("option","disabled",false)}for(var f in d.clickTouchEvents){var a=d.clickTouchEvents[f].canvas;var e=d.clickTouchEvents[f].objectMap;e.enabled=true;d.clickTouchEvents[f].userClicked=false}},disableInteractivity:function(){for(var b=0;b<this.initialCanvasPositions.length;b++){var a=this.initialCanvasPositions[b]["canvas"];$(a).draggable("disable")}for(var e in this.clickTouchEvents){var a=this.clickTouchEvents[e].canvas;var d=this.clickTouchEvents[e].objectMap;$(a).css({border:"none"});d.enabled=false}},processComponents:function(){},randomizeComponents:function(){var f=[];var a=10;var l=700;var n=25;for(var d=0;d<this.initialCanvasPositions.length;d++){f.push(d)}this.shuffle(f);if(this.initialCanvasPositions.length<=0){return}for(var e=0;e<this.initialCanvasPositions.length;e++){var m=f[e];if(m>=this.initialCanvasPositions.length){continue}if(this.initialCanvasPositions[m]==undefined){continue}var b=this.initialCanvasPositions[m]["canvas"];if(b!=undefined&&b!=null){$(b).css("left",l+"px");$(b).css("top",a+"px");this.initialCanvasPositions[m]["InitialPosition"]=a;var h=this.initialCanvasPositions[m]["height"];a+=h;a+=10}}},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var h=this.ignoreYPosition?10:0;var s=this.ignoreXPosition?10:0;if(this.getHideCheckButton()=="false"){this.disableInteractivity()}var m="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var a=this.getTotalPoints()/(this.initialCanvasPositions.length+this.clickTouchAreaID);for(var r=0;r<this.initialCanvasPositions.length;r++){var f=this.initialCanvasPositions[r]["canvas"];var l=parseInt($(f).css("left"));var k=parseInt($(f).css("top"));var p=parseInt(this.initialCanvasPositions[r]["x"]);var n=parseInt(this.initialCanvasPositions[r]["y"]);var q=Math.abs(l-p);var o=Math.abs(k-n);if((!this.ignoreXPosition&&q>h)||(!this.ignoreYPosition&&o>s)){m="\u2718";this.setIsUserCorrect(false);var t=parseInt((this.getUserPoints()-a)*10)/10;this.setUserPoints(t);this.addFeedback(f,false)}else{this.addFeedback(f,true);this.setJetValue(this.initialCanvasPositions[r]["objectMap"])}}for(var d in this.clickTouchEvents){var f=this.clickTouchEvents[d].canvas;var b=this.clickTouchEvents[d].action=="Judge Correct"?true:false;var e=this.clickTouchEvents[d].userClicked;if((b&&!e)||(!b&&e)){m="\u2718";this.setIsUserCorrect(false);var t=parseInt((this.getUserPoints()-a)*10)/10;this.setUserPoints(t);this.addFeedback(f,false)}else{if(b){this.addFeedback(f,true)}}}return this.getHideAnswer()=="false"?m:"Submitted"},setBranchOptions:function(a){this.branchOptions=a},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"ImagePage"},getContentDiv:function(){return this.contentDiv},shufflex:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},shuffle:function(b){for(var d,a,e=b.length;e>0;){d=parseInt(Math.random()*e);a=b[--e];b[e]=b[d];b[d]=a}},addFeedback:function(d,a){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("z-index","11");$(b).css("top",$(d).css("top"));$(b).css("left",parseInt($(d).css("left"))-13+"px");var e=a?"\u2713":"\u2718";$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},getGroups:function(){return this.groups},getLayers:function(){return this.layers},isShapeProperty:function(d){for(var b=0;b<this.shapeProperties.length;b++){var a=this.shapeProperties[b];if(d.indexOf(a)>-1){return true}}return false},setJetValue:function(e){if(e.hasOwnProperty("setvalueevent")&&e.hasOwnProperty("setvalueaction")){if(e.setvalueaction.length>0){var b=e.setvalueevent;switch(b){case jet.AppConstants.SET_VALUE:var a=e.setvalueaction;var d=a.split(",");if(d.length==2){whichProperty=d[0];whatValue=d[1];setJetValue(whichProperty,whatValue)}break;case jet.AppConstants.APPEND_VALUE:var a=e.setvalueaction;var d=a.split(",");if(d.length==2){whichProperty=d[0];whatValue=d[1];appendJetValue(whichProperty,whatValue)}break}}}},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setHideCheckButton:function(a){this.hideCheckButton=a},getHideCheckButton:function(){return this.hideCheckButton}},{NAME:"ImagePage"});puremvc.define({name:"jet.view.page.FlashCardPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("flashcard");$(this.myDiv).addClass("chip_light");$(this.myDiv).addClass("d_panel");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,processedExpression:false,processedRegEx:false,originalExpression:null,isUserCorrect:null,feedBackComponents:null,feedbackToStudents:null,canvasDiv:null,resetRequired:false,storedUserInputProperties:null,deepClonedDiv:null,deepClonedUserInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);if(this.resetRequired){this.resetRequired=false;this.resetUserInputField()}}},buildComponent:function(b,e,d,l,k){switch(e){case jet.AppConstants.NODES_MANAGER:b.branchOptions=k;break;case jet.AppConstants.CHECKBOX:this.processedRegEx=true;if(l.toUpperCase()=="TRUE"){this.useRegEx=true}if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}var m=b.getTag(d);if(m=="flowstatus"){if(l=="true"){b.setInFlow(false)}}break;case jet.AppConstants.TEXT:var m=b.getTag(d);if(m=="totalpoints"){b.setTotalPoints(l)}else{if(m=="expression"){this.storedUserInputProperties=d;this.processedExpression=true;this.originalExpression=l;var f=new jet.view.component.InputTextComponent;f.setParent(b.myDiv,this);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);f.setText(l);this.userInputComponents.push(f);if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}}else{if(m=="stem"){var f=new jet.view.component.ViewComponent;f.setParent(b.myDiv);f.addContentClass("chip_instructions");b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);f.setText(l)}else{if(m=="Feedback"){this.feedbackToStudents=l}}}}break;case jet.AppConstants.IMAGE:var f=new jet.view.component.ImageComponent;f.setParent(b.myDiv);f.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);f.setText(l);var a=f.getImageParent();$(a).css("max-height","200px");var h=f.getContentDiv();$(h).addClass("d_image");$(h).css("width","100%");$(h).css("height","auto");$(h).css("max-width","100%");$(h).css("max-height","200px");$(h).css("object-fit","contain");break;case jet.AppConstants.AUDIO:if(l.length<1){return}var f=new jet.view.component.HTMLAudioComponent;f.setMediaURL(l);f.setAudioOptions(k);f.setParent(b.contentDiv);f.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);this.components.push(f);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(l);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){if(this.useRegEx!=true){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}}else{this.answerKeys.push(d)}},concatenateAnswerKeys:function(){if(this.answerKeys.length>0){var b=this.answerKeys[0];for(var a=1;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},processAnswerKeys:function(){if(this.useRegEx){this.answerKeys.push(this.originalExpression)}else{this.splitIntoAnswerKeys(this.originalExpression)}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);this.applyBoxShadow()},applyBoxShadow:function(){$(this.myDiv).css("-webkit-box-shadow","0px 0px 10px rgba(0,0,0,.8)");$(this.myDiv).css("-moz-box-shadow","0px 0px 10px rgba(0,0,0,.8)");$(this.myDiv).css("box-shadow","0px 0px 10px rgba(0,0,0,.8)")},evaluateUserActivity:function(){this.deepClonedDiv=$(this.myDiv).clone(true);var b="\u2713";this.setInFlow(false);this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.useRegEx){if(!this.doesAnswerMatchExpression(this.userInputComponents[0].getUserInput())){b="\u2718";this.setInFlow(true);this.resetRequired=true;this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}else{if(!this.isAnswerinArray(this.userInputComponents[0].getUserInput())){b="\u2718";this.setInFlow(true);this.resetRequired=true;this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}var a=b=="\u2713"?"#bdffbd":"#ffffff";$(this.myDiv).flippy({color_target:a,direction:"right",duration:"500",verso:"<div class='verso,chip_instructions' style='margin:30px'><p style='margin-top:50px;font-size:xx-large' align='center'>"+b+"</p><p style='font-size:2em' align='center'><b>Your answer:</b> "+this.userInputComponents[0].getUserInput()+"</p> <p style='margin-top:20px;font-size:1em' align='center'><b>The correct answer is: </b>"+this.feedbackToStudents+"</p></div>"});return b},getBranchOptions:function(){return this.branchOptions},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},resetUserInputField:function(){$(this.myDiv).empty();$(this.myDiv).remove();this.myDiv=this.deepClonedDiv;$(".viewer").append(this.myDiv);$(this.myDiv).show();var a=$(this.myDiv).find("input");this.userInputComponents[0].resetDiv(a)}},{NAME:"FlashCardPage"});puremvc.define({name:"jet.view.page.FormsPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="formsPage";$(this.myDiv).addClass("page");$(this.myDiv).addClass("chip_light");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="formsContent";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.tileArray=[];this.tileDivArray=[]}},{rowHeight:40,initialLeft:700,mediator:null,xml:null,uid:null,components:null,arrayT:null,arrayI:null,arrayO:null,tileArray:null,tileDivArray:null,rowArray:null,concatenatedArray:null,backgroundTile:null,instructionsDiv:null,branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},show:function(a){if(a){$(this.myDiv).show();this.updateAll()}else{$(this.myDiv).hide()}},showCheckAnswerButton:function(){this.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()},buildComponent:function(f,d,a,h,b){switch(d){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(a);if(k=="checkedNodeOptions"){f.branchOptions=b}break}if(d==jet.AppConstants.DATA_INPUT&&h.length>0){var e=f.processXML(h);this.xml=h}if(d==jet.AppConstants.TEXT&&h.length>0){var k=f.getTag(a);if(k=="totalpoints"){f.setTotalPoints(h)}if(k=="instructions"){$(this.instructionsDiv).text(h)}}if(d==jet.AppConstants.IMAGE){this.backgroundTile=h;$(this.myDiv).css("background-image","url(base/"+h+")")}if(d==jet.AppConstants.ACCESSIBILITY_TEXT&&h.length>0){this.setAlternativeContent(h)}},processXML:function(b){this.xml=b;xmlDoc=$.parseXML(b);var a=$(xmlDoc).find("dataPage");for(var e=0;e<a.length;e++){var d=a[e];var h=$(d).find("Title")[0].textContent.trim();var l=$(d).find("Abbreviation")[0].textContent.trim();var k=$(d).find("ID")[0].textContent.trim();var f={Title:h,Abbreviation:l,ID:k,};this.tileArray.push(f)}this.renderTiles()},getTilesDiv:function(){return this.tilesDiv},getDropDiv:function(){return this.dropDiv},renderTiles:function(){var h=this;var f=this.getMediator(jet.view.mediator.PageMediator.NAME);var e=parseInt($(".viewer").css("height"));for(var d=0;d<this.tileArray.length;d++){var l=this.tileArray[d];var b=document.createElement("div");var a=document.createElement("div");var k=document.createElement("div");$(b).append(a);$(b).append(k);this.tileDivArray.push(b);$(this.contentDiv).append(b);$(a).text(l.Title);$(b).attr("id",l.ID);$(b).addClass("tile");$(a).addClass("title");$(a).addClass("chip_medium");$(a).addClass("d_header");$(k).addClass("textEntry");this.makeEditable(b,k)}},prepareTileHTML:function(d,f){if(f.toUpperCase().indexOf("JPG")>0||f.toUpperCase().indexOf("PNG")>0||f.toUpperCase().indexOf("JPEG")>0){var b="<img src = 'base/"+f+"'/>";$(d).html(b);var a=150;var h=parseInt($(d).css("width"));var e=Math.max(parseInt((h-a)/2),0);e=e+"px";$(d).css("margin-left",e);$(d).css("margin-right",e);$(d).removeAttr("height").removeAttr("width");$(d).css("height","").css("width","")}else{$(d).html(f)}},evaluateUserActivity:function(){},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){},postProcess:function(){$(this.myDiv).attr("id",this.uid)},getContentAsResource:function(){return $(this.myDiv).html()},update:function(a,h){var m=$(a).attr("id");var d="#"+m+".LongAnswerPage";var k=$(d);if(k!=null&&typeof k!="undefined"&&k.length>0){var b=$(k).attr("data-uid");var f=$(k).attr("data-heading");var l=$(k).find("textarea");$(l).val(h);var e={heading:f,response:h,page_ID:b};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserResponse(b,e)}},updateAll:function(){var b=this;var a=$(this.contentDiv).find(".tile");$(a).each(function(){var d=$(this).find(".textEntry");b.initEntry(this,d)})},initEntry:function(k,f){var b=$(k).attr("id");var a="#"+b+".LongAnswerPage";var d=$(a);if(d!=null&&typeof d!="undefined"&&d.length>0){var h=$(d).attr("data-uid");var e=this.getMediator(jet.view.mediator.QuestionProcessorMediator.NAME).getUserResponse(h);if(e!=null){$(f).html(e)}}},makeEditable:function(d,b){var a=this;$(b).click(function(){var f=$(b).html();var e=$("<textarea />");$(e).css("background-color","white");$(e).css("height","300px");$(e).css("width","100%");e.val(f);$(b).replaceWith(e);e.focus();a.showCheckAnswerButton();$(e).blur(function(){var h=$(this).val();a.update(d,h);var k=$("<div>");$(k).addClass("textEntry");a.makeEditable(d,k);k.html(h);$(e).replaceWith(k)})})},getBranchOptions:function(){return this.branchOptions},},{NAME:"FormsPage"});puremvc.define({name:"jet.view.page.GatePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.components=[];this.userInputComponents=[];this.branchingComponents=[];this.passBranchOptions=null;this.failBranchOptions=null;this.branchOptions=null;this.customVariables=null;this.overrideNavigation="false";this.allowNext="true";this.allowBack="true"}},{components:null,userInputComponents:null,branchOptions:null,passBranchOptions:null,failBranchOptions:null,branchingComponents:null,scoreThreshold:0,passMessage:"",failMessage:"",resetScore:false,resetInteractivityOnly:false,allowBack:"true",allowNext:"true",overrideNavigation:false,allowPassRegardlessOfScore:true,useCustomScore:false,usePercentage:false,customScoreVariableName:"",customVariables:"",show:function(a){},setScoreThreshold:function(a){this.scoreThreshold=a},getScoreThreshold:function(){return this.scoreThreshold},setPassMessage:function(a){this.passMessage=a},getPassMessage:function(){return this.passMessage},setFailMessage:function(a){this.failMessage=a},getFailMessage:function(){return this.failMessage},setResetScore:function(a){this.resetScore=a},getResetScore:function(){return this.resetScore},setResetInteractivityOnly:function(a){this.resetInteractivityOnly=a},getResetInteractivityOnly:function(){return this.resetInteractivityOnly},setAllowBack:function(a){this.allowBack=a},getAllowBack:function(){return this.allowBack},setAllowNext:function(a){this.allowNext=a},getAllowNext:function(){return this.allowNext},setNavigationDefault:function(a){this.overrideNavigation=a},getNavigationDefault:function(){return this.overrideNavigation},setAllowPassRegardlessOfScore:function(a){this.allowPassRegardlessOfScore=a},getAllowPassRegardlessOfScore:function(){return this.allowPassRegardlessOfScore},setPassOptions:function(a){this.passBranchOptions=a},setFailOptions:function(a){this.failBranchOptions=a},setUseCustomScore:function(a){this.useCustomScore=a},getUseCustomScore:function(){return this.useCustomScore},setUsePercentage:function(a){this.usePercentage=a},getUsePercentage:function(){return this.usePercentage},setCustomScoreVariableName:function(a){this.customScoreVariableName=a},getCustomScoreVariableName:function(){return this.customScoreVariableName},setCustomVariables:function(a){this.customVariables=a},getCustomVariables:function(){return this.customVariables},buildComponent:function(e,d,a,f,b){var h=e.getTag(a);switch(d){case jet.AppConstants.TEXT:switch(h){case"scoreThreshold":e.setScoreThreshold(f);break;case"passOptions":e.setPassOptions(b);break;case"failOptions":e.setFailOptions(b);break;case"customScoreVariableName":e.setCustomScoreVariableName(f);break;case"variables":e.setCustomVariables(f);break}break;case jet.AppConstants.CHECKBOX:switch(h){case"resetScore":e.setResetScore(f);break;case"resetInteractivityOnly":e.setResetInteractivityOnly(f);break;case"allowBack":e.setAllowBack(f);break;case"allowNext":e.setAllowNext(f);break;case"overrideNavigation":e.setNavigationDefault(f);break;case"passRegardlessOfScore":e.setAllowPassRegardlessOfScore(f);break;case"useCustomScore":e.setUseCustomScore(f);break;case"usePercentage":e.setUsePercentage(f);break}break}},handleText:function(a){},processComponents:function(){},postProcess:function(){$(this.myDiv).attr("id",this.uid);this.mediators[jet.view.mediator.PageMediator.NAME].getReport();if(this.getResetScore()=="true"){this.mediators[jet.view.mediator.PageMediator.NAME].resetScore()}if(this.getResetInteractivityOnly()=="true"){this.mediators[jet.view.mediator.PageMediator.NAME].resetInteractivityOnly()}if(this.getCustomVariables()&&this.getCustomVariables().length>0){this.mediators[jet.view.mediator.PageMediator.NAME].resetCustomScores(this.getCustomVariables())}},processNotification:function(d,a){switch(d){case jet.AppConstants.REPORT_INTERNALLY:var b=a;var f=b.scoreTotal;var e;if(this.getUseCustomScore()=="true"){e=getJetValue(this.getCustomScoreVariableName())}else{e=b.userTotal}this.processBranch(e,f);break}},processBranch:function(d,e){if(this.getUsePercentage()=="true"){if(e>0){this.setBranchOptions((d/e*100)>=this.scoreThreshold?this.passBranchOptions:this.failBranchOptions)}else{this.setBranchOptions(this.passBranchOptions)}}else{this.setBranchOptions(d>=this.scoreThreshold?this.passBranchOptions:this.failBranchOptions)}var a=this.getBranchOptions();var b=new Object();b.getBranchOptions=function(){return a};this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(b,null,null)},getBranchOptions:function(){return this.branchOptions},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},getName:function(){return"Gate"}},{NAME:"GatePage"});puremvc.define({name:"jet.view.page.IFramePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("IFramePage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[];this.iFrameSrc}},{contentDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,iFrameSrc:null,captionResource:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(true)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.showIFrames(false)}},buildComponent:function(e,d,b,f,a){switch(d){case jet.AppConstants.TEXT:var h=e.getTag(b);if(h.toUpperCase()==jet.AppConstants.IFRAME){this.iFrameSrc=this.parseSource(f);this.drawIFrame(this.iFrameSrc);return}}},parseSource:function(b){if(b.toUpperCase().indexOf("SRC")<0){b=stripQuotes(b);return b}var d=/.*src=[\'|\"](.*?)([\'|\"]).*/;var a=d.exec(b);if(typeof a!="undefined"&&a!=null&&a.length>0){return a[1]}else{return b}},handleText:function(a){},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid)},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"IFramePage"},drawIFrame:function(){var b=this;var a=document.createElement("iframe");this.iFrames.push(a);$(b.contentDiv).append(a);$(a).css("width","100%");$(a).css("min-height","480px");$(a).attr("allowfullscreen","true");$(b.contentDiv).css("padding-bottom","0%");a.src=b.iFrameSrc},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width","98%");$(this.iFrames[b]).css("height","98%")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px");var d=$(this.iFrames[b]).attr("src");$(this.iFrames[b]).attr("src",d)}}},getContentAsResource:function(){return"REPARENT"},getClonedContent:function(){return $(this.myDiv).clone(true,true)},getReParentedContent:function(){return this},},{NAME:"IFramePage"});puremvc.define({name:"jet.view.page.ImagePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("ImagePage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[]}},{contentDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(true)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.showIFrames(false)}},buildComponent:function(h,e,d,k,b){switch(e){case jet.AppConstants.IMAGE:if(k.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var f=k.replace(/.*?v=/,"");this.drawYouTubePlayer(f);return}var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);a.setText(k);a.setCaptionOptions(b);break;case jet.AppConstants.AUDIO:if(k.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(k);a.setAudioOptions(b);a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var l=h.getTag(d);if(l=="flowstatus"){if(k=="true"){h.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid)},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"ImagePage"},drawYouTubePlayer:function(e){var d=this;var h=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var f=h.getVideoIndex();var b="player"+f;var a=document.createElement("iframe");this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;a.width=this.IFRAMEWIDTH;a.height=this.IFRAMEHEIGHT;a.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1";var k=setInterval(function(){if(h.isYTAvailable()){h.addPlayer(b,e);clearInterval(k)}},2000)},getContentAsResource:function(){return $(this.contentDiv).html()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width",this.IFRAMEWIDTH+"px");$(this.iFrames[b]).css("height",this.IFRAMEHEIGHT+"px")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}}},{NAME:"ImagePage"});puremvc.define({name:"jet.view.page.InteractiveImagePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="interactiveImagePage";this.myDiv.id=a;this.instructionsDiv=document.createElement("div");this.instructionsDiv.className="instructions";$(this.instructionsDiv).css("width","80%");$(this.instructionsDiv).css("padding","10px");$(this.instructionsDiv).css("margin-left","10%");$(this.instructionsDiv).css("margin-right","10%");$(this.instructionsDiv).css("margin-bottom","10px");$(this.instructionsDiv).css("margin-top","10px");$(this.instructionsDiv).css("border","0px solid #e7e7e7");$(this.instructionsDiv).css("border-radius","10px");$(this.instructionsDiv).css("text-shadow","2px 2px #e7e7e7");$(this.myDiv).append(this.instructionsDiv);this.imageContainer=document.createElement("div");this.imageContainer.className="imageContainer";$(this.imageContainer).css("width","98%");$(this.imageContainer).css("position","relative");$(this.imageContainer).css("overflow","visible");this.imageDiv=document.createElement("img");this.imageDiv.className="imageContent";$(this.imageDiv).css("position","relative");$(this.imageDiv).css("width","100%");$(this.imageDiv).css("margin-left","1%");$(this.imageDiv).css("left","0");$(this.imageDiv).css("top","0");$(this.imageDiv).css("border-right","2px solid #e7e7e7");$(this.imageDiv).css("border-top","2px solid #e7e7e7");this.contentDiv=document.createElement("div");this.contentDiv.className="interactiveContent";$(this.contentDiv).css("position","absolute");$(this.contentDiv).css("width","100%");$(this.contentDiv).css("height","100%");$(this.contentDiv).css("left","0");$(this.contentDiv).css("top","0");$(this.imageContainer).append(this.imageDiv);$(this.imageContainer).append(this.contentDiv);$(this.myDiv).append(this.imageContainer);$(".viewer").append(this.myDiv);this.components=[];this.textArray=[];this.tileDivArray=[];this.clickArray=[];this.hoverArray=[];this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[],};this.dropArea=document.createElement("div");this.dropArea.className="dropDiv";this.addClickListener(this.contentDiv)}},{rowHeight:40,initialLeft:700,mediator:null,xml:null,uid:null,components:null,arrayT:null,arrayI:null,arrayO:null,textArray:null,tileDivArray:null,rowArray:null,concatenatedArray:null,backgroundTile:null,instructionsDiv:null,imageDiv:null,imageContainer:null,clickArray:null,hoverArray:null,tooltip:null,branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},show:function(a){if(a){$(this.myDiv).show();this.getMediator(jet.view.mediator.PageMediator.NAME).reportUserActivity(this,this.uid)}else{$(this.myDiv).hide()}},showCheckAnswerButton:function(){this.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()},buildComponent:function(f,d,a,h,b){if(d==jet.AppConstants.DATA_INPUT&&h.length>0){var e=f.processXML(h);this.xml=h}if(d==jet.AppConstants.TEXT&&h.length>0){var k=f.getTag(a);if(k=="totalpoints"){f.setTotalPoints(h)}if(k=="instructions"){$(this.instructionsDiv).text(h)}}if(d==jet.AppConstants.IMAGE){this.backgroundTile=h;$(this.imageDiv).attr("src","base/"+h)}if(d==jet.AppConstants.ACCESSIBILITY_TEXT&&h.length>0){this.setAlternativeContent(h)}},processXML:function(o){this.xml=o;xmlDoc=$.parseXML(o);var n=$(xmlDoc).find("dataPage");for(var m=0;m<n.length;m++){var f="";var q="";var s="";var b="";var h=n[m];var t=$(h).find("Text")[0].textContent.trim();var k=$(h).find("Start_Column_Row")[0].textContent.trim();if(k.length>1){s=k.substring(0,1);b=k.substring(1)}else{s="z";b="100"}var a=$(h).find("End_Column_Row")[0].textContent.trim();if(a.length>1){f=a.substring(0,1);q=a.substring(1)}else{f=s;q=b}var l=$(h).find("Action")[0].textContent.trim();var e=$(h).find("Event")[0].textContent.trim();var r=$(h).find("Value")[0].textContent.trim();var d=$(h).find("Feedback")[0].textContent.trim();var p={Text:t,startRow:b,startColumn:s,endRow:q,endColumn:f,Event:e,Action:l,Value:r,Feedback:d};this.processTile(p)}this.renderTiles();this.renderHoverAreas()},processTile:function(b){var a=b.Event;switch(a){case"Click":this.clickArray.push(b);break;case"Drag and Drop":this.textArray.push(b);break;case"Hover":this.hoverArray.push(b);break}},rowNumber:function(){var a=$(".rowNumber");a.attr("type","number");a.children().each(function(b,d){$(d).text((b+1)+". "+$(d).text())})},getTilesDiv:function(){return this.tilesDiv},getDropDiv:function(){return this.dropDiv},renderTiles:function(){var n=this;var a=this.getMediator(jet.view.mediator.PageMediator.NAME);var b=this.calcNumberOfUnpinnedTiles();var f=this.generateRandom(b);var m=0;var l=parseInt($(".viewer").css("height"));var d=f.length*(this.rowHeight*2+10)<l?this.rowHeight*2:(l-100)/f.length;for(var h=0;h<this.textArray.length;h++){var e=this.textArray[h];var k=document.createElement("div");this.tileDivArray.push(k);$(this.contentDiv).append(k);$(k).height("auto");$(k).data("Text",e.Text);$(k).data("startRow",e.startRow);$(k).data("startColumn",e.startColumn);$(k).data("endRow",e.endRow);$(k).data("endColumn",e.endColumn);$(k).css("position","absolute");$(k).css("right","20%");this.prepareTileHTML(k,e.Text);$(k).addClass("OrganizerTileDiv");$(k).addClass("InteractiveLabel");var o=this.rowHeight;$(k).draggable({start:function(){$(this).removeClass("tileInPosition");$(this).removeClass("initialState");$(this).css("opacity","0.5");$(this).css("right","");$(this).css("left","");$(this).css("top","")},stop:function(){$(this).addClass("tileInPosition");$(this).css("opacity",".9");$(this).css("background","#FFFFFF");var t=parseInt($(this).css("top"));var u=parseInt($(this).css("left"));var r=$(n.imageDiv).width();var p=$(n.imageDiv).height();var q=u/r;var s=t/p;var w=Math.floor(q*100);var v=Math.floor(s*100);$(this).css("left",w+"%");$(this).css("top",v+"%");n.showCheckAnswerButton()}})}},renderHoverAreas:function(){var m=this;var a=this.getMediator(jet.view.mediator.PageMediator.NAME);for(var f=0;f<this.hoverArray.length;f++){var e=this.hoverArray[f];var k=document.createElement("div");$(this.contentDiv).append(k);$(k).height("auto");$(k).data("Text",e.Text);$(k).data("startRow",e.startRow);$(k).data("startColumn",e.startColumn);$(k).data("endRow",e.endRow);$(k).data("endColumn",e.endColumn);$(k).data("feedback",e.Feedback);var o=e.startColumn.toLowerCase().charCodeAt(0)-97+1;var l=e.endColumn.toLowerCase().charCodeAt(0)-97+1;var n=((l-o)+1)*5;var h=((e.endRow-e.startRow)+1)*5;var d=(o-1)*5;var b=(e.startRow)*5;$(k).css("width",n+"%");$(k).css("height",h+"%");$(k).css("left",d+"%");$(k).css("top",b+"%");$(k).css("opacity",0);$(k).css("background-color","Red");$(k).css("position","absolute");$(k).hover(function(){var p=$(this).data("feedback");var r=parseInt($(this).css("left"));var q=parseInt($(this).css("top"));m.showTooltip(m.contentDiv,p,r,q-50)},function(){m.hideTooltip()})}},prepareTileHTML:function(d,f){if(f.toUpperCase().indexOf("JPG")>0||f.toUpperCase().indexOf("PNG")>0||f.toUpperCase().indexOf("JPEG")>0){var b="<img src = 'base/"+f+"'/>";$(d).html(b);var a=150;var h=parseInt($(d).css("width"));var e=Math.max(parseInt((h-a)/2),0);e=e+"px";$(d).css("margin-left",e);$(d).css("margin-right",e);$(d).removeAttr("height").removeAttr("width");$(d).css("height","").css("width","")}else{$(d).html(f)}},pinTiles:function(){for(var d=0;d<this.tileDivArray.length;d++){var b=this.tileDivArray[d];var h=$(b).data("Row");var a=$(b).data("Position");var f=this.getXPositionInRow(h,a);var e=this.rowHeight*(h-1);$(b).css("left",f+"px");$(b).css("top",e+"px");$(b).draggable("disable")}},calcNumberOfUnpinnedTiles:function(){var b=0;for(var a=0;a<this.textArray.length;a++){var d=this.textArray[a];b++}return b},getXPositionInRow:function(q,m){var p="row"+q;var o=this.tileDivArray;var k=0;for(var h=0;h<o.length;h++){var n=o[h];var l=$(n).data("Row");var f=$(n).data("Position");if(q!=l||f>=m){continue}var b=parseInt($(n).width());var d=parseInt($(n).css("margin-left"));var e=parseInt($(n).css("margin-right"));var a=b+d+e;k+=a}return k},getRowXRange:function(h,b,f){var a={lowX:-1,highX:-1};var k=b-1;var e=this.rowArray["row"+h];if(e.length>k){var d=e[k];a.lowX=this.getXPositionInRow(1,b)}if(e.length>k+1){var d=e[k+1];a.highX=this.getXPositionInRow(1,b+1)}return a},generateRandom:function(b){var a=new Array(b);for(var e=0;e<b;e++){a[e]=e}for(var e=b-1;e>0;e--){var h=Math.random()*(b-1);var f=Math.round(h);var d=a[e];a[e]=a[f];a[f]=d}return a},getNumberOfTexts:function(){var a=0;for(text in this.tiles){a++}return a},resetRowArrays:function(){this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[]}},placeInArray:function(e,f){var b=parseInt($(e).css("left"));for(var d=0;d<f.length;d++){var a=parseInt($(f[d]).css("left"));if(b<a){f.splice(d,0,e);return}}f.push(e)},concatenateArrays:function(){this.concatenatedArray=[];for(var b in this.rowArray){var d=this.rowArray[b];for(var a=0;a<d.length;a++){this.concatenatedArray.push(d[a])}}},evaluateUserActivity:function(){var t="</br>\u2713</br>";var E="</br>\u2718</br>";var w=15;this.disableInteractivity();var B=this.tileDivArray;var e=this.getTotalPoints();var q=e;var f=B.length;ratio=e/f;for(var z=0;z<B.length;z++){var D=B[z];var s=parseInt($(D).css("top"))+w;var a=parseInt($(D).css("left"));var r=$(this.imageDiv).width();var C=$(this.imageDiv).height();var A=a/r;var b=s/C;var y=$(D).data("startRow");var l=$(D).data("startColumn");var v=$(D).data("endRow");var d=$(D).data("endColumn");var n=l.toLowerCase().charCodeAt(0)-97+1;var h=d.toLowerCase().charCodeAt(0)-97+1;var x=n*(5/100);var o=y*(5/100)+0.05;var p=h*(5/100);var m=v*(5/100)+0.05;if((A>=(x-0.05))&&(A<p)){if((b>=(o-0.05))&&(b<m)){$(D).append(t)}else{$(D).append(E);q-=ratio}}else{$(D).append(E);q-=ratio}}var k="\u2713";var u="\u2718";this.setUserPoints(q);return e==this.getUserPoints()?k:u},enableInteractivity:function(){var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("enable");var e=$(d).data("Text");$(d).empty();this.prepareTileHTML(d,e)}},disableInteractivity:function(){var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("disable")}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},postProcess:function(){},showTooltip:function(e,b,d,a){if(this.tooltip==null){this.tooltip=document.createElement("div");$(this.contentDiv).append(this.tooltip);$(this.tooltip).addClass("interactiveimagetooltip");$(this.tooltip).css("position","absolute");$(this.tooltip).css("background-color","white");$(this.tooltip).css("border","1px solid black");$(this.tooltip).css("border-radius","10px");$(this.tooltip).css("padding","10px")}$(this.tooltip).css("left",d);$(this.tooltip).css("top",a);$(this.tooltip).text(b);$(this.tooltip).show()},hideTooltip:function(){$(this.tooltip).hide()},addClickListener:function(b){var a=this;$(b).click(function(d){var f=d.offsetX;var e=d.offsetY;a.processClick(a,f,e)})},processClick:function(k,n,m){$(".interactiveimagetooltip").hide();var q=$(this.imageDiv).width();var w=$(this.imageDiv).height();var v=n/q;var a=m/w;var p=String.fromCharCode(97+Math.floor(v*20));var x=Math.floor(a*20);for(var u=0;u<this.clickArray.length;u++){var y=this.clickArray[u];var t=y.startRow;var e=y.startColumn;var r=y.endRow;var b=y.endColumn;var h=e.toLowerCase().charCodeAt(0)-97+1;var d=b.toLowerCase().charCodeAt(0)-97+1;var s=h*(5/100);var l=t*(5/100)+0.05;var o=d*(5/100);var f=r*(5/100)+0.05;if((v>=(s-0.05))&&(v<o)){if((a>=(l-0.05))&&(a<f)){k.processClickAction(k,y,n,m);return}}}},processClickAction:function(d,a,h,f){var b=a.Action;switch(b){case"Show Feedback":d.showTooltip(d.contentDiv,a.Feedback,h,f);break;case"Jump to Page":var e={checkedOption:null,checkedValue:null};e.checkedOption=a.Action;e.checkedValue=a.Value;d.clickAndBranch(d,e);break;case"Add Overlay":var e={checkedOption:null,checkedValue:null};e.checkedOption=a.Action;e.checkedValue=a.Value;d.clickAndBranch(d,e);break;default:}},clickAndBranch:function(b,d){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=d.checkedOption;a.checkedValue=d.checkedValue;this.mediators[jet.view.mediator.PageMediator.NAME].executeBranch(a,true)}},{NAME:"InteractiveImagePage"});$(this.myDiv).attr("id",this.uid);puremvc.define({name:"jet.view.page.InterviewPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("InterviewPage");$(this.myDiv).addClass("chip_medium");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.contentDiv).addClass("chip_light");$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.mediators[jet.view.mediator.PageMediator.NAME].showMeter()}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].hideMeter()}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="calcNodeOptions"){f.calcOptions=this.cloneBranchOptions(d)}else{f.branchOptions=d}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("interviewerStem");a.addContentClass("d_stem");a.addContentClass("chip_light");this.questionStem=h}else{if(k.match("distractor.*")){if(h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.enable=f.enable;a.disable=f.disable;a.enable();if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d);a.addContentClass("interviewerDistractor");a.addContentClass("chip_light");a.addContentClass("d_distractor")}}}else{if(k=="points"){h=h.length>0?h:"1";this.pointValues.push(h)}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("interviewImage");a.addClass("chip_light");break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);var a=-1000;for(var b=0;b<this.pointValues.length;b++){var d=parseFloat(this.pointValues[b]);if(d>a){a=d}}this.setTotalPoints(a)},postProcess:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showMeter("Meter",100,100)},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},evaluateUserActivity:function(){this.disableInteractivity();this.storeUserFeedback();return this.getHideAnswer()=="false"?correctAnswers:"Submitted"},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;a.disable();$(b).hover(function(){$(this).animate({"background-color":"#d7d7d7"},1000,function(){})},function(){$(this).animate({"background-color":"transparent"},1000,function(){})});$(b).removeAttr("disabled","disabled");$(b).bind("click",function(){d.setBranchingComponent(a);d.handleEvent(b,jet.AppConstants.TEXT,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).attr("disabled","disabled")},getName:function(){return"InterviewPage"},addFeedback:function(b,d){if(this.getHideAnswer()=="false"){var a=document.createElement("div");a.className="feedback";$(this.contentDiv).append(a);this.feedBackComponents.push(a);$(a).css("position","absolute");$(a).css("top",b.getY());$(a).css("left",10);$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}}},{NAME:"InterviewPage"});puremvc.define({name:"jet.view.page.JournalPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("JournalPage");$(this.myDiv).addClass("chip_light");this.printAnchor=document.createElement("a");$(this.printAnchor).addClass("printAnchor");this.printImage=document.createElement("img");this.printImage.src="lib/css/images/icon-print.png";$(this.printImage).addClass("printImage");$(this.printAnchor).append(this.printImage);this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[]}},{printAnchor:null,printImage:null,originalMessage:"",scoreMessage:"",components:null,show:function(a){if(a){this.mediators[jet.view.mediator.PageMediator.NAME].requestJournalReport();$(this.myDiv).show()}else{$(this.myDiv).hide()}},buildComponent:function(d,b,a,e){if(b==jet.AppConstants.ACCESSIBILITY_TEXT&&e.length>0){this.setAlternativeContent(e)}},handleText:function(a){},processComponents:function(){$(this.myDiv).attr("id",this.uid)},processUserResponse:function(d){var e=d.split(/[\n|\r|\r\n]/);var b="";for(var a=0;a<e.length;a++){b+=e[a]+"<br>"}return b},processNotification:function(d,a){switch(d){case jet.AppConstants.REPORT_TO_JOURNAL:var k="";var l=a;for(var f=0;f<l.length;f++){var b=l[f];var h="<p><strong>"+b.heading+"</strong></p>";var e=this.processUserResponse(b.response);h+="<p class='reportParagraph'>"+e+"</p>";k+=h}$(this.myDiv).html(k);$(this.myDiv).prepend(this.printAnchor);$(this.printAnchor).on("click",function(n){var m=window.open("","","height=400,width=400");n.stopPropagation();m.document.write(k);m.document.close();m.focus();m.print();m.close()});break}},getContentDivx:function(){return this.myDiv},getContentAsResourcex:function(){return"REPARENT"},getReParentedContentx:function(){return this},},{NAME:"JournalPage"});puremvc.define({name:"jet.view.page.Layout1Page",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("Layout1Page");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.topDiv=document.createElement("div");this.topDiv.className="layout1TopDiv";$(this.contentDiv).append(this.topDiv);this.bottomDiv=document.createElement("div");this.bottomDiv.className="layout1BottomDiv";$(this.contentDiv).append(this.bottomDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,topDiv:null,bottomDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="checkedNodeOptions"){f.checkedBranchOptions=d}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k.match("dialog_1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParentAndPosition(f.topDiv,f,"append");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("layout1Dialog1");a.removeContentClass("text")}}else{if(k.match("dialog_2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParentAndPosition(f.bottomDiv,f,"prepend");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("layout1Dialog2");a.removeContentClass("text")}}else{if(k.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(k=="totalpoints"){this.setTotalPoints(h)}}}}break;case jet.AppConstants.COMBO_BOX:var k=f.getTag(b);if(k=="questionTypes"){this.createQuestionType(h)}if(k=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var k=f.getTag(b);if(k=="image_1"){var a=new jet.view.component.ImageComponent;a.setParentAndPosition(f.topDiv,f,"prepend");a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("layout1Image1")}if(k=="image_2"){var a=new jet.view.component.ImageComponent;a.setParentAndPosition(f.bottomDiv,f,"append");a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("layout1Image2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="hideAnswer"){f.setHideAnswer(h)}if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this},disableInteractivity:function(){var b=this;var a=b.getContentDiv()},processComponents:function(){$(this.myDiv).attr("id",this.uid)},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.DialogPage.USER_METRICS;var f=jet.view.page.DialogPage.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,f);this.sendGraphData(b,f);var k="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){k="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){k="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var a=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.getUID(),questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:a};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),d);return true?k:"Submitted"},sendGraphData:function(q,s){var n=this.scaleData("Criminal",q.Criminal);var f=this.scaleData("Education",q.Education);var o=this.scaleData("Family",q.Family);var r=this.scaleData("Leisure",q.Leisure);var k=this.scaleData("Companions",q.Companions);var w=this.scaleData("Alcohol",q.Alcohol);var b=this.scaleData("Procriminal",q.Procriminal);var a=this.scaleData("Antisocial",q.Antisocial);var v=[[o],[k],[n],[f],[r],[w],[b],[a]];var u=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var l=0;var t=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=v;d.ticks=u;d.seriesColors=e;d.series=h;d.minValue=l;d.maxValue=t;var m=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var p={};p.name="LEGEND";p.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];p.seriesColors=e;m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,p)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},},{NAME:"Layout1Page"});puremvc.define({name:"jet.view.page.LongAnswerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("LongAnswerPage");$(this.myDiv).addClass("chip_light");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,isUserCorrect:null,feedBackComponents:null,isSCORMDATA:false,longAnswerComponent:null,heading:null,feedback:null,pageID:"",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));var d=this.getMediator(jet.view.mediator.QuestionProcessorMediator.NAME).getUserResponse(this.uid);if(d!=null){this.longAnswerComponent.setUserInput(d)}this.isSCORMDATA=true;this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){$(this.myDiv).attr("data-uid",f.uid);switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="calcNodeOptions"){f.calcOptions=this.cloneBranchOptions(d)}if(k=="checkedNodeOptions"){f.branchOptions=d}break;case jet.AppConstants.CHECKBOX:if(h.toUpperCase()=="TRUE"){this.useRegEx=true;this.concatenateAnswerKeys()}var k=f.getTag(b);if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="totalpoints"){f.setTotalPoints(h)}else{if(k=="expression"){this.splitIntoAnswerKeys(h);var a=new jet.view.component.InputTextComponent;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a)}else{if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("d_stem")}else{if(k=="index"){this.pageID=h.trim();if(this.pageID==""){this.pageID="_unknown"}this.myDiv.id=this.pageID}else{if(k=="longAnswer"){var a=new jet.view.component.TextAreaComponent;this.longAnswerComponent=a;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("d_field");this.userInputComponents.push(a)}else{if(k=="instructions"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("d_instructions")}else{if(k=="feedback"){this.feedback=h}else{if(k=="heading"){f.heading=h.trim();$(this.myDiv).attr("data-heading",f.heading)}}}}}}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}},concatenateAnswerKeys:function(){if(this.answerKeys.length>1){var b=this.answerKeys[0];for(var a=0;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},evaluateUserActivity:function(){var b="Sent";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var a={heading:this.heading,response:this.userInputComponents[0].getUserInput(),page_ID:this.pageID};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserResponse(this.uid,a);return b},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]}},{NAME:"ShortAnswerPage"});puremvc.define({name:"jet.view.page.MatchingPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("MatchingPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.dragComponents=[];this.anchorComponents=[];this.targetComponents=[];this.feedBackComponents=[];this.randomNumbers=[];this.answerKeys=[]}},{tempXPos:0,tempYPos:0,originalAnchorTilePositions:[],originalDragTilePositions:[],targetComponents:[],feedBackComponents:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,isUserCorrect:null,questionStem:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,e,d,l,k){var m=b.getTag(d);var f;if(e==jet.AppConstants.ACCESSIBILITY_TEXT&&l.length>0){this.setAlternativeContent(l)}if(m=="totalpoints"){b.setTotalPoints(l)}else{if(m=="flowstatus"){if(l=="true"){b.setInFlow(false)}}else{if(e==jet.AppConstants.NODES_MANAGER){b.branchOptions=k;if(m=="checkedNodeOptions"){b.checkedBranchOptions=k}if(m=="uncheckedNodeOptions"){b.unCheckedBranchOptions=k}}else{if(e==jet.AppConstants.TEXT&&l.length>0){var h=getProperty(d,"tag");if(h!=null){if(h.tag=="instructions"){f=this.createComponent(b,d,l);this.setQuestionStem(l)}if(h.tag=="draggable"){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");this.targetComponents.push(a);f=this.createComponent(b,d,l);f.addClass("dragTile");this.originalDragTilePositions.push(f.getY());this.dragComponents.push(f);f.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}if(h.tag=="anchored"){f=this.createComponent(b,d,l);f.addClass("anchorTile");this.originalAnchorTilePositions.push(f.getY());this.anchorComponents.push(f)}}}}}}},postProcess:function(){for(var d=0;d<this.targetComponents.length;d++){var b=this.anchorComponents[d];var f=parseInt(b.getX(),10);var e=parseInt(b.getGutter(),10);var a=parseInt(b.getWidth(),10);this.targetComponents[d].setX(f+a+e);this.targetComponents[d].setY(b.getY())}},handleText:function(a){},createComponent:function(d,b,e){var a=new jet.view.component.AnchorTileComponent;a.setParent(d.myDiv);a.setProperties(b);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(e);return a},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].enableDraggable();this.dragComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].disableDraggable();this.dragComponents[a].disable()}},evaluateUserActivity:function(){this.disableInteractivity();var f="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var h=this.getTotalPoints()/this.dragComponents.length;for(var d=0;d<this.dragComponents.length;d++){var e=this.dragComponents[d].getIndexInArray();var b=this.anchorComponents[e];if(this.dragComponents[d].getY()!=b.getY()){f="\u2718";this.setIsUserCorrect(false);var a=parseInt((this.getUserPoints()-h)*10)/10;this.setUserPoints(a);this.addFeedback(this.dragComponents[d],false)}else{this.addFeedback(this.dragComponents[d],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return f},getBranchOptions:function(){return this.branchOptions},processComponents:function(){$(this.myDiv).attr("id",this.uid);for(var b=0;b<this.dragComponents.length;b++){this.randomNumbers.push(b)}this.shuffle(this.randomNumbers);if(this.dragComponents.length<=0){return}var k=this.dragComponents[0].getHeight();var h=100;for(var b=0;b<this.dragComponents.length;b++){var e=this.randomNumbers[b];var a=this.dragComponents[e];var d=parseInt($(".viewer").css("width"));var f=480;a.setX(f);a.setInitialX(f);a.setY(30);a.setInitialY(b*k+h);a.setZindex(10+b)}},shuffle:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},dragStart:function(a){},dragStop:function(l,m){this.showCheckAnswerButton();var k=parseInt($(l).css("top"),10);for(var h=0,b=10000,q=0;h<this.anchorComponents.length;h++){var e=Math.abs(k-this.anchorComponents[h].getY());if(e<b){b=e;q=h}}var d=this.anchorComponents[q];var n=this.dragComponents[m];var o=parseInt(d.getX(),10);var a=parseInt(d.getWidth(),10);var f=parseInt(d.getGutter(),10);var p=Math.abs(o+a-n.getX());if(p<n.getWidth()){n.setY(d.getY());n.setX(o+a+f)}else{n.animatePosition(n.getInitialX(),n.getInitialY(),1000)}},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},},{NAME:"MatchingPage"});puremvc.define({name:"jet.view.page.MenuPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("MenuPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.branchingComponents=[]}},{answerKeys:null,components:null,userInputComponents:null,branchOptions:null,branchingComponents:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.TEXT:var k=f.getTag(b);var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv,f);if(k=="stem"){$(a.contentDiv).addClass("instructionsContent")}if(k=="index"){$(a.contentDiv).hide()}else{if(h.length>0){a.enable=this.enableText;a.enable();a.addContentClass("menutext")}}f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d)}break;case jet.AppConstants.IMAGE:if(h.length<1){return}var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv,f);a.enable=this.enable;a.enable();a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("menu");this.userInputComponents.push(a);a.setIndexInArray(this.userInputComponents.length-1);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},handleText:function(a){},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a)},handleEvent:function(b,a){if(b==jet.AppConstants.IMAGE){switch(a){case"click":this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(this,true,null);break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(this,true,null);break}}},getName:function(){return"QuestionPage"},enable:function(){var b=this.page;var a=this;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(){b.setBranchingComponent(a);b.handleEvent(jet.AppConstants.IMAGE,"click")});$(this.contentDiv).css("cursor","pointer");$(this.contentDiv).bind("hover",function(){$(this).stop().animate({opacity:".5"},"slow")});$(this.contentDiv).bind("mousedown",function(){$(this).css("border-style","solid");$(this).css("border-width","1px")});$(this.contentDiv).bind("mouseout",function(){$(this).css("border-style","none");$(this).css("border-width","0px");$(this).stop().animate({opacity:"1"},"slow")})},enableText:function(){var b=this.page;var a=this;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(){b.setBranchOptions(a.getComponentLevelBranchOptions());b.handleEvent(jet.AppConstants.TEXT,"click")});$(this.contentDiv).css("cursor","pointer");$(this.contentDiv).bind("hover",function(){$(this).stop().animate({"background-color":"beige"},"slow")});$(this.contentDiv).bind("mousedown",function(){$(this).css("border-style","solid");$(this).css("border-width","1px")});$(this.contentDiv).bind("mouseout",function(){$(this).css("border-style","none");$(this).css("border-width","0px");$(this).stop().animate({"background-color":"transparent"},"slow")})}},{NAME:"MenuPage"});puremvc.define({name:"jet.view.page.OpenQuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("OpenQuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:"false",executedSetCustomScore:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,m,h,p,o){switch(m){case jet.AppConstants.NODES_MANAGER:f.branchOptions=o;break;case jet.AppConstants.TEXT:var q=f.getTag(h);if(q=="totalpoints"){f.setTotalPoints(p)}else{if(q=="textBlock"&&p.length>0){var n=new jet.view.component.ViewComponent;f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(n,h);var e=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=e.exec(p);var d=b[2];if(d==""){d=b[1]}var l=d;var k=l.split("&lt;s&gt;");for(var a=0;a<k.length;a++){if(k[a]!=null&&k[a]!=undefined){this.processQuestionComponent(k[a])}}}}break;case jet.AppConstants.CHECKBOX:var q=f.getTag(h);if(q=="hideAnswer"){f.setHideAnswer(p)}if(q=="flowstatus"){if(p=="true"){f.setInFlow(false)}}break;case jet.AppConstants.AUDIO:if(p.length<1){return}var n=new jet.view.component.HTMLAudioComponent;n.setMediaURL(p);n.setAudioOptions(o);n.setParent(this.myDiv);n.setProperties(h);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(n,h);this.components.push(n);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(p);break}},processQuestionComponent:function(m){var l=new jet.view.component.OpenQuestionComponent;this.components.push(l);l.setContentClass("qitem");l.setParent(this.contentDiv,this);var k=m.split("&lt;d&gt;");if(k!=null){l.addQuestionStem(k[0]);for(var d=1;d<k.length;d++){if(k[d]==null|k[d]==undefined){continue}var b="false";var a=/(\*)/;var f=k[d];if(a.test(f)){b="true"}var e=/\*/;var h=f.replace(e,"");l.addDistractor(h,b)}}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},calculateNumberOfCorrectAnswers:function(){var a=0;for(var b=0;b<this.answerKeys.length;b++){if(this.answerKeys[b]=="true"){a++}}return a},evaluateUserActivity:function(){this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var f=this.getTotalPoints()/this.calculateNumberOfCorrectAnswers();for(var d=0;d<this.userInputComponents.length&&d<this.answerKeys.length;d++){if(this.userInputComponents[d].getUserInput()!=this.answerKeys[d]){e="\u2718";this.setIsUserCorrect(false);var b=parseInt((this.getUserPoints()-f)*10)/10;this.setUserPoints(b);var a="\u2718";if(this.answerKeys[d]=="true"){a="\u25BA"}this.addFeedback(this.userInputComponents[d],a)}if(this.userInputComponents[d].getUserInput()==this.answerKeys[d]&&this.userInputComponents[d].getUserInput()=="true"){this.addFeedback(this.userInputComponents[d],"\u2713")}}return this.getHideAnswer()=="false"?e:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(d,e){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";var a=$(d.getDiv());$(a).prepend(b);this.feedBackComponents.push(b);$(b).css("position","relative");$(b).css("float","left");$(b).css("top","0px");$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()},getContentAsResource:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()}},{NAME:"OpenQuestionPage"});puremvc.define({name:"jet.view.page.OrganizerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="organizerPage";$(this.myDiv).addClass("chip_extralight");this.myDiv.id=a;this.instructionsDiv=document.createElement("div");this.instructionsDiv.className="instructions";$(this.instructionsDiv).css("width","75%");$(this.instructionsDiv).css("padding","10px");$(this.instructionsDiv).css("margin-left","10%");$(this.instructionsDiv).css("margin-right","10%");$(this.instructionsDiv).css("margin-bottom","20px");$(this.myDiv).append(this.instructionsDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="organizerContent";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.textArray=[];this.tileDivArray=[];this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[],};this.dropArea=document.createElement("div");this.dropArea.className="dropDiv";this.divRow1=document.createElement("div");this.divRow1.className="divRow";this.divRow1.id="Row1";this.divRow2=document.createElement("div");this.divRow2.className="divRow";this.divRow2.id="Row2";this.divRow3=document.createElement("div");this.divRow3.className="divRow";this.divRow3.id="Row3";this.divRow4=document.createElement("div");this.divRow4.className="divRow";this.divRow4.id="Row4";this.divRow5=document.createElement("div");this.divRow5.className="divRow";this.divRow5.id="Row5";this.divRow6=document.createElement("div");this.divRow6.className="divRow";this.divRow6.id="Row6";this.divRow7=document.createElement("div");this.divRow7.className="divRow";this.divRow7.id="Row7";this.divRow8=document.createElement("div");this.divRow8.className="divRow";this.divRow8.id="Row8";this.divRow9=document.createElement("div");this.divRow9.className="divRow";this.divRow9.id="Row9";this.divRow10=document.createElement("div");this.divRow10.className="divRow";this.divRow10.id="Row10";$(this.contentDiv).append(this.divRow1);$(this.contentDiv).append(this.divRow2);$(this.contentDiv).append(this.divRow3);$(this.contentDiv).append(this.divRow4);$(this.contentDiv).append(this.divRow5);$(this.contentDiv).append(this.divRow6);$(this.contentDiv).append(this.divRow7);$(this.contentDiv).append(this.divRow8);$(this.contentDiv).append(this.divRow9);$(this.contentDiv).append(this.divRow10)}},{rowHeight:40,initialLeft:700,mediator:null,xml:null,uid:null,components:null,arrayT:null,arrayI:null,arrayO:null,textArray:null,tileDivArray:null,rowArray:null,concatenatedArray:null,backgroundTile:null,instructionsDiv:null,branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},show:function(a){if(a){$(this.myDiv).show();this.getMediator(jet.view.mediator.PageMediator.NAME).reportUserActivity(this,this.uid)}else{$(this.myDiv).hide()}},showCheckAnswerButton:function(){this.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()},buildComponent:function(f,d,a,h,b){if(d==jet.AppConstants.DATA_INPUT&&h.length>0){var e=f.processXML(h);this.xml=h}if(d==jet.AppConstants.TEXT&&h.length>0){var k=f.getTag(a);if(k=="totalpoints"){f.setTotalPoints(h)}if(k=="instructions"){$(this.instructionsDiv).text(h)}if(k=="rowHeight"){this.rowHeight=parseInt(h)}}if(d==jet.AppConstants.IMAGE){this.backgroundTile=h;$(this.myDiv).css("background-image","url(base/"+h+")")}if(d==jet.AppConstants.ACCESSIBILITY_TEXT&&h.length>0){this.setAlternativeContent(h)}},processXML:function(k){this.xml=k;xmlDoc=$.parseXML(k);var f=$(xmlDoc).find("dataPage");for(var e=0;e<f.length;e++){var d=f[e];var n=$(d).find("Text")[0].textContent.trim();var b=$(d).find("Optional_Image")[0].textContent.trim();if(b!=""){n=b}var p=$(d).find("Row")[0].textContent.trim();var l=$(d).find("Position")[0].textContent.trim();var h=$(d).find("Italic")[0].textContent.trim();var o=$(d).find("Pinned")[0].textContent.trim();var a=$(d).find("OptionalWidth")[0].textContent.trim();var m={Text:n,Row:p,Position:l,Italic:h,Pinned:o,OptionalWidth:a};this.textArray.push(m)}this.renderTiles();this.pinTiles()},rowNumber:function(){var a=$(".rowNumber");a.attr("type","number");a.children().each(function(b,d){$(d).text((b+1)+". "+$(d).text())})},getTilesDiv:function(){return this.tilesDiv},getDropDiv:function(){return this.dropDiv},renderTiles:function(){var n=this;var a=this.getMediator(jet.view.mediator.PageMediator.NAME);var b=this.calcNumberOfUnpinnedTiles();var e=this.generateRandom(b);var l=0;var k=parseInt($(".viewer").css("height"));calcRowHeight=50;for(var f=0;f<this.textArray.length;f++){var d=this.textArray[f];var h=document.createElement("div");this.tileDivArray.push(h);$(this.contentDiv).append(h);$(h).height(40);$(h).data("Text",d.Text);$(h).data("Row",d.Row);$(h).data("Position",d.Position);var q=this.isTileDataPinned(d.Pinned);$(h).css("height","auto");$(h).data("Pinned",q);$(h).data("OptionalWidth",d.OptionalWidth);if(d.OptionalWidth.length>0){$(h).css("width",d.OptionalWidth+"px")}if(!this.doesDataShowPinned(d.Pinned)){var m=e[l]*calcRowHeight;$(h).css("top",m+"px");var o=100-(parseInt(m/k*100));$(h).css("z-index",10+o);$(h).addClass("initialState");$(h).addClass("chip_light");$(h).addClass("d_draggable");l++}else{$(h).addClass("Pinned")}$(h).css("position","absolute");$(h).css("left",this.initialLeft+"px");this.prepareTileHTML(h,d.Text);$(h).addClass("OrganizerTileDiv");if(d.Italic.toUpperCase()=="YES"){$(h).addClass("ItalicOrganizerTileDiv")}var p=this.rowHeight;$(h).draggable({start:function(){$(this).removeClass("tileInPosition");$(this).removeClass("initialState");$(this).removeClass("d_draggable");$(this).addClass("d_pinned");$(this).css("opacity","0.5")},stop:function(){var r=parseInt($(this).css("top"));var s=parseInt(r/p);var t=s*p+p;var u=t-r;var r=u>p/2?s*p:s*p+p;$(this).css("top",r+"px");$(this).addClass("tileInPosition");$(this).css("opacity","1");n.showCheckAnswerButton()}})}},doesDataShowPinned:function(a){if(typeof a=="undefined"||a==null){return false}if(a.length<1){return false}if(a.toUpperCase().indexOf("N")>-1){return false}if(a.toUpperCase().indexOf("Y")>-1){return true}return true},prepareTileHTML:function(d,f){if(f.toUpperCase().indexOf("JPG")>0||f.toUpperCase().indexOf("PNG")>0||f.toUpperCase().indexOf("JPEG")>0){var b="<img src = 'base/"+f+"'/>";$(d).html(b);var a=150;var h=parseInt($(d).css("width"));var e=Math.max(parseInt((h-a)/2),0);e=e+"px";$(d).css("margin-left",e);$(d).css("margin-right",e);$(d).removeAttr("height").removeAttr("width");$(d).css("height","").css("width","")}else{$(d).html(f)}},pinTiles:function(){for(var e=0;e<this.tileDivArray.length;e++){var d=this.tileDivArray[e];var b=$(d).data("Pinned");var k=$(d).data("Row");var a=$(d).data("Position");if(!this.doesDataShowPinned(b)){continue}var h=this.getXPositionInRow(k,a);var f=this.rowHeight*(k-1);$(d).css("left",h+"px");$(d).css("top",f+"px");$(d).draggable("disable")}},calcNumberOfUnpinnedTiles:function(){var b=0;for(var a=0;a<this.textArray.length;a++){var d=this.textArray[a];if(this.doesDataShowPinned(d.Pinned)){continue}b++}return b},isTileDataPinned:function(a){if(typeof a=="undefined"){return""}if(a.length<1){return""}if(a.toUpperCase().indexOf("NO")>-1){return""}return"yes"},getXPositionInRow:function(q,m){var p="row"+q;var o=this.tileDivArray;var k=0;for(var h=0;h<o.length;h++){var n=o[h];var l=$(n).data("Row");var f=$(n).data("Position");if(q!=l||f>=m){continue}var b=parseInt($(n).width());var d=parseInt($(n).css("margin-left"));var e=parseInt($(n).css("margin-right"));var a=b+d+e;k+=a}return k},getRowXRange:function(h,b,f){var a={lowX:-1,highX:-1};var k=b-1;var e=this.rowArray["row"+h];if(e.length>k){var d=e[k];a.lowX=this.getXPositionInRow(1,b)}if(e.length>k+1){var d=e[k+1];a.highX=this.getXPositionInRow(1,b+1)}return a},generateRandom:function(b){var a=new Array(b);for(var e=0;e<b;e++){a[e]=e}for(var e=b-1;e>0;e--){var h=Math.random()*(b-1);var f=Math.round(h);var d=a[e];a[e]=a[f];a[f]=d}return a},getNumberOfTexts:function(){var a=0;for(text in this.tiles){a++}return a},resetRowArrays:function(){this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[]}},placeInArray:function(e,f){var b=parseInt($(e).css("left"));for(var d=0;d<f.length;d++){var a=parseInt($(f[d]).css("left"));if(b<a){f.splice(d,0,e);return}}f.push(e)},concatenateArrays:function(){this.concatenatedArray=[];for(var b in this.rowArray){var d=this.rowArray[b];for(var a=0;a<d.length;a++){this.concatenatedArray.push(d[a])}}},evaluateUserActivity:function(){this.disableInteractivity();var a=this.rowHeight;var o=this.tileDivArray;var k=this.getTotalPoints();var b=o.length;ratio=k/b;var d=this.calculateFirstRow(o);for(var f=0;f<o.length;f++){var l=o[f];var n=parseInt($(l).css("top"));switch(n){case d:this.placeInArray(l,this.rowArray.row1);break;case d+1*a:this.placeInArray(l,this.rowArray.row2);break;case d+2*a:this.placeInArray(l,this.rowArray.row3);break;case d+3*a:this.placeInArray(l,this.rowArray.row4);break;case d+4*a:this.placeInArray(l,this.rowArray.row5);break;case d+5*a:this.placeInArray(l,this.rowArray.row6);break;case d+6*a:this.placeInArray(l,this.rowArray.row7);break;case d+7*a:this.placeInArray(l,this.rowArray.row8);break;case d+8*a:this.placeInArray(l,this.rowArray.row9);break;case d+9*a:this.placeInArray(l,this.rowArray.row10);break}}this.concatenateArrays();var q=1;for(var m in this.rowArray){this.evaluateArray(this.rowArray[m],q,ratio);q++}var h="\u2713";var e="\u2718";var p=this.getUserPoints();if(p>0.99*this.getTotalPoints()){this.setUserPoints(Math.ceil(this.getUserPoints()))}return k==this.getUserPoints()?h:e},calculateFirstRow:function(a){var f=500;for(var d=0;d<a.length;d++){var e=a[d];var b=parseInt($(e).css("top"));var h=parseInt($(e).css("left"));if(b<f&&h<this.initialLeft){f=b}}return f},evaluateArray:function(l,b,o){var k=this.getUserPoints();for(var e=0;e<l.length;e++){var m=l[e];var h=$(m).data("Position");var s=$(m).data("Row");var d=this.doesDataShowPinned($(m).data("Pinned"))?"":"&nbsp;&nbsp;\u2713";var p=2;if(($.isNumeric(h)||this.isWild(h))&&($.isNumeric(s)||this.isWild(s))){p=2}else{if($.isNumeric(h)){p=1}else{p=0}}switch(p){case 0:if(b!=s){$(m).append("&nbsp;&nbsp;\u2718")}else{k+=o}if(b==s){$(m).append(d)}break;case 1:var r=this.concatenatedArray[h-1];if(m!==r){$(m).append("&nbsp;&nbsp;\u2718")}else{k+=o}if(m===r){$(m).append(d)}break;case 2:var q=$(m).text();var a=this.getRowXRange("1",h,q);var f=parseInt($(m).css("left"));var n=this.isCorrectPosition(s,h,e,l[e],a,f,q,this.isWild(s));if((b!=s&&!this.isWild(s))||(!n&&!this.isWild(h))){$(m).append("&nbsp;&nbsp;\u2718")}else{k+=o;$(m).append(d)}break}this.setUserPoints(k)}},isCorrectPosition:function(n,f,h,k,a,d,m,b){var e=false;var l=0.9;if(!b){if(f!=h+1){e=false}else{e=true}}else{if(a.lowX>-1&&a.highX>-1){type=2}else{if(a.lowX>1){type=1}else{type=0}}switch(type){case 0:e=false;break;case 1:if(d>=(a.lowX*l)){e=true}break;case 2:if(d>=(a.lowX*l)&&d<a.highX*l){e=true}break}}return e},isWild:function(a){return a=="*"?true:false},enableInteractivity:function(){this.resetRowArrays();var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("enable");var e=$(d).data("Text");$(d).empty();this.prepareTileHTML(d,e)}},disableInteractivity:function(){var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("disable")}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},postProcess:function(){}},{NAME:"OrganizerPage"});puremvc.define({name:"jet.view.page.QuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("QuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tempArray=[];this.isMultipleChoice="false"}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tempArray:null,isMultipleChoice:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components);if(typeof MathJax!=="undefined"&&MathJax.Hub){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.contentDiv])}}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,k,e){switch(f){case jet.AppConstants.NODES_MANAGER:var l=h.getTag(d);if(l=="checkedNodeOptions"){h.checkedBranchOptions=e}if(l=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.TEXT:var l=h.getTag(d);if(l=="totalpoints"){h.setTotalPoints(k)}else{if(l=="textBlock"&&k.length>0){this.textBlockComponent=new jet.view.component.ViewComponent;this.textBlockComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.textBlockComponent,d);this.textBlockComponent.setText(k);$(this.myDiv).addClass("LayoutB");h.setQuestionTextBlock(k)}if(l=="stem"){this.stemComponent=new jet.view.component.ViewComponent;this.stemComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.stemComponent,d);this.stemComponent.setText(k);this.stemComponent.addContentClass("stem");h.setQuestionStem(k)}else{if(l.match("distractor.*")){var b=new jet.view.component.ViewComponent;b.setParent(h.contentDiv);this.distractorComponents.push(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);b.setText(k);b.addContentClass("distractor");b.addContentClass(l);if(e!=null){this.branchingComponents.push(b);b.setIndexInArray(this.branchingComponents.length-1);b.setComponentLevelBranchOptions(e)}}}}break;case jet.AppConstants.CHECKBOX:var l=h.getTag(d);if(l=="hideAnswer"){h.setHideAnswer(k)}else{if(l=="flowstatus"){if(k=="true"){h.setInFlow("false")}}else{if(l=="randomstatus"){if(k=="true"){h.setRandomStatus("true")}}else{if(l=="MC"){if(k=="true"){h.setIsMultipleChoice("true")}}else{var a={type:f,text:k,properties:d,tag:l};this.tempArray.push(a)}}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(k);break;case jet.AppConstants.AUDIO:if(k.length<1){return}this.audioComponent=new jet.view.component.HTMLAudioComponent;this.audioComponent.setMediaURL(k);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},setIsMultipleChoice:function(a){this.isMultipleChoice=a},getIsMultipleChoice:function(){return this.isMultipleChoice},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}this.prepareQuestion()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},makeAnswerComponents:function(){var b=this.getIsMultipleChoice();for(var e=0;e<this.tempArray.length;e++){var f=this.tempArray[e];var d=b=="false"?new jet.view.component.CheckBoxComponent:new jet.view.component.RadioButtonComponent;d.setParent(this.contentDiv,this);this.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(d,f.properties);this.answerKeys.push($.trim(f.text));this.userInputComponents.push(d);d.setIndexInArray(this.userInputComponents.length-1);d.addContentClass(f.tag);var a=document.createElement("div");a.className="feedback";$(a).addClass("d_feedback");this.feedBackComponents.push(a)}},processComponents:function(){$(this.myDiv).attr("id",this.uid);this.makeAnswerComponents();for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){var e=[];$(this.contentDiv).empty();if(this.audioComponent!=undefined&&this.audioComponent!=null){this.audioComponent.setParent(this.myDiv)}if(this.textBlockComponent!=undefined&&this.textBlockComponent!=null){$(this.textBlockComponent.getContentDiv()).removeAttr("style");$(this.textBlockComponent.getContentDiv()).css("position","static");$(this.textBlockComponent.getContentDiv()).css("margin-bottom","0px");$(this.textBlockComponent.getContentDiv()).css("margin-top","10px");$(this.textBlockComponent.getContentDiv()).css("height","155px");this.textBlockComponent.setParent(this.contentDiv)}if(this.imageComponent!=undefined&&this.imageComponent!=null){$(this.imageComponent.getContentDiv()).removeAttr("style");$(this.imageComponent.getContentDiv()).css("position","static");$(this.imageComponent.getContentDiv()).css("margin-bottom","0px");$(this.imageComponent.getContentDiv()).css("margin-top","10px");$(this.imageComponent.getContentDiv()).css("height","240px");this.imageComponent.setParent(this.contentDiv)}$(this.stemComponent.getContentDiv()).removeAttr("style");$(this.stemComponent.getContentDiv()).css("position","static");$(this.stemComponent.getContentDiv()).css("margin-bottom","20px");$(this.stemComponent.getContentDiv()).css("margin-top","20px");this.stemComponent.setParent(this.contentDiv);for(var f=0;f<this.userInputComponents.length;f++){e.push(f)}if(this.randomStatus=="true"){for(var f=e.length-1;f>0;f--){var m=e[f];var k=parseInt(Math.random()*(f+1));e[f]=e[k];e[k]=m}}for(var f=0;f<this.userInputComponents.length;f++){var h=e[f];var o=this.distractorComponents[h];var b=o.getText();if(b==null||b==undefined||b.length<1){continue}var n=document.createElement("div");$(this.contentDiv).append(n);n.className="distractorHost";$(n).removeAttr("style");$(n).css("position","static");$(n).css("margin-top","10px");$(n).css("margin-bottom","40px");$(n).css("display","block");var a=this.feedBackComponents[h];$(n).append(a);$(a).css("height","10px");$(a).css("width","10px");var l=this.userInputComponents[h];l.removeFromParent();$(l.getContentDiv()).removeAttr("style");l.setParent(n,this);$(l.getContentDiv()).css("margin-right","20px");$(l.getContentDiv()).css("margin-left","50px");var d=this.distractorComponents[h];d.removeFromParent();$(d.getContentDiv()).removeAttr("style");d.setParent(n,this);$(".componentX").remove()}},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var n="";this.disableInteractivity();var a="";var d="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());for(var h=0;h<this.userInputComponents.length&&h<this.answerKeys.length;h++){if(this.userInputComponents[h].getUserInput()=="true"){var m=this.distractorComponents[h];a+=m.getText()+"; ";if(this.branchingOptionArray[h]&&this.branchingOptionArray[h].feedback){n+=this.branchingOptionArray[h].feedback+"<br />"}}if(this.userInputComponents[h].getUserInput()!=this.answerKeys[h]){d="\u2718";this.setIsUserCorrect(false);var b="\u2718";if(this.answerKeys[h]=="true"){b="\u25BA"}this.addFeedback(h,b);this.setUserPoints(0)}if(this.userInputComponents[h].getUserInput()==this.answerKeys[h]&&this.userInputComponents[h].getUserInput()=="true"){this.addFeedback(h,"\u2713")}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){n=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){n=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=n}var f=this.questionStem;var o=this.getIsUserCorrect()?"correct":"incorrect";var l="";for(var k=0;k<this.answerKeys.length;k++){if(this.answerKeys[k]=="true"){l+=this.distractorComponents[k].getText()+"; "}}var e={uid:this.getUID(),questionType:"choice",question:f.substring(0,249),learnerResponse:a,correctResponse:l,result:o};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),e);return this.getHideAnswer()=="false"?d:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},},{NAME:"QuestionPage"});puremvc.define({name:"jet.view.page.RCCCDialogPageType1",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{pageID:null,doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{this.initGadgets();b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="checkedNodeOptions"){f.checkedBranchOptions=d}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="index"){this.pageID=h}if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(k.match("dialog1")){if(h&&h.length>0){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}}else{if(k.match("dialog2")){if(h&&h.length>0){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}}else{if(k.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(k.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(k=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var k=f.getTag(b);if(k=="questionTypes"){this.createQuestionType(h)}if(k=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var k=f.getTag(b);if(k=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(k=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="hideAnswer"){f.setHideAnswer(h)}if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var a=jet.view.page.RCCCDialogPageType1.USER_METRICS;var n=jet.view.page.RCCCDialogPageType1.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,a);this.setMetrics(this.correctRating,n);this.sendGraphData(a,n);var b="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer==null){this.userAnswer=""}var m=this.getNormalizedAnswer(this.userAnswer);var l=this.getNormalizedAnswer(this.correctRating);if(m!=l){b="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null&&this.isUserCorrect){var f=this.additionalInfoInput.getUserInput().toUpperCase();var k=this.additionalInfo.toUpperCase().split("|");for(var h=0;h<k.length;h++){if(f!=k[h]){b="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}else{b="\u2713";this.setIsUserCorrect(true);break}}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var o=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.uid,questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:o};jet.view.page.RCCCDialogPageType1.USER_RESPONSES.push(d);this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,d);return true?b:"Submitted"},getNormalizedAnswer:function(a){switch(a.trim()){case"0":return"0";case"1":return"0";case"2":return"2";case"3":return"2";default:return a.trim()}},sendGraphData:function(q,s){var n=this.scaleData("Criminal",q.Criminal);var f=this.scaleData("Education",q.Education);var o=this.scaleData("Family",q.Family);var r=this.scaleData("Leisure",q.Leisure);var k=this.scaleData("Companions",q.Companions);var w=this.scaleData("Alcohol",q.Alcohol);var b=this.scaleData("Procriminal",q.Procriminal);var a=this.scaleData("Antisocial",q.Antisocial);var v=[[o],[k],[n],[f],[r],[w],[b],[a]];var u=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var l=0;var t=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=v;d.ticks=u;d.seriesColors=e;d.series=h;d.minValue=l;d.maxValue=t;var m=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var p={};p.name="LEGEND";p.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];p.seriesColors=e;m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,p)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},initGadgets:function(){if(jet.view.page.RCCCDialogPageType1.INIT_GADGETS){return}jet.view.page.RCCCDialogPageType1.INIT_GADGETS=true;var l=1;var n=2;var f=1;var d=5;var p=1;var a=3;var r=1;var m=1;var k=[[f],[p],[l],[n],[d],[a],[r],[m]];var q=["2=Low, 3=Med, 4=High"];var b=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var e={};e.name="BARGRAPH";e.data=k;e.ticks=q;e.seriesColors=b;e.series=h;var s=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);s.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,e);var o={};o.name="LEGEND";o.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];o.seriesColors=b;s.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,o)},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:return 0;case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 0;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 0;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"RCCCDialogPageType1",USER_RESPONSES:[]});puremvc.define({name:"jet.view.page.RCCCDialogPageType2",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");$(this.myDiv).addClass("DialogItemPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);this.itemContainerDiv=document.createElement("div");this.itemContainerDiv.className="dialogItemContainer";$(this.contentDiv).append(this.itemContainerDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.rcccCheckboxComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,itemContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,rcccCheckboxComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,dataXML:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.processXML(this.dataXML)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="checkedNodeOptions"){f.checkedBranchOptions=d}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.DATA_INPUT:this.dataXML=h;break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(k.match("dialog1")){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}else{if(k.match("dialog2")){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}else{if(k.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(k.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(k=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var k=f.getTag(b);if(k=="questionTypes"){this.createQuestionType(h)}if(k=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var k=f.getTag(b);if(k=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(k=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="hideAnswer"){f.setHideAnswer(h)}if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.RCCCDialogPageType1.USER_METRICS;var o=jet.view.page.RCCCDialogPageType1.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,o);this.sendGraphData(b,o);var d="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}var l=this.rcccCheckboxComponents;for(var k=0;k<l.length;k++){var m=l[k];var n=$(m).data("isChecked").toUpperCase().contains("YES");var a=$(m).get(0).checked;if(n!=a){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);$(m).css("outline","1px solid #1e0000")}}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var f=this.domainType+"_"+this.questionStem;var p=this.getIsUserCorrect()?"correct":"incorrect";var e={uid:this.uid,questionType:"choice",question:f.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:p};jet.view.page.RCCCDialogPageType1.USER_RESPONSES.push(e);this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,e);return true?d:"Submitted"},sendGraphData:function(q,s){var n=this.scaleData("Criminal",q.Criminal);var f=this.scaleData("Education",q.Education);var o=this.scaleData("Family",q.Family);var r=this.scaleData("Leisure",q.Leisure);var k=this.scaleData("Companions",q.Companions);var w=this.scaleData("Alcohol",q.Alcohol);var b=this.scaleData("Procriminal",q.Procriminal);var a=this.scaleData("Antisocial",q.Antisocial);var v=[[o],[k],[n],[f],[r],[w],[b],[a]];var u=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var l=0;var t=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=v;d.ticks=u;d.seriesColors=e;d.series=h;d.minValue=l;d.maxValue=t;var m=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var p={};p.name="LEGEND";p.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];p.seriesColors=e;m.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,p)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 1;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 1;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}},processXML:function(d){this.rcccCheckboxComponents=[];$(this.itemContainerDiv).empty();this.xml=d;xmlDoc=$.parseXML(d);var b=$(xmlDoc).find("dataPage");for(var f=0;f<b.length;f++){var e=b[f];var k=$(e).find("Item")[0].textContent.trim();var a=$(e).find("Question_Number")[0].textContent.trim();var l=$(e).find("isChecked")[0].textContent.trim();var h={item:k,question_number:a,isChecked:l,};this.renderQuestion(h)}},renderQuestion:function(f){var b=false;var d=document.createElement("div");d.className="dialogItem";var e=document.createElement("input");this.rcccCheckboxComponents.push(e);e.className="dialogCheckbox";e.type="checkbox";$(e).data("isChecked",f.isChecked);if(this.getUserResponse(f.question_number)){e.checked=true}else{e.checked=false}var a=document.createElement("div");a.className="dialogItemPart";$(a).html(f.item);$(d).append(e);$(d).append(a);$(d).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20});$(this.itemContainerDiv).append(d);$(this.itemContainerDiv).layout({type:"flow",resize:true,alignment:"left",vgap:10,hgap:20})},getUserResponse:function(b){if(b==undefined||b==null){return false}if(!this.isNumber(b)){return false}var d=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;if(d==null||d==undefined){return false}for(var f=0;f<d.length;f++){var a=d[f].question.trim();var h=d[f].learnerResponse.toUpperCase();var e;var l=/.*_(\d*).*/;var k=l.exec(a);var e=k[1];if(e==b){if(h=="YES"||h=="0"||h=="1"){return true}}}return false},isNumber:function(a){return !isNaN(a-0)&&a!==null&&a!==""&&a!==false}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"RCCCDialogPageType2"});puremvc.define({name:"jet.view.page.RCCCEvaluationPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("RCCCEvaluationPage");this.myDiv.id=a;this.reportDiv=document.createElement("div");this.reportDiv.className="reportDiv";$(this.reportDiv).attr("id","reportDiv");this.legendDiv=document.createElement("div");this.legendDiv.className="legendDiv";$(this.legendDiv).attr("id","legendDiv");$(this.legendDiv).attr("width","650px");this.barGraphDiv=document.createElement("div");this.barGraphDiv.className="evaluationBargraph";this.barGraphID="barGraph_"+jet.view.page.RCCCEvaluationPage.INSTANCE_ID++;$(this.barGraphDiv).attr("id",this.barGraphID);this.labelsDiv=document.createElement("div");this.labelsDiv.className="labelsDiv";$(this.labelsDiv).attr("id","labelsDiv");$(this.labelsDiv).attr("width","650px");this.graphScaleExplanationDiv=document.createElement("div");this.graphScaleExplanationDiv.className="graphScaleExplanationDiv";$(this.graphScaleExplanationDiv).attr("id","graphScaleExplanationDiv");$(this.graphScaleExplanationDiv).attr("width","650px");this.components=[];this.userInputComponents=[];$(".viewer").append(this.myDiv);$(this.myDiv).append(this.reportDiv);$(this.myDiv).append(this.legendDiv);$(this.myDiv).append(this.barGraphDiv);$(this.myDiv).append(this.labelsDiv);$(this.myDiv).append(this.graphScaleExplanationDiv);this.buildLegend(this.legendDiv);this.buildGraphLabels(this.labelsDiv);this.buildGraphScaleExplanation(this.graphScaleExplanationDiv)}},{uid:null,originalMessage:"",scoreMessage:"",riskScoreMessage:"",logMessage:"",components:null,barGraphDiv:null,legendDiv:null,labelsDiv:null,graphScaleExplanationDiv:null,reportDiv:null,barGraphID:0,show:function(a){if(a){$(this.myDiv).show();$(this.legendDiv).show();this.mediators[jet.view.mediator.PageMediator.NAME].requestReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestFeedbackReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestObjectiveAnswersReport();this.sendGraphData(jet.view.page.RCCCDialogPageType1.USER_METRICS,jet.view.page.RCCCDialogPageType1.EXPERT_METRICS)}else{$(this.myDiv).hide();$(this.legendDiv).hide()}},buildComponent:function(d,b,a,e){if(b==jet.AppConstants.TEXT){$(this.reportDiv).html(e);if(e.length>0){this.originalMessage=e}}},handleText:function(a){},processComponents:function(){},requestConfirmation:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmation()},handleShow:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmationReport()},processNotification:function(x,m){var l=this.components[this.components.length-1];switch(x){case jet.AppConstants.REPORT_INTERNALLY:var s=0;var v=0;s=m.scoreTotal;v=m.userTotal;this.scoreMessage="<hr><p class='reportDiv'>Questions correctly assessed: "+v+"/"+s+"</p><p class='reportDiv'>Scoring Accuracy: "+parseInt(v/s*100)+"%";var w=this.getRiskScore();this.riskScoreMessage="<hr><p class='riskScoreExplanation'>Your risk score: <span class='riskScore'>"+w.userRiskScore+"</span> <span class='riskScoreExplanation'>Our risk score:</span><span class='riskScore'>"+w.expertRiskScore+"</span></p>";var b=this.getProtectiveFactorScore();this.riskScoreMessage+="<hr><p class='riskScoreExplanation'>Your protective factors score: <span class='protectiveScore'>"+b.userPFScore+"</span> <span class='riskScoreExplanation'>  Our protective factors score: </span><span class='protectiveScore'>"+b.expertPFScore+"</span></p>";var n=this.originalMessage+this.scoreMessage+this.riskScoreMessage+this.logMessage;$(this.reportDiv).html(n);this.requestConfirmation();break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLYX:var n=this.originalMessage+this.scoreMessage;var a=m;for(var q=0;q<m.length;q++){var e=m[q];if((e.feedback!=null&&e.feedback!=undefined)&&(e.feedback.length>0)){n+="<p>Q: "+e.question+"</p>";n+="<p>Feedback: "+e.feedback+"</p>"}}l.setText(n);break;case jet.AppConstants.REQUEST_CONFIRMATION:var n=this.originalMessage+this.scoreMessage+this.riskScoreMessage;var t=new Date();var u=t.getDate();var r=t.getMonth()+1;var o=t.getFullYear();var f=t.getHours();var p=t.getMinutes();var d="<p>Requested confirmation at "+r+"/"+u+"/"+o+" "+f+":"+p+"</p>";d="";this.logMessage+=d;$(this.reportDiv).html(n+this.logMessage);break;case jet.AppConstants.REPORT_CONFIRMATION:var n=this.originalMessage+this.scoreMessage+this.riskScoreMessage;var t=new Date();var u=t.getDate();var r=t.getMonth()+1;var o=t.getFullYear();var f=t.getHours();var p=t.getMinutes();var k=m;var h="";switch(k.status){case"Success":h=" Received confirmation at "+r+"/"+u+"/"+o+" "+f+":"+p;h+=" Score Reported: "+k.rawValue;break;case"Failure":h="Received confirmation at "+r+"/"+u+"/"+o+" "+f+":"+p;h+=" "+k.message+" ";break;default:h="<p>Something unexpected happened.</p>";break}this.logMessage+=h;$(this.reportDiv).html(n+this.logMessage);break}},buildLegend:function(a){this.createLegendPart("Family",a,"#ebb207");this.createLegendPart("Companions",a,"#cc0606");this.createLegendPart("Criminal",a,"#cc0606");this.createLegendPart("Education",a,"#ffff70");this.createLegendPart("Leisure",a,"#ffff70");this.createLegendPart("Alcohol",a,"#ebb207");this.createLegendPart("Procriminal",a,"#cc0606");this.createLegendPart("Antisocial",a,"#cc0606");$(a).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:30})},createLegendPart:function(d,e,a){var b=document.createElement("div");b.className="legendPart";$(e).append(b);$(b).html(d+" <font color="+a+">&#x2588;</font>")},createGraphScalePart:function(d,e,a){var b=document.createElement("div");b.className="graphScalePart";$(e).append(b);$(b).html(" <font color="+a+">"+d+"</font>")},createLabelPart:function(f,h,b,a){b="#999999";var e=0;left=e+a*82;f=f+"          ";f=f.substring(0,11);var d=document.createElement("div");d.className="labelPart";$(d).css("left",left);$(d).css("top","0px");$(h).append(d);$(d).html(" <font color="+b+">"+f+"</font>")},buildGraphLabels:function(a){this.createLabelPart("Family",a,"#ebb207",0);this.createLabelPart("Companions",a,"#cc0606",1);this.createLabelPart("Criminal",a,"#cc0606",2);this.createLabelPart("Education",a,"#ffff70",3);this.createLabelPart("Leisure",a,"#ffff70",4);this.createLabelPart("Alcohol",a,"#ebb207",5);this.createLabelPart("Procriminal",a,"#cc0606",6);this.createLabelPart("Antisocial",a,"#cc0606",7)},buildGraphScaleExplanation:function(a){this.createGraphScalePart("1=Very Low",a,"#000000");this.createGraphScalePart("2=Low",a,"#000000");this.createGraphScalePart("3=Medium",a,"#000000");this.createGraphScalePart("4=High",a,"#000000");this.createGraphScalePart("5=Very High",a,"#000000");$(a).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},sendGraphData:function(t,v){var r=this.scaleData("Criminal",t.Criminal);var k=this.scaleData("Education",t.Education);var s=this.scaleData("Family",t.Family);var u=this.scaleData("Leisure",t.Leisure);var m=this.scaleData("Companions",t.Companions);var A=this.scaleData("Alcohol",t.Alcohol);var b=this.scaleData("Procriminal",t.Procriminal);var a=this.scaleData("Antisocial",t.Antisocial);var n=this.scaleData("Criminal",v.Criminal);var h=this.scaleData("Education",v.Education);var p=this.scaleData("Family",v.Family);var q=this.scaleData("Leisure",v.Leisure);var o=this.scaleData("Companions",v.Companions);var w=this.scaleData("Alcohol",v.Alcohol);var y=this.scaleData("Procriminal",v.Procriminal);var d=this.scaleData("Antisocial",v.Antisocial);var z=[[s],[p],[m],[o],[r],[n],[k],[h],[u],[q],[A],[w],[b],[y],[a],[d]];var x=[""];var f=["#ebb207","#00e700","#cc0606","#00e700","#cc0606","#00e700","#ffff70","#00e700","#ffff70","#00e700","#ebb207","#00e700","#cc0606","#00e700","#cc0606","#00e700"];var l=[{label:"Family"},{label:""},{label:"Companions"},{label:""},{label:"Criminal"},{label:""},{label:"Education"},{label:""},{label:"Leisure"},{label:""},{label:"Alcohol"},{label:""},{label:"Procriminal"},{label:""},{label:"Antisocial"},{label:""}];var e={};e.name="BARGRAPH";e.data=z;e.ticks=x;e.seriesColors=f;e.series=l;this.setDataObject(e)},setDataObject:function(d){var h=null;var e=null;var f=null;var b=null;if(d.hasOwnProperty("data")){h=d.data}if(d.hasOwnProperty("ticks")){e=d.ticks}if(d.hasOwnProperty("seriesColors")){f=d.seriesColors}if(d.hasOwnProperty("series")){b=d.series}var a={seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{fillToZero:true},pointLabels:{show:true,location:"n",edgeTolerance:-15}},seriesColors:f,series:b,legend:{show:false},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:e},yaxis:{pad:1.05,min:0,max:5.5,tickOptions:{showLabel:false}}}};var k=$.jqplot(this.barGraphID,h,a);k.replot(h)},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:return 0;case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 0;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 0;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}},getRiskScore:function(){var d=0;var k=0;var h=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;for(var b=0;b<h.length;b++){response=h[b];var e=response.learnerResponse.toUpperCase();if(e<=1||e=="YES"){d++}var a=response.correctResponse.toUpperCase();if(a<=1||a=="YES"){k++}}var f={userRiskScore:d,expertRiskScore:k};return f},getProtectiveFactorScore:function(){var e=0;var k=0;var h=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;for(var b=0;b<h.length;b++){response=h[b];var d=response.learnerResponse.toUpperCase();switch(d){case"0":case"1":case"2":case"3":e+=Number(d);break;default:}var a=response.correctResponse.toUpperCase();switch(a){case"0":case"1":case"2":case"3":k+=Number(a);break;default:}}var f={userPFScore:e,expertPFScore:k};return f}},{INSTANCE_ID:0,NAME:"RCCCEvaluationPage"});puremvc.define({name:"jet.view.page.ReportPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("ReportPage");$(this.myDiv).addClass("chip_extralight");$(this.myDiv).css("border","1px black solid");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[]}},{hasEmbeddedVariables:false,sourceText:null,originalMessage:"",scoreMessage:"",logMessage:"",feedbackMessage:"",outcomesMessage:"",isTerminate:"false",components:null,show:function(a){if(a){$(this.myDiv).html(this.originalMessage);this.logMessage="";this.evaluateEmbeddedVariables();$(this.myDiv).show();this.mediators[jet.view.mediator.PageMediator.NAME].requestReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestOutcomesReport()}else{$(this.myDiv).hide()}},buildComponent:function(e,d,b,f){if(d==jet.AppConstants.TEXTX){var a=new jet.view.component.ViewComponent;a.setParent(e.myDiv);e.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(f);this.components.push(a);if(f.length>0){this.originalMessage=f}}if(d==jet.AppConstants.TEXT){$(this.myDiv).html(f);if(f.length>0){this.originalMessage=f}}if(d==jet.AppConstants.CHECKBOX){var h=e.getTag(b);switch(h){case"terminate":if(f=="true"){e.isTerminate="true"}break}}},handleText:function(a){},processComponents:function(){$(this.myDiv).attr("id",this.uid)},requestConfirmation:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmation()},processNotification:function(w,l){var k=this.components[this.components.length-1];switch(w){case jet.AppConstants.REPORT_INTERNALLY:var r=0;var v=0;r=l.scoreTotal;v=l.userTotal;var s=Math.trunc(v*10)/10;v=s;this.scoreMessage="<hr><p class='report'>"+v+"/"+r+"</p><p>"+parseInt(v/r*100)+"%";var m=this.originalMessage+this.scoreMessage+this.logMessage;$(this.myDiv).html(m);this.requestConfirmation();break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLY:var m=this.originalMessage+this.scoreMessage+this.logMessage;var a=l;for(var p=0;p<l.length;p++){var d=l[p];if((d.feedback!=null&&d.feedback!=undefined)&&(d.feedback.length>0)){this.feedbackMessage="<p>Q: "+d.question+"</p>";this.feedbackMessage+="<p>Feedback: "+d.feedback+"</p>"}}m+=this.feedbackMessage;$(this.myDiv).html(m);break;case jet.AppConstants.REQUEST_CONFIRMATION:var m=this.originalMessage+this.scoreMessage+this.feedbackMessage+this.outcomesMessage;var t=new Date();var u=t.getDate();var q=t.getMonth()+1;var n=t.getFullYear();var e=t.getHours();var o=t.getMinutes();var b="<p>Requested confirmation at "+q+"/"+u+"/"+n+" "+e+":"+o+"</p>";this.logMessage+=b;$(this.myDiv).html(m+this.logMessage);break;case jet.AppConstants.REPORT_OUTCOMES:var m=this.originalMessage+this.scoreMessage+this.feedbackMessage;this.outcomesMessage=this.parseOutcomesReport(l);$(this.myDiv).html(m+this.outcomesMessage);break;case jet.AppConstants.REPORT_CONFIRMATION:var m=this.originalMessage+this.scoreMessage+this.feedbackMessage+this.outcomesMessage;var t=new Date();var u=t.getDate();var q=t.getMonth()+1;var n=t.getFullYear();var e=t.getHours();var o=t.getMinutes();var h=l;var f="";if(typeof isChild!="undefined"){if(isChild()){return}}switch(h.status){case"Success":f="<p>Successfully received confirmation at "+q+"/"+u+"/"+n+" "+e+":"+o+"</p>";if(h&&h.rawValue){f+="<p> Score Reported: "+h.rawValue+"</p>"}if(this.isTerminate=="true"){this.mediators[jet.view.mediator.PageMediator.NAME].requestTerminate()}break;case"Failure":f="<p>Received confirmation at "+q+"/"+u+"/"+n+" "+e+":"+o+"</p>";f+="<p>"+h.message+"</p>";break;case"Terminate":f="<p>"+h.message+"</p>";break;default:f="<p>Something unexpected happened.</p>";break}this.logMessage+=f;$(this.myDiv).html(m+this.logMessage);break}},evaluateEmbeddedVariables:function(){if(this.hasEmbeddedVariables||$(this.myDiv).html().match(/({)(\S*)(})/)!=null){this.hasEmbeddedVariables=true;if(this.getSourceText()==null){this.setSourceText($(this.myDiv).html())}$(this.myDiv).html(this.getSourceText());var d=$(this.myDiv).find("p:contains('{')");for(var b=0;b<d.length;b++){var e=$(d[b]).text();captureGroups=e.match(/({)(\S*)(})/);if(captureGroups!=null&&captureGroups.length>2){var a=captureGroups[2];var f=getJetValue(a);if(f!=null&&f!=undefined){e=e.replace(/{.*}/,f);$(d[b]).html(e)}}}}this.originalMessage=$(this.myDiv).html()},setSourceText:function(a){this.sourceText=a},getSourceText:function(){return this.sourceText},parseOutcomesReport:function(b){var a="<p>";$.each(b,function(e,d){a+=d.guid+"   "+d.shortDesc;a+="<br>";a+=d.userTotal+"/"+d.scoreTotal;a+="<hr>"});return a}},{NAME:"ReportPage"});puremvc.define({name:"jet.view.page.ShortAnswerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("ShortAnswerPage");$(this.myDiv).addClass("chip_light");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,processedExpression:false,processedRegEx:false,originalExpression:null,isUserCorrect:null,feedBackComponents:null,questionStem:null,prompt:"Type answer here",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;var k=f.getTag(b);if(k=="calcNodeOptions"){f.calcOptions=this.cloneBranchOptions(d)}if(k=="checkedNodeOptions"){f.checkedBranchOptions=d}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.CHECKBOX:this.processedRegEx=true;if(h.toUpperCase()=="TRUE"){this.useRegEx=true}if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}var k=f.getTag(b);if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="totalpoints"){f.setTotalPoints(h)}else{if(k=="expression"){this.processedExpression=true;this.originalExpression=h;var a=new jet.view.component.InputTextComponent;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a);if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}}else{if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("d_stem");f.setQuestionStem(h)}else{if(k=="Prompt"){this.prompt=h}}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){if(this.useRegEx!=true){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}}else{this.answerKeys.push(d)}},concatenateAnswerKeys:function(){if(this.answerKeys.length>0){var b=this.answerKeys[0];for(var a=1;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},processAnswerKeys:function(){if(this.useRegEx){this.answerKeys.push(this.originalExpression)}else{this.splitIntoAnswerKeys(this.originalExpression)}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);if(this.userInputComponents!=null&&this.userInputComponents.length>0){this.userInputComponents[0].setPrompt(this.prompt)}},evaluateUserActivity:function(){this.disableInteractivity();var a="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.useRegEx){if(!this.doesAnswerMatchExpression(this.userInputComponents[0].getUserInput())){a="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}else{if(!this.isAnswerinArray(this.userInputComponents[0].getUserInput())){a="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return a},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",15);$(b).addClass("d_feedback");var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a}},{NAME:"ShortAnswerPage"});puremvc.define({name:"jet.view.page.TextPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("TextPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.branchingComponents=[]}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,branchingComponents:null,$embedObject:null,show:function(a){if(a){$(this.myDiv).fadeIn(1000);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{$(this.myDiv).hide();this.hideComponents(this.components)}},buildComponent:function(h,e,b,k,d){switch(e){case jet.AppConstants.NODES_MANAGER:h.branchOptions=d;break;case jet.AppConstants.TEXT:var l=h.getTag(b);if(l=="totalpoints"){h.setTotalPoints(k)}else{if(l=="text"&&k.length>0){this.doInstructionsExist=true}if(l=="stem"){var f=this.getProperty(b,"player_y");if(f!=null&&f!=undefined){this.stemYOffset=parseInt(f.player_y)}}var a=new jet.view.component.ViewComponent;a.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(k);if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d);this.components.push(a)}}break;case jet.AppConstants.CHECKBOX:var a=new jet.view.component.CheckBoxComponent;a.setParent(h.contentDiv,this);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.answerKeys.push($.trim(k));this.userInputComponents.push(a);a.setIndexInArray(this.userInputComponents.length-1);this.components.push(a);break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(k);this.components.push(a);break;case jet.AppConstants.AUDIO:if(k.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(k);a.setAudioOptions(d);a.setParent(h.contentDiv);a.setProperties(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid)},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){this.disableInteractivity();var b="correct";this.setUserPoints(this.getTotalPoints());for(var a=0;a<this.userInputComponents.length&&a<this.answerKeys.length;a++){if(this.userInputComponents[a].getUserInput()!=this.answerKeys[a]){b="incorrect";this.setUserPoints(0)}}return b},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"}},{NAME:"QuestionPage"});puremvc.define({name:"jet.view.page.TilesPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("TilesPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.tilesDiv=document.createElement("div");$(this.tilesDiv).addClass("tilesDiv");this.scoreFrame=document.createElement("div");$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tiles={}}},{imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,tilesDiv:null,scoreFrame:null,score:0,totalPointsCounter:0,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tiles:null,xml:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,d,a,h,b){switch(d){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(a);if(k=="checkedNodeOptions"){f.checkedBranchOptions=b}if(k=="uncheckedNodeOptions"){f.unCheckedBranchOptions=b}break;case jet.AppConstants.DATA_INPUT:var e=f.processXML(h);break;case jet.AppConstants.TEXT:var k=f.getTag(a);if(k=="totalpoints"){f.setTotalPoints(h)}break;case jet.AppConstants.CHECKBOX:var k=f.getTag(a);if(k=="hideAnswer"){f.setHideAnswer(h)}else{if(k=="flowstatus"){if(h=="true"){f.setInFlow("false")}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(f.contentDiv);this.imageComponent.setProperties(a);this.imageComponent.addClass("tilesImage");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,a);this.imageComponent.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}this.audioComponent=new jet.view.component.HTMLAudioComponent;this.audioComponent.setMediaURL(h);this.audioComponent.setAudioOptions(b);this.audioComponent.setParent(f.myDiv);this.audioComponent.setProperties(a);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,a);this.components.push(this.audioComponent);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},getCategory:function(a){var b=this.tiles[a];if(b==null){this.tiles[a]=[]}return this.tiles[a]},insertToCategory:function(a,d){for(var b=0;b<a.length;b++){if(Number(d.Points)<Number(a[b].Points)){a.splice(b,0,d);return}}a.push(d)},processXML:function(l){this.xml=l;this.totalPointsCounter=0;xmlDoc=$.parseXML(l);var k=$(xmlDoc).find("dataPage");for(var h=0;h<k.length;h++){var b=k[h];var a=$(b).find("Category")[0].textContent.trim();var r=this.getCategory(a);var q=$(b).find("Points")[0].textContent.trim();var p=$(b).find("Question_Stem")[0].textContent.trim();var o=$(b).find("Feedback")[0].textContent.trim();var n=$(b).find("Correct_Answer")[0].textContent.trim();var f=$(b).find("Distractor_1")[0].textContent.trim();var e=$(b).find("Distractor_2")[0].textContent.trim();var d=$(b).find("Distractor_3")[0].textContent.trim();var m={Category:a,Points:q,Question_Stem:p,Feedback:o,Correct_Answer:n,Distractor_1:f,Distractor_2:e,Distractor_3:d};this.insertToCategory(r,m)}this.renderCategories();this.renderTiles()},getTilesDiv:function(){return this.tilesDiv},getNumberOfCategories:function(){var a=0;for(category in this.tiles){a++}return a},renderCategories:function(){var f=5;var d=4;var k=this.tilesDiv;$(this.contentDiv).append(k);$(k).css("display","inline-block");$(k).css("width","600px");$(k).css("height","400px");$(k).css("margin-top","10px");this.makeGauge(600,400);var a=0;for(var b in this.tiles){if(a<d){var h=document.createElement("div");$(h).css("width","193px");$(h).css("height","70px");$(h).css("font-size","24px");$(h).css("color","rgba(0,0,0,0.6)");$(h).css("padding-top","5px");$(h).css("text-shadow","2px 8px 6px rgba(0,0,0,0.2),0px -5px 35px rgba(255,255,255,0.3)");$(k).append(h);h.className="categoryDiv";h.id=a;$(h).html(b);var e=this.getCategory(b);this.renderTiles(e,f);a++}}var d=4;$(k).layout({type:"grid",columns:d,rows:f,vgap:3,hgap:3,fill:"vertical"})},renderTiles:function(l,a){var h=this;if(l==null||l==undefined){return}var e;var b=Math.min(a-1,l.length);for(e=0;e<b;e++){var m=l[e];var k=this.tilesDiv;var f=document.createElement("div");$.data(f,"question",m);$(f).css("width","193px");$(f).css("height","60px");$(f).css("font-size","24px");$(k).append(f);f.className="tileDiv";this.totalPointsCounter+=Number(m.Points);$(f).html(m.Points);$(f).on("click",function(n){h.tileClickHandler(n,h)})}for(var d=e+1;d<a;d++){var k=this.tilesDiv;var f=document.createElement("div");$(f).css("width","200px");$(f).css("height","50px");$(k).append(f);f.className="tile"}},testAlert:function(){window.alert("hi")},tileClickHandler:function(d,m){var l=d.target;var h=$.data(d.target,"question");$(l).off();var k=document.createElement("div");k.className="TilesQuestion";$(k).css("display","inline-block");$(k).css("width","700px");$(k).css("height","450px");$(k).css("overflow-x","hidden");$(k).css("overflow-y","scroll");$(k).css("padding","50px");$(k).css("background-color","#F7F7F7");$(k).css("border-style","double");$(k).css("border-width","5px");$(k).css("font-size","24px");var n=document.createElement("div");$(n).html(h.Question_Stem);$(n).css("width","600px");$(n).css("margin","20px");$(n).css("height","50px");$(n).css("background-color","#F7F7F7");$(k).append(n);var b=[];if(h.Correct_Answer!=""){b.push(h.Correct_Answer)}if(h.Distractor_1!=""){b.push(h.Distractor_1)}if(h.Distractor_2!=""){b.push(h.Distractor_2)}if(h.Distractor_3!=""){b.push(h.Distractor_3)}m.shuffle(b);for(var e=0;e<b.length;e++){var a=b[e]==h.Correct_Answer?true:false;var f=m.makeDistractor(m,b[e],a,h,k,l);$(k).append(f)}var o=m.getTilesDiv();$(o).append(k);$.colorbox({html:k,overlayClose:false,onComplete:function(){}})},makeDistractor:function(k,m,a,f,e,h){var l=document.createElement("div");$(l).on("click",function(){k.feedbackHandler(a,f,e,k,h)});$(l).mouseover(function(){$(this).css("background-color","#e7e7e7")}).mouseout(function(){$(this).css("background-color","transparent")});var d=document.createElement("input");d.type="radio";d.name="group1";$(d).addClass("questionRadioButton");$(d).css("width","10px");$(d).css("height","30px");$(d).css("margin","10px");$(d).on("click",function(){k.feedbackHandler(a,f,e,k,h)});$(l).append(d);var b=document.createElement("div");$(b).html(m);$(b).css("display","inline-block");$(b).css("width","400px");$(b).css("height","50px");$(b).css("margin","20px");$(l).append(b);return l},feedbackHandler:function(h,f,b,e,a){var d="<div style='margin:20px'>";d+="<div style='color:white;margin-left:auto;margin-right:auto;padding:20px;background-color:#ababab;border-color:#f7f7f7; border-style:solid;border-radius: 20px;";if(h){$(a).append("<span style='padding:10px;color:green'>&#x2611;</span>");d+="<p style='font-color:#00FF00;font-size:40px'>Correct</p>";d+="</div>";d+="<div style='height:300px;padding:20px;background-color:#ebebeb;border-color:#fefefe; border-style:solid;border-radius: 20px;";d+="<p style = 'margin-top: 20px'>You earn "+f.Points+" points.";d+="<p>"+f.Feedback+"</p>";e.appendScore(f.Points)}else{$(a).append("<span style='padding:10px;color:red'>&#9746;</span>");d+="<p style='color:#ff0000;font-size:40px'>Incorrect</p>";d+="</div>";d+="<div style='height:300px;padding:20px;background-color:#ebebeb;border-color:#fefefe; border-style:solid;border-radius: 20px'";d+="<p>You lose "+f.Points+" points.";d+="<p>"+f.Feedback+"</p>";e.appendScore(-1*parseInt(f.Points))}d+="<p style='margin-top:20px;margin-bottom:40px;font-size:16px'>After you have answered all of the questions, click on the 'Submit' button to register your points.</p>";d+="<button style='margin-top:20px;font-size:24px' onclick='$.colorbox.close()'>Continue</button>";d+="</div>";d+="</div>";$(b).html(d);e.showCheckAnswerButton()},shuffle:function(e){var d=e.length,b,a;while(0!==d){a=Math.floor(Math.random()*d);d-=1;b=e[d];e[d]=e[a];e[a]=b}return e},makeGauge:function(f,a){var d=document.createElement("div");$(d).addClass("gauge");$(d).css("width","300px");$(d).css("height","30px");$(d).css("top",a+"px");$(d).css("margin-top","10px");$(d).css("margin-left","auto");$(d).css("margin-right","auto");$(d).css("z-index","100");$(d).css("border-style","solid");$(d).css("border-color","#c7c7c7");$(d).css("border-radius","15px");$(d).css("background-color","#121212");var e=document.createElement("div");$(e).addClass("labelFrame");$(e).css("width","100px");$(e).css("height","25px");$(e).css("float","left");$(e).css("margin","5px");$(e).css("background-color","#121212");$(e).css("font-size","18px");$(e).css("color","#FFFFFF");$(e).html("SCORE");$(d).append(e);var b=this.scoreFrame;$(b).addClass("scoreFrame");$(b).css("width","140px");$(b).css("height","25px");$(b).css("float","left");$(b).css("margin","5px");$(b).css("background-color","#121212");$(b).css("font-size","18px");$(b).css("color","#FFFFFF");$(b).html("O pts");$(d).append(b);$(this.contentDiv).append(d)},setScoreFrame:function(a){$(this.scoreFrame).html(a+" Pts")},setScore:function(a){this.score=Number(a);this.setScoreFrame(a)},appendScore:function(a){this.score=this.score+Number(a);this.setScoreFrame(this.score)},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};this.tiles={};$(this.contentDiv).empty();$(this.tilesDiv).empty();this.processXML(this.xml);this.score=0},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid);for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var a=0.8;var b="";this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var d=this.score/this.totalPointsCounter;this.setUserPoints(Math.floor(this.getTotalPoints()*d));if(d>=a){this.setIsUserCorrect(true)}else{this.setIsUserCorrect(false)}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){b=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){b=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=b}return this.getHideAnswer()=="false"?e:"Sent"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},},{NAME:"TilesPage"});puremvc.define({name:"jet.view.page.VideoPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("VideoPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.contentDiv).css("overflow","hidden");$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[];this.videoSrc}},{contentDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,videoSrc:null,isYouTube:true,captionResource:null,videoResource:null,startTime:null,endTime:null,latitude:null,longitude:null,latitudeProximity:null,longitudeProximity:null,geoheading:-1,title:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(true);this.showVideo(true)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.showIFrames(false);this.showVideo(false)}},buildComponent:function(e,h,f,l,d){switch(h){case jet.AppConstants.VIDEO:if(l.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var b=l.indexOf("&");b=b>0?b:l.length;var a=l.substring(0,b);a=a.replace(/.*?v=/,"");this.drawYouTubePlayer(a);this.isYouTube=true;return}else{this.videoSrc=l;this.isYouTube=false;return}var k=new jet.view.component.ImageComponent;k.setParent(e.contentDiv);k.setProperties(f);e.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(k,f);k.setText(l);k.setCaptionOptions(d);break;case jet.AppConstants.AUDIO:if(l.length<1){return}var k=new jet.view.component.HTMLAudioComponent;k.setMediaURL(l);k.setAudioOptions(d);k.setParent(e.contentDiv);k.setProperties(f);e.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(k,f);this.components.push(k);break;case jet.AppConstants.CHECKBOX:var m=e.getTag(f);if(m=="flowstatus"){if(l=="true"){e.setInFlow(false)}}if(m=="scrollstatus"){if(l=="true"){$(this.contentDiv).css("overflow","hidden")}}break;case jet.AppConstants.RESOURCE:var m=e.getTag(f);if(m=="videoResource"){this.videoResource="base/"+l}if(m=="captionResource"){this.captionResource="base/"+l}break;case jet.AppConstants.TEXT:var m=e.getTag(f);if(m=="start_time"){l=e.convertToSeconds(l);this.startTime=l}if(m=="end_time"){l=e.convertToSeconds(l);this.endTime=l}if(m=="latitude"&&l.length>0){this.latitude=l}if(m=="latitudeProximity"&&l.length>0){this.latitudeProximity=l}if(m=="longitude"&&l.length>0){this.longitude=l}if(m=="longitudeProximity"&&l.length>0){this.longitudeProximity=l}if(m=="geoheading"&&l.length>0){this.geoheading=l}if(m=="index"&&l.length>0){this.title=l;$(this.myDiv).attr("data-title",l)}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(l);break}},convertToSeconds:function(h){try{if(!h.includes(":")){return h}else{h="0:"+h;h=h.substring(h.length-7,h.length);var f=h.split(":");if(f.length!=3){return 0}seconds=0;var a=Number(f[0]);var e=Number(f[1]);var d=Number(f[2]);seconds=a*60*60;seconds+=e*60;seconds+=d;return seconds}}catch(b){}},handleText:function(a){},getLatitude:function(){return this.latitude},getLongitude:function(){return this.longitude},getLatitudeProximity:function(){return this.latitudeProximity},getLongitudeProximity:function(){return this.longitudeProximity},getGeoheading:function(){return this.geoheading},getTitle:function(){return this.title},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid);this.drawVideoPlayer()},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"VideoPage"},getType:function(a){switch(a.toUpperCase()){case"MP4":return"mp4";default:return a}},drawVideoPlayer:function(){if(this.isYouTube){return}if(this.videoSrc==null&&this.videoResource==null){return}if((this.videoSrc==null||this.videoSrc=="")&&this.videoResource!=null){this.videoSrc=this.videoResource}var h=this.videoSrc.substr((this.videoSrc.lastIndexOf(".")+1));var b="video/"+this.getType(h);var f=this;var e=document.createElement("video");$(this.contentDiv).append(e);$(e).addClass("video");$(e).attr("type",b);this.videoSrc=this.videoSrc+"#t="+this.startTime+","+this.endTime;$(e).attr("src",this.videoSrc);$(e).attr("controls","");if(this.captionResource!=null&&this.captionResource!=""){var a=document.createElement("track");$(a).attr("src",this.captionResource);$(a).attr("kind","captions");$(a).attr("srclang","en");$(a).attr("label","English");$(a).attr("mode","hidden");$(e).append(a);var d=document.createElement("button");$(d).append("CC");$(d).addClass("captionButton");$(d).css("background","#000000");$(d).css("color","#FFFFFF");$(d).css("font-size","8px");$(d).css("border","1px");$(d).css("border-radius","5px");$(d).css("float","right");$(d).css("height","20px");$(d).css("width","30px");$(d).css("position","absolute");$(d).css("left","90%");$(d).css("top","0%");$(d).css("display","none");$(this.contentDiv).append(d);$(d).on("click",function(l){var k=$(this).parent().find(".video")[0].textTracks;var m=k[0];if(m.mode!="showing"){m.mode="showing"}else{m.mode="hidden"}})}$(e).css("width","98%");$(e).css("height","auto")},drawYouTubePlayer:function(e){var d=this;var h=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var f=h.getVideoIndex();var b="player"+f;var a=document.createElement("iframe");this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;$(a).css("width","98%");$(d.contentDiv).css("padding-bottom","56.25%");a.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1&start="+this.startTime+"&end="+this.endTime;var k=setInterval(function(){if(h.isYTAvailable()){h.addPlayer(b,e);clearInterval(k)}},2000)},showVideo:function(a){if(a){}else{if($("video").size()>0){$("video").each(this.handleVideo)}}},handleVideo:function(a,b){b.pause()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width","98%");$(this.iFrames[b]).css("height","98%")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}},getContentAsResourceX:function(){if(this.isYouTube){var a="<p style='text-align: center;'><font face='Segoe UI'><br></font></p><p style='text-align: center;'><font face='Arial'>This type of page cannot be displayed as a resource.</font></p>";return a}else{return"CLONE"}},getContentAsResource:function(){return"REPARENT"},getClonedContent:function(){return $(this.myDiv).clone(true,true)},getReParentedContent:function(){return this},},{NAME:"VideoPage"});puremvc.define({name:"jet.view.page.VideoScenarioPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("VideoScenarioPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.contentDiv).css("width","90%");$(this.contentDiv).css("height","66%");$(this.contentDiv).css("margin-left","2%");$(this.contentDiv).css("margin-bottom","2%");$(this.contentDiv).css("background-color","#000000");$(this.contentDiv).css("color","#FFFFFF");$(this.contentDiv).css("font-size","20pt");$(this.contentDiv).css("padding","5%");$(this.contentDiv).css("-webkit-box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.contentDiv).css("-moz-box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.contentDiv).css("box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.myDiv).append(this.contentDiv);this.textDiv=document.createElement("div");this.textDiv.className="scenarioTextDiv";$(this.textDiv).css("width","90%");$(this.textDiv).css("height","66%");$(this.textDiv).css("margin-left","2%");$(this.textDiv).css("margin-bottom","2%");$(this.textDiv).css("background-color","#000000");$(this.textDiv).css("color","#FFFFFF");$(this.textDiv).css("font-size","20pt");$(this.textDiv).css("padding","5%");$(this.textDiv).css("z-index","10");$(this.contentDiv).append(this.textDiv);this.scenarioDiv=document.createElement("div");this.scenarioDiv.className="scenarioDiv";$(this.scenarioDiv).css("width","100%");$(this.scenarioDiv).css("height","33%");$(this.myDiv).append(this.scenarioDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[];this.scenarioArray=[];this.videoSrc;this.scenarioDescription="";this.youTubeMediator=null;this.whichPlayer=0;this.youTubeObject=null;this.scenarioFeedback="You must choose a numbered option first.";this.numberOfTries=0}},{contentDiv:null,textDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,videoSrc:null,isYouTube:true,captionResource:null,videoResource:null,xml:null,scenarioArray:null,scenarioDescription:null,youTubeMediator:null,whichPlayer:null,youTubeObject:null,videoObject:null,scenarioFeedback:"Pick an Option",numberOfTries:0,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(false);this.showVideo(false)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.clearVideo()}},buildComponent:function(h,e,d,k,b){switch(e){case jet.AppConstants.DATA_INPUT:if(k.length>0){h.processXML(k);this.xml=k;h.processScenarios()}break;case jet.AppConstants.VIDEO:if(k.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var f=k.replace(/.*?v=/,"");this.drawYouTubePlayer(f);this.isYouTube=true;return}else{this.videoSrc=k;this.isYouTube=false;return}var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);a.setText(k);a.setCaptionOptions(b);break;case jet.AppConstants.AUDIO:if(k.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(k);a.setAudioOptions(b);a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var l=h.getTag(d);if(l=="flowstatus"){if(k=="true"){h.setInFlow(false)}}break;case jet.AppConstants.RESOURCE:var l=h.getTag(d);if(l=="videoResource"){this.videoResource="base/"+k}if(l=="captionResource"){this.captionResource="base/"+k}break;case jet.AppConstants.TEXT:var l=h.getTag(d);if(l=="heading"){this.scenarioDescription=k}if(l=="totalpoints"){h.setTotalPoints(k)}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},processXML:function(l){this.xml=l;xmlDoc=$.parseXML(l);var h=$(xmlDoc).find("dataPage");for(var f=0;f<h.length;f++){var e=h[f];var o=$(e).find("Points")[0].textContent.trim();var k=$(e).find("Option")[0].textContent.trim();var b=$(e).find("Feedback")[0].textContent.trim();var a=$(e).find("URL")[0].textContent.trim();var d=$(e).find("Start_Time")[0].textContent.trim();var m=$(e).find("End_Time")[0].textContent.trim();var n={Points:o,Option:k,Feedback:b,Url:a,StartTime:d,EndTime:m};this.scenarioArray.push(n)}},processScenarios:function(){var e=this;var b=document.createElement("button");$(b).className="showScenarioButton";$(b).attr("type","button");$(b).css("width","130px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("margin-left","30px");$(b).css("z-index","21");$(b).text("Show Scenario");this.addScenarioButtonClickHandler(e,b);$(this.scenarioDiv).append(b);var b=document.createElement("button");$(b).className="scenarioFeedbackButton";$(b).attr("type","button");$(b).css("width","130px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("z-index","21");$(b).text("Show Feedback");this.addScenarioFeedbackButtonClickHandler(e,b);$(this.scenarioDiv).append(b);for(var a=0;a<this.scenarioArray.length;a++){var d=this.scenarioArray[a];var b=document.createElement("button");$(b).addClass("scenarioButton");$(b).attr("type","button");$(b).css("width","50px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("z-index","21");$(b).text(a+1);this.addHoverHandler(e,b,d.Option);this.addClickHandler(e,b,d.Url,d.StartTime,d.EndTime,d.Feedback,d.Points);$(this.scenarioDiv).append(b)}},addHoverHandler:function(b,a,d){$(a).hover(function(){$(b.textDiv).html("<p align='center'>"+d+"</p>")},function(){if(b.isVideoShowing()){return}$(b.textDiv).text(b.scenarioDescription);$(b.videoObject).hide();$(b.youTubeObject).hide();$(b.textDiv).show()})},addClickHandler:function(k,e,d,h,b,a,f){$(e).click(function(){k.numberOfTries++;k.scenarioFeedback=a;if($(this).data("selected")!=true){var m=k.getUserPoints();m+=f/k.numberOfTries;m=Math.min(m,k.getTotalPoints());m=Math.ceil(m);k.setUserPoints(m);k.scenarioFeedback+=" You have earned a total of "+m+" point(s).";k.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(k,k.uid)}$(this).data("selected",true);k.clearVideo();if(d.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var l=k.youTubeMediator.normalizeURL(d);k.youTubeMediator.cueYTVideoById(k.youTubeObject,k.whichPlayer,l,h,b);$(k.textDiv).hide();$(k.videoObject).hide();$(k.youTubeObject).show()}else{k.youTubeMediator.cueVideoById(k.videoObject,k.whichPlayer,d,h,b);$(k.textDiv).hide();$(k.youTubeObject).hide();$(k.videoObject).show()}})},addScenarioButtonClickHandler:function(b,a){$(a).click(function(){b.clearVideo();$(b.textDiv).show();$(b.textDiv).text(b.scenarioDescription);b.scenarioFeedback="You must choose a numbered option to get feedback."})},addScenarioFeedbackButtonClickHandler:function(b,a){$(a).click(function(){b.clearVideo();$(b.textDiv).show();$(b.textDiv).text(b.scenarioFeedback)})},isVideoShowing:function(){if($(this.videoObject).css("display")=="none"&&$(this.youTubeObject).css("display")=="none"){return false}else{return true}},clearVideo:function(){$(this.videoObject).hide();$(this.youTubeObject).hide();$(this.videoObject).attr("src","");$(this.youTubeObject).attr("src","")},handleText:function(a){},enableInteractivity:function(){$(this.scenarioDiv).find(".scenarioButton").data("selected",false);this.setUserPoints(0);this.numberOfTries=0},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid);this.drawVideoPlayer();this.drawYouTubePlayer();$(this.textDiv).text(this.scenarioDescription)},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"VideoPage"},getType:function(a){switch(a.toUpperCase()){case"MP4":return"mp4";default:return a}},drawVideoPlayer:function(){var a=document.createElement("video");this.videoObject=a;$(this.contentDiv).append(a);$(a).addClass("video");$(a).attr("controls","");$(a).css("width","98%");$(a).css("height","98%");$(a).hide()},drawYouTubePlayer:function(){var d=this;this.youTubeMediator=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var e=this.youTubeMediator.getVideoIndex();this.whichPlayer=e;var b="player"+e;var a=document.createElement("iframe");this.youTubeObject=a;this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;$(a).css("width","400px");$(a).css("height","300px");var f=setInterval(function(){if(this.youTubeMediator&&this.youTubeMediator.isYTAvailable()){this.youTubeMediator.addPlayer(b,videoID);clearInterval(f)}},2000);$(a).hide()},showVideo:function(a){if(a){}else{if($("video").size()>0){$("video").each(this.handleVideo)}}},handleVideo:function(a,b){b.pause()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width",this.IFRAMEWIDTH+"px");$(this.iFrames[b]).css("height",this.IFRAMEHEIGHT+"px")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}}},{NAME:"VideoScenarioPage"});puremvc.define({name:"jet.view.page.WallPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a}},{show:function(a){},getName:function(){return"Wall"},processComponents:function(){$(this.myDiv).attr("id",this.uid)}},{NAME:"WallPage"});puremvc.define({name:"jet.view.page.WidgetPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("WidgetPage");$(this.myDiv).addClass("OpenQuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.hideAnswer=false;this.isFIB=false;this.executedSetCustomScore={};this.components=[]}},{contentDiv:null,components:null,isUserCorrect:null,hideAnswer:"false",isFIB:"false",executedSetCustomScore:null,latitude:null,longitude:null,latitudeProximity:null,longitudeProximity:null,geoheading:-1,title:null,widgetUserPoints:0,imageMediator:null,animationMediator:null,fibPoints:0,arrayT:null,arrayI:null,arrayO:null,totalPoints:0,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,audioComponent:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components);$(".refreshCandidate").redraw();imageMediator.onShow(this,true);if(this.audioComponent==null){animationMediator.onShow(this,true)}}else{if(!this.getIsLayer()){b.startHideTransition($(this.myDiv));this.hideComponents(this.components);imageMediator.onShow(this,false);animationMediator.onShow(this,false);var d=$(this.myDiv).attr("data-updated");if(d!="false"){$(this.myDiv).attr("data-updated","true")}}}},hideOverLay:function(){pageMediator.startHideTransition($(this.myDiv));this.hideComponents(this.components);imageMediator.onShow(this,false);animationMediator.onShow(this,false)},buildComponent:function(d,f,e,l,k){switch(f){case jet.AppConstants.NODES_MANAGER:var m=d.getTag(e);if(m=="calcNodeOptions"){d.calcOptions=this.cloneBranchOptions(k)}if(m=="checkedNodeOptions"){d.checkedBranchOptions=k}if(m=="uncheckedNodeOptions"){d.unCheckedBranchOptions=k}break;case jet.AppConstants.TEXT:var m=d.getTag(e);if(m=="totalpoints"){this.fibPoints=Number(l)}if(m=="backgroundColor"){d.setBackgroundColor(l)}if(m=="textBlock"&&l.length>0){l=d.normalizeText(l);var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);var h=a.processBasicComponent(d,l,e);var b=h.getContentDiv();a.findWidgets(d,b);imageMediator=this.getMediator(jet.view.mediator.ImageMediator.NAME);imageMediator.findImages(d,b);animationMediator=d.getMediator(jet.view.mediator.AnimationMediator.NAME);animationMediator.findAnimations(d,b)}if(m=="latitude"&&l.length>0){this.latitude=l}if(m=="latitudeProximity"&&l.length>0){this.latitudeProximity=l}if(m=="longitude"&&l.length>0){this.longitude=l}if(m=="longitudeProximity"&&l.length>0){this.longitudeProximity=l}if(m=="geoheading"&&l.length>0){this.geoheading=l}if(m=="index"&&l.length>0){this.title=l;$(this.myDiv).attr("data-title",l)}break;case jet.AppConstants.EPUB3V3:if(l.length>0){var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);var h=a.processBasicComponent(d,l,e);var b=h.getContentDiv();a.findWidgets(d,b)}break;case jet.AppConstants.CHECKBOX:var m=d.getTag(e);if(m=="hideAnswer"){d.setHideAnswer(l)}if(m=="flowstatus"){if(l=="true"){d.setInFlow(false)}}if(m=="scrollstatus"){if(l=="true"){$(this.contentDiv).css("overflow","hidden")}}if(m=="FIB"){if(l=="true"){this.setIsFIB(true)}}break;case jet.AppConstants.AUDIO:if(l.length<1){return}var h=new jet.view.component.HTMLAudioComponent;h.setMediaURL(l);this.audioComponent=h;h.setAudioOptions(k);h.setParent(this.myDiv);h.setProperties(e);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,e);this.components.push(h);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(l);break}},normalizeText:function(a){a=a.replace(/\"/g,"'");return a},handleText:function(a){},getLatitude:function(){return this.latitude},getLongitude:function(){return this.longitude},getLatitudeProximity:function(){return this.latitudeProximity},getLongitudeProximity:function(){return this.longitudeProximity},getGeoheading:function(){return this.geoheading},getTitle:function(){return this.title},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},checkReg:function(b){var a=/^(\/)(.+)[(\/)(g|i|m)]$/;return a.test(b)},getReg:function(d,a){var b=a;for(i=0;i<a.length;i++){for(j=0;j<a[i].length;j++){if(d.checkReg(a[i][j])==false){b[i][j]=a[i][j].toLowerCase()}}}return b},enableInteractivity:function(){var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);a.enableInteractivity(this.contentDiv);$(this.contentDiv).find("input.fib").removeAttr("disabled");$(this.contentDiv).find("input.fib").filter(function(){if($(this).val().indexOf("\u2718")>-1){return true}else{var b=$(this).val().replace("\u2713","");$(this).val(b);return false}}).val("")},disableInteractivity:function(){},processComponents:function(){$(this.myDiv).attr("id",this.uid);var a=this.getIsFIB();if(a){this.getText(this);var b=this.getTotalPoints();b=Number(b)+Number(this.fibPoints);this.setTotalPoints(b)}},postProcess:function(){if(this.audioComponent!=null){var a=animationMediator.getAnimators(this.uid,"pause");this.audioComponent.setAnimators(a)}},getText:function(a){a.arrayT=[];var b=$(a.contentDiv).find('span[style^="text-decoration:line-through"]');var b=$(a.contentDiv).find("span").filter(function(){if($(this).find("span").length){return false}if($(this).css("text-decoration").indexOf("line-through")>-1){return true}else{return false}});if($(b).length>0){$(b).each(function(e){var f=a.checkText($(this).text());if(f!==false){a.arrayT.push(f.split("&&"));var d='<span><input class="fib" type = "text" id ="'+e+'"/></span>';$(this).html(d);$(this).replaceWith($(this).html())}else{var d="<p><b>---recheck your input answer---</b></p>";$(this).html(d);$(this).replaceWith($(this).html())}})}else{return false}a.arrayT=a.getReg(a,a.arrayT);$("input.fib").click(function(){a.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()})},checkText:function(a){var a=a.replace(/[$,\s]/g,"");a=a.replace("\u2713","");a=a.replace("\u2718","");if(a&&a.length>0){return a}return"blank"},postCalcOptions:function(){$(this.myDiv).attr("data-updated","false")},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},evaluateUserActivity:function(){var a=this.checkInput(this);if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}}return a},checkInput:function(k){var l="\u2713";var h=this.fibPoints;this.getInput(k);var a=h/k.arrayI.length;this.setIsUserCorrect(true);for(i=0;i<k.arrayT.length;i++){var e=$(k.contentDiv).find("input.fib")[i];if(k.arrayI[i]=="Blank"){$(e).val(k.arrayI[i]);$(e).css("border-color","#F08080");l="Check format";this.setIsUserCorrect(false);h=h-a;break}else{if($.inArray(k.arrayI[i].toLowerCase(),k.arrayT[i])!==-1||$.inArray(k.arrayI[i].toLowerCase(),k.arrayT[i])>-1){$(e).val(k.arrayO[i]+"  \u2713")}else{for(j=0;j<k.arrayT[i].length;j++){if(k.checkReg(k.arrayT[i][j])==true){var b=k.arrayT[i][j].replace(/\//g,"");var b=new RegExp(b);var d=k.arrayI[i];if(b.test(d)==true){$(e).val(k.arrayO[i]+"  \u2713");this.setIsUserCorrect(true);break}else{$(e).val(k.arrayO[i]+"  \u2718");l="\u2718";this.setIsUserCorrect(false);h=h-a;break}}else{$(e).val(k.arrayO[i]+"  \u2718");l="\u2718";this.setIsUserCorrect(false);h=h-a}}}$(e).attr("disabled","disabled")}}var f=this.getUserPoints();this.setUserPoints(Number(h)+Number(f));return l},getInput:function(e){e.arrayI=[];e.arrayO=[];$("input.fib").css("border-color","#DEDEDE");for(i=0;i<e.arrayT.length;i++){var b=$(e.contentDiv).find("input.fib")[i];var d=b.value;d=d.replace("\u2713","");d=d.replace("\u2718","");var a=e.checkText(d);if(a!==false){e.arrayI.push(a);e.arrayO.push(d)}else{e.arrayI.push("Blank");e.arrayO.push("Blank")}}},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOption:null,branchDela:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setIsFIB:function(a){this.isFIB=a},getIsFIB:function(){return this.isFIB},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()},getContentAsResourcex:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()},getContentAsResource:function(){return"REPARENT"},getReParentedContent:function(){return this},setUserPoints:function(a){this.widgetUserPoints=a},getUserPoints:function(){return Math.max(0,this.widgetUserPoints)},},{NAME:"WidgetPage"});puremvc.define({name:"jet.view.page.mobile.mDialogPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[]}},{contentDiv:null,components:null,dialog1:null,dialog2:null,character1:null,character2:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k.match("dialog1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1");f.dialog1=a.getContentDiv()}}else{if(k.match("dialog2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2");f.dialog2=a.getContentDiv()}}}break;case jet.AppConstants.IMAGE:var k=f.getTag(b);if(k=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1");f.character1=a.getImageParent()}if(k=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2");f.character2=a.getImageParent()}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(this.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},handleText:function(a){},processComponents:function(){$(this.myDiv).attr("id",this.uid);$(this.contentDiv).prepend(this.dialog2);$(this.contentDiv).prepend(this.dialog1);$(this.dialog1).append(this.character1);$(this.dialog2).append(this.character2)},evaluateUserActivity:function(){},},{NAME:"mDialoPage"});puremvc.define({name:"jet.view.page.mobile.mInterviewPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("InterviewPage");$(this.myDiv).addClass("chip_extralight");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",imageParent:null,parentPage:null,interviewStem:null,hasSpeechBubble:false,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.mediators[jet.view.mediator.PageMediator.NAME].showMeter()}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].hideMeter()}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var k=f.getTag(b);if(k=="calcNodeOptions"){f.calcOptions=this.cloneBranchOptions(d)}else{f.branchOptions=d}break;case jet.AppConstants.TEXT:var k=f.getTag(b);if(k=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("interviewerStem");this.interviewStem=a.getContentDiv();a.addContentClass("d_stem");this.questionStem=h}else{if(k.match("distractor.*")){if(h!=""){var a=new jet.view.component.ViewComponent;this.userInputComponents.push(a);this.parentPage=f;f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.enable=f.enable;a.disable=f.disable;if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d);a.addContentClass("interviewerDistractor");a.addContentClass("chip_light");a.addContentClass("d_distractor")}}}else{if(k=="points"){this.pointValues.push(h)}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);f.imageParent=a.getImageParent();a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("interviewImage");a.setCaptionOptions(d);if(d!=null&&d.imageDecorator!=null){if(d.imageDecorator.trim()=="True"){this.hasSpeechBubble=true}}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.HTMLAudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var k=f.getTag(b);if(k=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(h);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);var a=-1000;for(var b=0;b<this.pointValues.length;b++){var d=parseFloat(this.pointValues[b]);if(d>a){a=d}}this.setTotalPoints(a);this.prepareQuestion();$(this.contentDiv).prepend(this.imageParent);this.makeSpeechBubble()},makeSpeechBubble:function(){if(this.hasSpeechBubble){$(this.interviewStem).addClass("speechBubble")}},prepareQuestion:function(){var a=[];for(var e=0;e<this.userInputComponents.length;e++){a.push(e)}for(var e=a.length-1;e>-1;e--){var f=Math.random()*(a.length);var k=Math.floor(f);var n=a[e];a[e]=a[k];a[k]=n}var o=[];var b=[];var m=[];var p=[];for(var e=0;e<a.length;e++){var h=a[e];o.push(this.userInputComponents[h]);b.push(this.feedBackComponents[h]);m.push(this.branchingComponents[h]);p.push(this.pointValues[h])}this.userInputComponents=o;this.feedBackComponents=b;this.branchingComponents=m;this.pointValues=p;for(var d=0;d<this.userInputComponents.length;d++){var l=this.userInputComponents[d];l.setParent(this.parentPage.contentDiv,this.parentPage);l.enable()}},postProcess:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showMeter("Meter",100,100)},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},evaluateUserActivity:function(){this.disableInteractivity();this.storeUserFeedback();var h=this.getBranchOptions();if(h&&h.feedback){branchOptionsFeedback=h.feedback;var f=$(branchOptionsFeedback).text();f=f.replace(/\|;/gi,";")}var k="";for(var b=0;b<this.userInputComponents.length;b++){var e=this.userInputComponents[b].getContentDiv();var d=$(e).css("text-decoration")=="underline"?true:false;if(d){k=$(e).text();break}}var a={uid:this.uid,questionType:"choice",question:this.questionStem.substring(0,249),learnerResponse:k,correctResponse:"not revealed",feedBack:f,result:""};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,a);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,a);return this.getHideAnswer()=="false"?correctAnswers:"Submitted"},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;a.disable();$(b).hover(function(){$(this).animate({"background-color":"#d7d7d7"},1000,function(){})},function(){$(this).animate({"background-color":"transparent"},1000,function(){})});$(b).removeAttr("disabled","disabled");$(b).bind("click",function(){d.setBranchingComponent(a);d.handleEvent(b,jet.AppConstants.TEXT,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).attr("disabled","disabled")},getName:function(){return"InterviewPage"},addFeedback:function(b,d){if(this.getHideAnswer()=="false"){var a=document.createElement("div");a.className="feedback";$(this.contentDiv).append(a);this.feedBackComponents.push(a);$(a).css("position","absolute");$(a).css("top",b.getY());$(a).css("left",10);$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}}},{NAME:"mInterviewPage"});puremvc.define({name:"jet.view.page.mobile.mQuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="container";$(this.myDiv).css("border-radius","10px");$(this.myDiv).css("padding","10px");$(this.myDiv).addClass("mQuestionPage");$(this.myDiv).addClass("chip_extralight");this.rowDiv=document.createElement("div");this.rowDiv.className="row";$(this.myDiv).append(this.rowDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="column";$(this.rowDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tempArray=[];this.isMultipleChoice="false"}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tempArray:null,isMultipleChoice:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,k,e){switch(f){case jet.AppConstants.NODES_MANAGER:var l=h.getTag(d);if(l=="calcNodeOptions"){h.calcOptions=this.cloneBranchOptions(e)}if(l=="checkedNodeOptions"){h.checkedBranchOptions=e}if(l=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.TEXT:var l=h.getTag(d);if(l=="totalpoints"){h.setTotalPoints(k)}else{if(l=="textBlock"&&k.length>0){this.textBlockComponent=new jet.view.component.ViewComponent;this.textBlockComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.textBlockComponent,d);this.textBlockComponent.setText(k);$(this.myDiv).addClass("LayoutB");h.setQuestionTextBlock(k)}if(l=="stem"){this.stemComponent=new jet.view.component.ViewComponent;this.stemComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.stemComponent,d);this.stemComponent.setText(k);this.stemComponent.addContentClass("stem");this.stemComponent.addContentClass("d_stem");h.setQuestionStem(k)}else{if(l.match("distractor.*")){var b=new jet.view.component.ViewComponent;b.setParent(h.contentDiv);this.distractorComponents.push(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);b.setText(k);getOuterBackgroundColor(b.getContentDiv());b.addContentClass("distractor");b.addContentClass("chip_instructions");b.addContentClass(l);if(e!=null){this.branchingComponents.push(b);b.setIndexInArray(this.branchingComponents.length-1);b.setComponentLevelBranchOptions(e)}}}}break;case jet.AppConstants.CHECKBOX:var l=h.getTag(d);if(l=="hideAnswer"){h.setHideAnswer(k)}else{if(l=="flowstatus"){if(k=="true"){h.setInFlow("false")}}else{if(l=="randomstatus"){if(k=="true"){h.setRandomStatus("true")}}else{if(l=="MC"){h.setIsMultipleChoice("true")}else{if(l=="MS"){h.setIsMultipleChoice("false")}else{var a={type:f,text:k,properties:d,tag:l};this.tempArray.push(a)}}}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(k);break;case jet.AppConstants.AUDIO:if(k.length<1){return}this.audioComponent=new jet.view.component.HTMLAudioComponent;this.audioComponent.setMediaURL(k);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(k);break}},handleText:function(a){},setIsMultipleChoice:function(a){this.isMultipleChoice=a},getIsMultipleChoice:function(){return this.isMultipleChoice},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var b=this;this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}this.prepareQuestion()},disableInteractivity:function(){var b=this;for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}$(b.myDiv).find(".distractorHost").each(function(){b.removeInteractivityFromDistractor(this)})},makeAnswerComponents:function(){var b=this.getIsMultipleChoice();for(var e=0;e<this.tempArray.length;e++){var f=this.tempArray[e];var d=b=="false"?new jet.view.component.CheckBoxComponent:new jet.view.component.RadioButtonComponent;d.setParent(this.contentDiv,this);this.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(d,f.properties);this.answerKeys.push($.trim(f.text));this.userInputComponents.push(d);d.setIndexInArray(this.userInputComponents.length-1);$(d.getContentDiv()).attr("id",this.userInputComponents.length-1);d.addContentClass(f.tag);var a=document.createElement("div");a.className="feedback";this.feedBackComponents.push(a)}},processComponents:function(){$(this.myDiv).attr("id",this.uid);this.makeAnswerComponents();for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){var e=[];$(this.contentDiv).empty();if(this.audioComponent!=undefined&&this.audioComponent!=null){this.audioComponent.setParent(this.myDiv)}if(this.textBlockComponent!=undefined&&this.textBlockComponent!=null){$(this.textBlockComponent.getContentDiv()).removeAttr("style");$(this.textBlockComponent.getContentDiv()).css("position","static");$(this.textBlockComponent.getContentDiv()).css("margin-bottom","0px");$(this.textBlockComponent.getContentDiv()).css("margin-top","10px");$(this.textBlockComponent.getContentDiv()).css("height","155px");this.textBlockComponent.setParent(this.contentDiv)}if(this.imageComponent!=undefined&&this.imageComponent!=null){$(this.imageComponent.getContentDiv()).removeAttr("style");$(this.imageComponent.getContentDiv()).css("position","static");$(this.imageComponent.getContentDiv()).css("margin-bottom","0px");$(this.imageComponent.getContentDiv()).css("margin-top","10px");$(this.imageComponent.getContentDiv()).css("height","240px");this.imageComponent.setParent(this.contentDiv)}$(this.stemComponent.getContentDiv()).removeAttr("style");$(this.stemComponent.getContentDiv()).css("position","static");$(this.stemComponent.getContentDiv()).css("margin-bottom","20px");$(this.stemComponent.getContentDiv()).css("margin-top","20px");this.stemComponent.setParent(this.contentDiv);for(var f=0;f<this.userInputComponents.length;f++){e.push(f)}if(this.randomStatus=="true"){for(var f=e.length-1;f>0;f--){var m=e[f];var k=parseInt(Math.random()*(f+1));e[f]=e[k];e[k]=m}}for(var f=0;f<this.userInputComponents.length;f++){var h=e[f];var o=this.distractorComponents[h];var b=o.getText();if(b==null||b==undefined||b.length<1){continue}var n=document.createElement("div");$(this.contentDiv).append(n);n.className="distractorHost";$(n).removeAttr("style");$(n).css("position","static");$(n).css("margin-top","10px");$(n).css("margin-bottom","40px");$(n).css("display","block");$(n).addClass("chip_light");$(n).addClass("d_distractor");var a=this.feedBackComponents[h];$(n).append(a);$(a).css("height","10px");$(a).css("width","10px");$(a).css("margin-left","10px");var l=this.userInputComponents[h];l.removeFromParent();$(l.getContentDiv()).removeAttr("style");l.setParent(n,this);$(l.getContentDiv()).css("margin-right","20px");$(l.getContentDiv()).css("margin-left","50px");var d=this.distractorComponents[h];d.removeFromParent();$(d.getContentDiv()).removeAttr("style");d.setParent(n,this);$(".componentX").remove();this.removeInteractivityFromDistractor(n);this.addInteractivityToDistractor(n,l.getContentDiv());getOuterBackgroundColor(n)}},addInteractivityToDistractor:function(a,b){var d=this;$(b).on("click",function(){d.restoreDistractors(d);$(b).parent().addClass("chip_dark")});$(a).on("click",function(){d.restoreDistractors(d);if($(b).prop("checked")){$(b).prop("checked",false)}else{$(b).prop("checked",true);$(a).addClass("chip_dark");var f=$(b).attr("id");var e=d.userInputComponents[f];d.setBranchingComponent(e);d.handleEvent(jet.AppConstants.CHECKBOX,"click")}})},restoreDistractors:function(a){var b=$(a.contentDiv).children(".distractorHost");$(b).each(function(){$(this).removeClass("chip_dark");$(this).addClass("chip_light")})},removeInteractivityFromDistractor:function(a){$(a).off()},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},evaluateUserActivity:function(){var o="";this.disableInteractivity();var a="";var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());for(var k=0;k<this.userInputComponents.length&&k<this.answerKeys.length;k++){if(this.userInputComponents[k].getUserInput()=="true"){var n=this.distractorComponents[k];a+=n.getText()+"; ";if(this.branchingOptionArray[k]&&this.branchingOptionArray[k].feedback){o+=this.branchingOptionArray[k].feedback+"|; <br />"}}if(this.userInputComponents[k].getUserInput()!=this.answerKeys[k]){e="\u2718";this.setIsUserCorrect(false);var b="\u2718";if(this.answerKeys[k]=="true"){b="\u25BA"}this.addFeedback(k,b);this.setUserPoints(0)}if(this.userInputComponents[k].getUserInput()==this.answerKeys[k]&&this.userInputComponents[k].getUserInput()=="true"){this.addFeedback(k,"\u2713")}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){o=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){o=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=o}var h=this.questionStem;var p=this.getIsUserCorrect()?"correct":"incorrect";var m="";for(var l=0;l<this.answerKeys.length;l++){if(this.answerKeys[l]=="true"){m+=this.distractorComponents[l].getText()+"; "}}var d=$(o).text();d=d.replace(/\|;/gi,";");var f={uid:this.uid,questionType:"choice",question:h.substring(0,249),learnerResponse:a,correctResponse:m,feedBack:d,result:p};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,f);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,f);return this.getHideAnswer()=="false"?e:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},},{NAME:"mQuestionPage"});puremvc.define({name:"jet.view.page.mobile.mSimpleSimPage",parent:jet.view.page.Page,constructor:function(a){page=this;this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("SimpleSim");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(this.contentDiv).css("padding","2px");this.distractorDiv=document.createElement("div");this.distractorDiv.className="distractorHome";$(this.distractorDiv).addClass("chip_dark");$(this.distractorDiv).css("border","2px solid black");$(this.distractorDiv).css("border-radius","10px");$(this.distractorDiv).css("position","sticky");$(this.distractorDiv).css("bottom","25px");$(this.distractorDiv).css("width","90%");$(this.distractorDiv).css("margin-left","auto");$(this.distractorDiv).css("margin-right","auto");$(this.distractorDiv).css("padding","5px");this.controlDiv=document.createElement("div");this.controlDiv.className="controller";$(this.controlDiv).addClass("chip_dark");$(this.controlDiv).css("opacity",".9");$(this.controlDiv).css("display","block");$(this.controlDiv).css("height","30px");$(this.controlDiv).css("padding","3px");$(this.controlDiv).html("&#8597;");$(this.controlDiv).css("text-align","center");$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,distractorDiv:null,controlDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",imageParent:null,parentPage:null,interviewStem:null,hasSpeechBubble:false,tabIndex:1,currentItem:null,menuHeight:100,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(d,f,e,l,k){switch(f){case jet.AppConstants.NODES_MANAGER:var m=d.getTag(e);if(m=="calcNodeOptions"){d.calcOptions=this.cloneBranchOptions(k)}else{d.branchOptions=k}break;case jet.AppConstants.TEXT:var m=d.getTag(e);if(m=="textBlock"&&l.length>0){l=d.normalizeText(l);var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);var h=a.processBasicComponent(d,l,e);var b=h.getContentDiv();$(b).css("margin-bottom","100px");a.findWidgets(d,b);imageMediator=this.getMediator(jet.view.mediator.ImageMediator.NAME);imageMediator.findImages(d,b)}if(m=="stem"){var h=new jet.view.component.ViewComponent;this.questionStem=l}else{if(m.match("distractor.*")){if(l!=""){var h=new jet.view.component.ViewComponent;this.userInputComponents.push(h);this.parentPage=d;d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,e);h.setText(l);h.enable=d.enable;h.disable=d.disable;h.addContentClass("chip_dark");var b=h.getContentDiv();$(b).css("width","100%");$(b).css("position","static");$(b).css("margin-bottom","5px");$(b).css("left","1%");$(b).css("height","auto");$(b).css("padding","5px");$(b).removeClass("text");if(k!=null){this.branchingComponents.push(h);h.setIndexInArray(this.branchingComponents.length-1);h.setComponentLevelBranchOptions(k);h.addContentClass("shortSimDistractor")}}}else{if(m=="points"){l=l.length>0?l:"1";this.pointValues.push(l)}}}break;case jet.AppConstants.IMAGE:var h=new jet.view.component.ImageComponent;h.setParent(d.contentDiv);d.imageParent=h.getImageParent();h.setProperties(e);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,e);h.setText(l);h.addClass("interviewImage");h.setCaptionOptions(k);if(k!=null&&k.imageDecorator!=null){if(k.imageDecorator.trim()=="True"){this.hasSpeechBubble=true}}break;case jet.AppConstants.AUDIO:if(l.length<1){return}var h=new jet.view.component.HTMLAudioComponent;h.setMediaURL(l);h.setAudioOptions(k);h.setParent(d.contentDiv);h.setProperties(e);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,e);this.components.push(h);break;case jet.AppConstants.CHECKBOX:var m=d.getTag(e);if(m=="flowstatus"){if(l=="true"){d.setInFlow(false)}}break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(l);break}},normalizeText:function(a){a=a.replace(/\"/g,"'");return a},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].enable()}this.enableUserComponents()},disableInteractivity:function(){for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].disable()}this.disableUserComponents()},processComponents:function(){$(this.myDiv).attr("id",this.uid);var a=-1000;for(var b=0;b<this.pointValues.length;b++){var e=parseFloat(this.pointValues[b]);if(e>a){a=e}}this.setTotalPoints(a);this.prepareQuestion();$(this.contentDiv).prepend(this.imageParent);var d=this;$(this.contentDiv).append(this.distractorDiv);$(this.distractorDiv).prepend(this.controlDiv);$(this.controlDiv).on("click",function(){$(d.distractorDiv).find(".shortSimDistractor").toggle()})},makeSpeechBubble:function(){if(this.hasSpeechBubble){$(this.interviewStem).addClass("speechBubble")}},prepareQuestion:function(){var r=document.createElement("div");$(r).text(this.questionStem);$(r).css("margin","20px");$(r).css("text-align","center");$(r).css("font-weight","bold");$(this.distractorDiv).append(r);var a=[];var l=this;for(var e=0;e<this.userInputComponents.length;e++){a.push(e)}for(var e=a.length-1;e>-1;e--){var f=Math.random()*(a.length);var m=Math.floor(f);var p=a[e];a[e]=a[m];a[m]=p}var q=[];var b=[];var o=[];var s=[];for(var e=0;e<a.length;e++){var h=a[e];q.push(this.userInputComponents[h]);b.push(this.feedBackComponents[h]);o.push(this.branchingComponents[h]);s.push(this.pointValues[h])}this.userInputComponents=q;this.feedBackComponents=b;this.branchingComponents=o;this.pointValues=s;for(var d=0;d<this.userInputComponents.length;d++){var n=this.userInputComponents[d];n.setParent(this.parentPage.distractorDiv,this.parentPage);var k=n.getContentDiv();$(k).css("border","1px solid white");$(k).attr("tabindex","0");$(k).on("focus",function(){l.handleFocus(l,this)});$(k).on("blur",function(){l.handleBlur(l,this)});$(k).on("click",function(){l.handleEvent(this,jet.AppConstants.TEXT,"click")});$(k).keyup(function(t){l.keyboardHandler(t,l,t.which);t.stopPropagation()});n.enable()}},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},evaluateUserActivity:function(){this.disableInteractivity();this.storeUserFeedback();var h=this.getBranchOptions();if(h&&h.feedback){branchOptionsFeedback=h.feedback;var f=$(branchOptionsFeedback).text();f=f.replace(/\|;/gi,";")}var k="";for(var b=0;b<this.userInputComponents.length;b++){var e=this.userInputComponents[b].getContentDiv();var d=$(e).css("text-decoration")=="underline"?true:false;if(d){k=$(e).text();break}}var a={uid:this.uid,questionType:"choice",question:this.questionStem.substring(0,249),learnerResponse:k,correctResponse:"not revealed",feedBack:f,result:""};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,a);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,a);return this.getHideAnswer()=="false"?correctAnswers:"Submitted"},enableUserComponents:function(){var e=this;for(var b=0;b<this.userInputComponents.length;b++){var a=this.userInputComponents[b];a.setParent(this.parentPage.distractorDiv,this.parentPage);var d=a.getContentDiv();$(d).attr("tabindex","0");$(d).on("focus",function(){e.handleFocus(e,this)});$(d).on("blur",function(){e.handleBlur(e,this)});$(d).on("click",function(){e.handleEvent(this,jet.AppConstants.TEXT,"click")});$(d).keyup(function(f){e.keyboardHandler(f,e,f.which);f.stopPropagation()})}},disableUserComponents:function(){var e=this;for(var b=0;b<e.userInputComponents.length;b++){var a=e.userInputComponents[b];var d=a.getContentDiv();$(d).off("focus");$(d).off("blur");$(d).off("click");$(d).off("keyup")}},processQuestion:function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_USER_ACTIVITY,null)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(this.distractorDiv).find(".shortSimDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}if(b==jet.AppConstants.DIV){switch(a){case"focus":$(this.distractorDiv).find(".shortSimDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break;case"click":$(this.distractorDiv).find(".shortSimDistractor").css("text-decoration","none");$(this.currentItem).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;$(b).hover(function(){$(this).animate({"background-color":"#d7d7d7"},1000,function(){})},function(){$(this).animate({"background-color":"transparent"},1000,function(){})});$(b).removeAttr("disabled","disabled");$(b).bind("click",function(){var f=d.findChildIndex(d.currentItem);var e=d.branchingComponents[f];d.setBranchingComponent(e);d.setBranchingComponent(e);d.handleEvent(b,jet.AppConstants.TEXT,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).attr("disabled","disabled")},getName:function(){return"InterviewPage"},addFeedback:function(b,d){if(this.getHideAnswer()=="false"){var a=document.createElement("div");a.className="feedback";$(this.contentDiv).append(a);this.feedBackComponents.push(a);$(a).css("position","absolute");$(a).css("top",b.getY());$(a).css("left",10);$(a).html(d)}},keyboardHandler:function(m,h,n){if(m.stopPropogation){m.stopPropogation()}if($(m.target).hasClass("shortSimDistractor")||$(m.target).hasClass("dndMenuItem")){var a=m.keyCode;var f=h.currentItem;var d=$(f).offset();var e=h.isMenuShowing();console.log("current->"+f);switch(e){case false:var b="20px";switch(a){case 32:$(f).attr("aria-grabbed","true");$(f).attr("aria-owns","dndMenu");h.handleEvent(h.currentItem,jet.AppConstants.DIV,"click");var k=h.findChildIndex(h.currentItem);var l=this.branchingComponents[k];this.setBranchingComponent(l);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_USER_ACTIVITY,null);break}break;case true:if(m.preventDefault){m.preventDefault()}if(m.stopPropogation){m.stopPropogation()}m=m||window.event;var f=m.target||m.srcElement;var a=m.keyCode;switch(a){case 40:objFocus=f.nextSibling;if(!objFocus){objFocus=$(f).parent().find("li").first()}objFocus.focus();break;case 38:objFocus=f.previousSibling;if(!objFocus){objFocus=$(f).parent().find("li").last()}objFocus.focus();break;case 13:$(":focus").css("color","yellow");h.handleEvent(h.currentItem,jet.AppConstants.DIV,"click");var k=h.findChildIndex(h.currentItem);var l=this.branchingComponents[k];this.setBranchingComponent(l);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_USER_ACTIVITY,null);break;case 27:$(h.currentItem).removeAttr("aria-owns");$(h.currentItem).removeAttr("aria-dropeffect");$(h.currentItem).attr("aria-grabbed","false");h.showMenu(null,false,h);h.resetFocus(h);break}break}}},isMenuShowing:function(){return false},setCurrentItem:function(b,a){if(!b.isMenuShowing()){b.currentItem=a;$(a).css("background-color","black");$(a).css("color","red")}},abdicateCurrentItem:function(b,a){$(a).css("background","none");$(a).css("color","black")},deSelect:function(b,a){$(a).css("background","none");$(a).css("color","black")},findChildIndex:function(d){var a=$(d).parent();var b=$(a).children(".shortSimDistractor");return $(b).index(d)},handleFocus:function(b,a){if(!b.isMenuShowing()){b.setCurrentItem(b,a);console.log("current -> "+a);$(a).css("background-color","red");$(a).css("color","white");$(a).attr("aria-haspopup","true")}},handleBlur:function(b,a){if(!b.isMenuShowing()){$(a).css("background","none");$(a).css("color","black");$(a).removeAttr("aria-haspopup")}},resetFocus:function(a){},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}}},{NAME:"mInterviewPage"});puremvc.define({name:"jet.view.page.mobile.mTextPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="container";$(this.myDiv).addClass("mPage");this.rowDiv=document.createElement("div");this.rowDiv.className="row";$(this.myDiv).append(this.rowDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="column";$(this.rowDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,rowDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:"false",executedSetCustomScore:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,m,h,p,o){switch(m){case jet.AppConstants.NODES_MANAGER:var q=f.getTag(h);if(q=="calcNodeOptions"){f.calcOptions=this.cloneBranchOptions(o)}else{f.branchOptions=o}break;case jet.AppConstants.TEXT:var q=f.getTag(h);if(q=="totalpoints"){f.setTotalPoints(p)}else{if(q=="textBlock"&&p.length>0){var n=new jet.view.component.ViewComponent;n.setParent(f.contentDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(n,h);var e=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=e.exec(p);var d=b[2];if(d==""){d=b[1]}var l=d;var k=l.split("&lt;s&gt;");for(var a=0;a<k.length;a++){if(k[a]!=null&&k[a]!=undefined){this.processQuestionComponent(k[a])}}}}break;case jet.AppConstants.CHECKBOX:var q=f.getTag(h);if(q=="hideAnswer"){f.setHideAnswer(p)}if(q=="flowstatus"){if(p=="true"){f.setInFlow(false)}}break;case jet.AppConstants.AUDIO:if(p.length<1){return}var n=new jet.view.component.HTMLAudioComponent;n.setMediaURL(p);n.setAudioOptions(o);n.setParent(this.myDiv);n.setProperties(h);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(n,h);this.components.push(n);break;case jet.AppConstants.ACCESSIBILITY_TEXT:this.setAlternativeContent(p);break}},processQuestionComponent:function(m){var l=new jet.view.component.OpenQuestionComponent;this.components.push(l);l.setContentClass("qitem");l.setParent(this.contentDiv,this);var k=m.split("&lt;d&gt;");if(k!=null){l.addQuestionStem(k[0]);for(var d=1;d<k.length;d++){if(k[d]==null|k[d]==undefined){continue}var b="false";var a=/(\*)/;var f=k[d];if(a.test(f)){b="true"}var e=/\*/;var h=f.replace(e,"");l.addDistractor(h,b)}}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){$(this.myDiv).attr("id",this.uid);for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},getCalcOptions:function(){return this.calcOptions},calculateNumberOfCorrectAnswers:function(){var a=0;for(var b=0;b<this.answerKeys.length;b++){if(this.answerKeys[b]=="true"){a++}}return a},evaluateUserActivity:function(){this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var f=this.getTotalPoints()/this.calculateNumberOfCorrectAnswers();for(var d=0;d<this.userInputComponents.length&&d<this.answerKeys.length;d++){if(this.userInputComponents[d].getUserInput()!=this.answerKeys[d]){e="\u2718";this.setIsUserCorrect(false);var b=parseInt((this.getUserPoints()-f)*10)/10;this.setUserPoints(b);var a="\u2718";if(this.answerKeys[d]=="true"){a="\u25BA"}this.addFeedback(this.userInputComponents[d],a)}if(this.userInputComponents[d].getUserInput()==this.answerKeys[d]&&this.userInputComponents[d].getUserInput()=="true"){this.addFeedback(this.userInputComponents[d],"\u2713")}}return this.getHideAnswer()=="false"?e:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(d,e){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";var a=$(d.getDiv());$(a).prepend(b);this.feedBackComponents.push(b);$(b).css("position","relative");$(b).css("float","left");$(b).css("top","0px");$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},getContentAsResource:function(){return $(this.contentDiv).html()}},{NAME:"mTextPage"});puremvc.define({name:"jet.view.widget.Widget",constructor:function(){}},{widgetClassName:null,processDiv:function(a){},getWidgetClassName:function(){return this.widgetClassName},enableInteractivity:function(){},generateArray:function(){var a=[];return a},getAttribute:function(b,d){var a=$(b).attr(d);if(typeof a!==typeof undefined&&a!==false){return a}else{a=$(b).attr("data-"+d)}return a}},{TEXT_CHANGED:"textChanged",NAME:"Widget"});puremvc.define({name:"jet.view.widget.DnDWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0006",numberIncorrect:0,currentCategory:null,currentUnCategory:"Uncategorized",popupFeedback:"",currentItem:null,dragOver:null,menuHeight:100,getWidgetClassName:function(){return this.widgetClassName},processDiv:function(a,k){var e=this;var f=this.makeDiv();var n=this.getQuestionStem(a);var m=$(n).attr("data-bgColor");var d=hex2rgba(m);$(f).css("background-color",d);$(f).css("padding","10px");$(f).attr("role","application");$(f).addClass("d_panel");var h=$(n).attr("data-points");var l=$(n).attr("data-random")=="true"?true:false;var b=$(n).attr("data-uncategory");if(typeof b!==typeof undefined&&b!==false){k.currentUnCategory=$(n).attr("data-uncategory")}else{k.currentUnCategory=""}var o=e.getDistractorsParentElement(a,k,h,l);$(f).attr("tabindex","0");$(f).focus();$(f).append(n);$(f).append(o);$(a).replaceWith(f)},makeDiv:function(){var a=document.createElement("div");a.className="QuestionWidget";return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},getDistractorsParentElement:function(h,d,f,a){var b=this;var e=$(h).find(".DistractorParent");this.processDistractors(e,d,f,a,b);return e},processDistractors:function(q,o,n,p,m){n=parseInt(n);n=n>0?n:0;var k=parseInt(o.getTotalPoints());k=k>0?k:0;k+=n;o.setTotalPoints(k);var b=$(q).find(".Qw_distractor");var f=this.createCategoryDiv(q,o.currentUnCategory);$(f).css("border","1px solid black");for(var h=0;h<b.size();h++){var d=b[h];$(d).attr("style","clear:right;margin-top:10px;padding-top:10px");$(d).attr("data-ordinal",h);$(d).attr("tabindex",0);$(d).attr("aria-grabbed","false");$(d).draggable({helper:"clone",start:function(){m.showMenu(null,false,m);m.dragOver=null;$(this).attr("aria-grabbed","true");$(this).css("cursor","move")},stop:function(){$(this).attr("aria-grabbed","false");$(this).css("cursor","pointer")},});$(d).hover(function(){m.setCurrentItem(m,this)},function(){m.abdicateCurrentItem(m,this)});$(d).on("focus",function(){m.handleFocus(m,this)});$(d).on("blur",function(){m.handleBlur(m,this)});$(d).droppable({hoverClass:"Qw_distractor",over:function(){m.dragOver=this}});$(d).css("width","40%");$(d).css("padding","10px");$(d).css("display","flex");$(d).css("cursor","grab");var a=document.createElement("div");$(a).addClass("feedbackdiv");$(a).width("100%");$(a).html("<pre>   </pre>");$(a).attr("style","display:inline-block;margin-right:10px; min-width:20px; text-indent:0px");$(d).prepend(a);$(f).append(d);if(p){$(d).remove}}if(p){m.randomizeDistractors(b,f)}var l=m.getCategories(q,m);m.createMenu(q,l,m);var e=this.createSubmitButton(q,o,this,n);$(q).keyup(function(r){m.keyboardHandler(r,m);r.stopPropagation()});this.submitButton=e;$(q).prepend(e)},randomizeDistractors:function(f,h){for(var d=f.length-1;d>0;d--){var a=f[d];var e=parseInt(Math.random()*(d+1));f[d]=f[e];f[e]=a}for(var b=0;b<f.length;b++){$(h).append(f[b]);$(f[b]).attr("tabindex","0")}},processAnswer:function(o,k,h){var n=$(o).parent().find(".QuestionStem").first();var p=$(n).find("p").first().text();h=h>0?h:0;this.numberIncorrect=0;var m=this.getNumberOfCorrectAnswersFromAnswerKey(o);var b=this.checkAnswers(o,p);this.setDraggable(o,"disable");if(b){var f=k.getUserPoints();k.setUserPoints(h+f)}else{var a=$(o).find(".Qw_distractor");var d=a.size();var e=h/m;var l=Math.ceil(h-(this.numberIncorrect*e));l=Math.max(0,l);var f=k.getUserPoints();k.setUserPoints(l+f)}k.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(k,k.uid);this.appendScoreMessage(o,b?h:l,h)},checkAnswers:function(t,e){this.popupFeedback="";var u=true;var d=true;var m=this.getAttribute(t,"token");var s="AES_Encryption_2";var x="RandomInitVector";var m=validate(m,s,x);var r=m.split(";");var b=$(t).find(".Qw_distractor");for(var w=0;w<b.size();w++){var q=$(b).get(w);var k=$(q).text();var v=$(q).attr("data-ordinal");var z="";if(r[v]){z=r[v].toUpperCase()}var l=" ";if($(q).parent()&&$(q).parent().attr("data-category")){l=$(q).parent().attr("data-category").toUpperCase()}z=stripSpaces(z);var n=(z==l)?true:false;var h="";if(n){d=true;h="\u2713"}else{d=false;h="\u2718"}if(d==false){this.numberIncorrect++;u=false}$(q).find(".feedbackdiv").html(h);var f=d?"Correct":"Incorrect";var a={uid:"",questionType:"Matching",question:e,learnerResponse:k+"placed in "+l,correctResponse:z,feedBack:f,result:""};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,a);var y=$(q).attr("data-name_feedback");var p=qValidate(y);var o=a.learnerResponse.trim();this.popupFeedback+=o+"<br>"+f+"<br>"+p+"<br><br>"}jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,this.popupFeedback);return u},setDraggable:function(f,d){var e=$(f).find(".Qw_distractor");for(var b=0;b<e.size();b++){var a=$(e).get(b);if($(a).hasClass("ui-draggable")){$(a).draggable(d)}}},getCategories:function(p,h){var k=[];var d=this.getAttribute(p,"token");var o="AES_Encryption_2";var e="RandomInitVector";var d=validate(d,o,e);var m=d.split(";");var a=$(p).find(".Qw_distractor");for(var f=0;f<a.size();f++){var b=$(a).get(f);var l=$(b).attr("data-ordinal");var n=m[l];if(k[n]==null){h.createCategoryDiv(p,n);k[n]=n}}return k},createCategoryDiv:function(l,b){var e=this;var h=document.createElement("div");var d=document.createElement("div");var f=document.createElement("span");$(f).css("font-weight","bold");$(f).css("-webkit-font-smoothing","antialiased");$(h).addClass("Category");var k=stripSpaces(b);$(h).attr("data-category",k);$(h).attr("style","display:flex; justify-content:center;flex-direction:column;flex-wrap:wrap;border:3px dotted black;border-radius: 10px; width:50%; padding:10px;margin:5px; overflow:hidden");$(d).attr("style","display:flex;justify-content:center;align-items: center; width:100%; padding-bottom:10px; background-color:#f7f7f7");$(f).text(b);$(d).append(f);$(h).append(d);$(l).append(h);var a=h;$(h).droppable({hoverClass:"ui-state-active",over:function(m,n){$(this).css("box-shadow","4px 4px green");$(this).attr("aria-dropeffect","move")},out:function(m,n){$(this).css("box-shadow","none");$(this).removeAttr("aria-dropeffect")},drop:function(m,n){$(n.draggable).css("border","none");$(n.draggable).css("width","40%");$(this).css("box-shadow","none");$(this).removeAttr("aria-dropeffect");if($.contains(m.target,e.dragOver)){$(e.dragOver).before(n.draggable)}else{$(m.target).append(n.draggable)}}});return h},getNumberOfCorrectAnswersFromAnswerKey:function(r){var n=0;var d=this.getAttribute(r,"token");var q="AES_Encryption_2";var e="RandomInitVector";var d=validate(d,q,e);var o=d.split(";");var a=$(r).find(".Qw_distractor");for(var f=0;f<a.size();f++){var b=$(a).get(f);var l=$(b).find("input");var m=$(b).attr("data-ordinal");var p=o[m];var k=new RegExp("Y|YES|TRUE|T");var h=k.test(p.toUpperCase());if(h){n++}}return n},appendScoreMessage:function(d,e,f){var b=document.createElement("div");$(d).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+e+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(f,d,b,e){var a=document.createElement("button");$(a).addClass("Qw_submitButton");$(a).addClass("chip_dark");$(a).addClass("d_button");$(a).text("Submit");$(a).attr("style","margin:20px;display:block");$(a).on("click",function(){b.processAnswer(f,d,e);$(a).attr("disabled","disabled")});$(a).show();return a},enableInteractivity:function(b){var a=$(b).find(".DistractorParent");$(a).find(".feedbackMessagediv").remove();$(a).find(".feedbackdiv").html("<pre>   </pre>");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".Qw_submitButton").show();$(a).find(".scoreMessagediv").html("");this.setDraggable(a,"enable")},keyboardHandler:function(m,l,n){if(m.stopPropogation){m.stopPropogation()}if($(m.target).hasClass("Qw_distractor")||$(m.target).hasClass("dndMenuItem")){var b=m.keyCode;var k=l.currentItem;var f=$(k).offset();var h=l.isMenuShowing();console.log(h);switch(h){case false:var e="20px";switch(b){case 32:$(k).attr("aria-grabbed","true");$(k).attr("aria-owns","dndMenu");var d=l.showMenu(k,true,l);if(d!=null){$(d).css("top",e);$(l.currentItem).after(d);var a=$(d).find("li").first();$(a).focus()}break}break;case true:if(m.preventDefault){m.preventDefault()}m=m||window.event;var k=m.target||m.srcElement;var b=m.keyCode;switch(b){case 40:objFocus=k.nextSibling;if(!objFocus){objFocus=$(k).parent().find("li").first()}objFocus.focus();break;case 38:objFocus=k.previousSibling;if(!objFocus){objFocus=$(k).parent().find("li").last()}objFocus.focus();break;case 13:l.moveItem(l,l.currentItem,$(k).text());l.resetFocus(l);break;case 27:$(l.currentItem).removeAttr("aria-owns");$(l.currentItem).removeAttr("aria-dropeffect");$(l.currentItem).attr("aria-grabbed","false");l.showMenu(null,false,l);l.resetFocus(l);break}break}}},createMenu:function(e,a,b){var d=document.createElement("ul");$(d).addClass("dndMenu");$(d).attr("id","dndMenu");$(d).attr("role","menu");$(d).css("padding-left","60px");$(d).css("padding-top","10px");$(d).css("padding-bottom","10px");$(d).css("position","relative");$(d).css("width","50%");$(d).css("background-color","white");$(d).css("border","2px solid black");for(key in a){objChoice=document.createElement("li");objChoice.appendChild(document.createTextNode(key));$(objChoice).attr("role","listitem");$(objChoice).addClass("dndMenuItem");$(objChoice).attr("tabindex","0");$(objChoice).on("focus",function(){});d.appendChild(objChoice)}$("menu").on("keyup",function(f){b.keyboardHandler(f,b,key)});$(e).prepend(d);$(d).css("display","none")},showMenu:function(a,d,b){if(d==true&&$(".clonedMenu").size()<1){var e=$(a).closest(".DistractorParent").find(".dndMenu").clone(true,true);$(e).css("display","block");$(e).css("background-color","#171717");$(e).css("color","white");$(e).addClass("clonedMenu");$(e).find("li").removeClass("focus");b.menuHeight=$(e).height();return e}else{if(d==true){return null}else{$(".clonedMenu").empty();$(".clonedMenu").remove()}}},isMenuShowing:function(){if($(".clonedMenu").css("display")=="block"){return true}else{return false}},moveItem:function(d,b,a){a=stripSpaces(a);var e=$(b).closest(".DistractorParent").find("div[data-category="+a+"]")[0];$(e).append(b);d.deSelect(d,b);d.showMenu(null,false,d)},setCurrentItem:function(b,a){if(!b.isMenuShowing()){$(a).focus();b.currentItem=a;$(a).css("background-color","black");$(a).css("color","white")}},abdicateCurrentItem:function(b,a){$(a).css("background","none");$(a).css("color","black")},deSelect:function(b,a){$(a).css("background","none");$(a).css("color","black")},handleFocus:function(b,a){if(!b.isMenuShowing()){b.currentItem=a;$(a).css("background-color","black");$(a).css("color","white");$(a).attr("aria-haspopup","true")}},handleBlur:function(b,a){if(!b.isMenuShowing()){$(a).css("background","none");$(a).css("color","black");$(a).removeAttr("aria-haspopup")}},resetFocus:function(b){var d=$(b.currentItem).closest(".DistractorParent").find("div[data-category=Uncategorized]")[0];var a=$(d).find(".Qw_distractor").first();if(typeof a!="undefined"){$(a).focus()}else{$(b.currentItem).focus()}}},{TEXT_CHANGED:"textChanged",NAME:"DnDWidget"});puremvc.define({name:"jet.view.widget.EmbeddedVariableWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0010",numberIncorrect:0,popupFeedback:"",currentDiv:null,getWidgetClassName:function(){return this.widgetClassName},getOriginalEmbeddedVarString:function(a){var b=$(a).attr("data-original");return b},setOriginalEmbeddedVarString:function(a){var b=$(a).html();$(a).attr("data-original",b)},processDiv:function(a,p){var b=p.getDiv();var n=this.makeDiv();var d=p.updateText;var m=this;$(n).attr("id",$(a).attr("id"));var r=this.getQuestionStem(a);var q=$(r).attr("data-bgColor");var h=hex2rgba(q);$(n).css("background-color",h);$(n).css("padding","10px");this.prepareText(n,a,p,r);$(a).replaceWith(n);var f=n;var k=p;var l=this.getQuestionStem(f);var o=new MutationObserver(function(s){for(var v=0;v<s.length;v++){var t=s[v];if(t.type==="attributes"){var u=t.target;var w="true";if($(u).attr("data-updated")){w=$(u).attr("data-updated")}if(!$(u).css(":hidden")&&this.currentDiv!=u||w!="true"){console.log("reprocess");console.log("The "+t.attributeName+" attribute was modified.");m.updateText(m,f,k,l);this.currentDiv=u;break}}}});var e={attributeFilter:["data-updated"],attributes:true,childList:false,subtree:false};o.observe(b,e)},makeDiv:function(){var a=document.createElement("div");a.className="EmbeddedVariableWidget";$(a).addClass("QuestionWidget");return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},prepareText:function(d,k,f,e){var b=$(e).html();var h=$(k).find(".contentDiv");var a=this.prepareCustomVariables(h);var e=this.createQuestionStem(b);$(e).attr("data-custom",JSON.stringify(a));this.setOriginalEmbeddedVarString(e);$(d).append(e)},updateText:function(m,d,o,r){var k=m.getOriginalEmbeddedVarString(r);var e=JSON.parse($(r).attr("data-custom"));for(var f in e){expression=m.parseExpression(e[f]);var a=m.parseScript(expression);var p=new RegExp("{"+f+"}","g");k=k.replace(p,a)}var s=k.match(/\{.*?\}/g);if(s&&s.length>0){for(var l=0;l<s.length;l++){var b=s[l];var h=b.substring(1,b.length-1);var q=getJetValue(h);if(typeof q==="object"){q=m.parseObject(q)}k=k.replace(b,q)}}var n=m.getQuestionStem(d);$(n).html(k)},parseExpression:function(f){var a=f.match(/\{.*?\}/g);if(a&&a.length>0){for(var b=0;b<a.length;b++){var e=a[b];var h=e.substring(1,e.length-1);var d=getJetValue(h);if(typeof d==="object"){d=widget.parseObject(d)}f=f.replace(e,d)}}return f},prepareCustomVariables:function(b){var a={};$(b).each(function(e,f){var d=$(this).attr("data-variable").trim();var h=$(this).attr("data-expression").trim();a[d]=h});return a},createQuestionStem:function(a){var b=document.createElement("div");$(b).addClass("QuestionStem");$(b).append(a);return b},parseObject:function(f){var b="";var d=Object.keys(f);for(var a=0;a<d.length;a++){if(!isEmpty(b)){b+=", "}var e=d[a];b+=e}return b},parseScript:function(d){if(typeof jsParser&&typeof jsParser.parseAndExecute!=="undefined"&&jsParser.parseAndExecute!=null){try{var a=jsParser.parseAndExecute(d,getExposedMethods(),10000);return a}catch(b){window.alert(b)}}}},{TEXT_CHANGED:"textChanged",NAME:"WordProblemWidget"});puremvc.define({name:"jet.view.widget.GeolocationWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0011",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(k,h){$(k).hide();var f=this;var a=this.getGeoProperties(k);var e=this.parseLocations(k);var d=this.getFirstDescription(k);var b=setInterval(function(){if(googleMap){clearInterval(b);f.createMapObject(a,e,d);$(k).remove()}},1000)},createMapObject:function(e,r,f){var b=null;var w=$(e).attr("data-shape");var s=$(e).attr("data-stroke-color");var q=$(e).attr("data-stroke-width");var d=$(e).attr("data-stroke-opacity");var h=$(e).attr("data-fill-color");var v=$(e).attr("data-fill-opacity");var x=$(e).attr("data-content-link");var a=Number($(e).attr("data-circle-radius"));if(console&&console.log){console.log("Creating Map Object: "+w)}switch(w){case"Polygon":b=new google.maps.Polygon({paths:r,strokeColor:s,strokeOpacity:d,strokeWeight:q,fillColor:h,fillOpacity:v});break;case"Polyline":b=new google.maps.Polyline({path:r[0],geodesic:true,strokeColor:s,strokeOpacity:d,strokeWeight:q});break;case"Circle":b=new google.maps.Circle({center:r[0][0],radius:a,strokeColor:s,strokeOpacity:d,strokeWeight:q,fillColor:h,fillOpacity:v});break;case"Rectangle":b=new google.maps.Polygon({paths:r[0],strokeColor:s,strokeOpacity:d,strokeWeight:q,fillColor:h,fillOpacity:v});break}var p=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var n=p.retrieveMediator(jet.view.mediator.PageMediator.NAME);var l="0";var m=f;if(x.indexOf("ID:")>-1){l=$.trim(x).replace(/.*\(ID:|\)/g,"");var t=n.getNode(l);if(!isEmpty(t)){var k=t.getContentAsResource();switch(k){case"REPARENT":var u=t.getReParentedContent();var o=$(u.getContentDiv()).clone();$(o).find("*:not('img, video,iframe')").filter(function(){return $.trim(this.innerHTML)==""}).remove();m=$(o).html();break}}}google.maps.event.addListener(b,"click",function(z){var y=getInfoWindowInstance();y.setContent(m);y.setPosition(z.latLng);y.open(googleMap)});b.setMap(googleMap)},getGeoProperties:function(a){return $(a).find(".geoPropertiesElement")},getFirstDescription:function(b){var a=$(b).find(".contentDiv").first();if(!isEmpty(a)){var d=$(a).attr("data-description");if(!isEmpty(d)){d=d.trim()}return d}return"No content"},parseLocations:function(a){var b=[];var d=[];var e=$(a).find(".contentDiv");$(e).each(function(m,k){var p=$(this).attr("data-geolocation").trim();var n=p.split(";");for(var l=0;l<n.length;l++){var q=n[l];var h=q.split(":");if(h.length==2){var o=h[0];var f=h[1];var r=new Object();r.lat=Number(o);r.lng=Number(f);d.push(r)}}b.push(d)});return b}},{TEXT_CHANGED:"textChanged",NAME:"GeolocationWidget"});puremvc.define({name:"jet.view.widget.ImageLayoutWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0012",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(a,f){var m=[];var n=false;var b=$(a).attr("data-random");if(b=="true"){n=true}var e=$(a).attr("data-wraptype");var l=$(a).attr("data-layouttype");var o=$(a).attr("data-justifytype");var h=$(a).attr("data-imageheight");var p=(Number(h)+Number($(a).find(".captionDivElement").height()))+"px";var k=$(a).attr("data-bgColor");$(a).addClass("FlexLayoutWidget");$(a).addClass("d_panel");$(a).css("border","none");$(a).css("background-image","none");$(a).css("display:block");$(a).css("margin:10px");$(a).css("margin-bottom","50px");$(a).css("contain","layout paint");$(a).css("min-width","0");$(a).css("display","flex");$(a).css("flex","0 1 auto");if(!isEmpty(l)){$(a).css("flex-direction",l)}if(!isEmpty(o)){$(a).css("justify-content",o)}if(!isEmpty(e)){$(a).css("flex-wrap",e)}if(!isEmpty(k)){var d=hex2rgba(k);$(a).css("background-color",d)}$(a).find(".outerImageDiv").each(function(){if(n){$(this).remove();m.push(this)}$(this).css("flex-shrink","1");$(this).css("max-height",p);var q=f.getMediator(jet.view.mediator.ImageMediator.NAME);q.processElement(f,this)});$(a).find("img").each(function(){$(this).addClass("d_image");$(this).removeAttr("width");$(this).css("margin","0");$(this).css("padding","0");$(this).css("width","auto");$(this).css("max-height",h);var s=$(this).attr("alt");var q=$(this).parent();var r=$(this).parent().parent().find(".captionDivElement");$(r).find("p").text(s);var t=getContrastYIQ(k);$(r).find("p").css("color",t);$(r).find("p").css("text-align","center")});if(n){this.randomizeDistractors(m,a)}},randomizeDistractors:function(f,h){for(var d=f.length-1;d>0;d--){var a=f[d];var e=parseInt(Math.random()*(d+1));f[d]=f[e];f[e]=a}for(var b=0;b<f.length;b++){$(h).append(f[b])}},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"PwgImageSliderWidget"});puremvc.define({name:"jet.view.widget.ImageSliderWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0004",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(f,e){$(f).css("border","none");$(f).css("background-image","none");$(f).css("padding","0");var a=$(f).find(".outerImageDiv");$(a).css("margin","auto");$(a).css("background","#000000");$(a).css("background-color","#000000");var d=$(f).find(".captionDivElement");$(d).css("text-align","center");$(d).css("background-color","#000000");$(d).css("min-height","50px");$(d).css("width","100%");var b=$(f).find(".imageCaption");$(b).css("background-color","#000000");$(b).css("color","#FFFFFF");$(b).css("padding","10px");$(b).css("display","inline-block");$(f).on("init",function(m,k){var l=$(f).find("img")[0];var h=$(l).attr("alt");$(n).text("");var n=$(f).find(".imageCaption")[0];$(n).text(h)});$(f).slick({dots:true,infinite:true,speed:500,fade:true,centerMode:true,cssEase:"linear",verticalSwiping:false});$(f).on("afterChange",function(m,h,p,o){var l=h.$slides.get(p);var n=$(l).find("img")[0];var k=$(l).find(".imageCaption")[0];$(k).text($(n).attr("alt"))})},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"ImageSliderWidget"});puremvc.define({name:"jet.view.widget.InputWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0016",popupFeedback:"",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(f,b){var e=null;var a=$(f).find(".DistractorParent");var d=$(f).find(".variableInput").first();$(d).addClass("d_field");if(!isEmpty(a)){e=$(a).attr("data-variable");$(d).attr("id",e.replace(/ /g,""))}if(!isEmpty(d)&&!isEmpty(e)){$(d).change(function(){setJetValue(e,$(this).val())})}},makeDiv:function(){},getDistractorsParentElement:function(d,a,b){},processDistractors:function(d,a,b){},processAnswer:function(d,a,b){},checkAnswers:function(a){},createAnswerOptions:function(a){},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"InputWidget"});puremvc.define({name:"jet.view.widget.MatchingWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0017",serial:0,currentItem:null,getWidgetClassName:function(){return this.widgetClassName},processDiv:function(s,n){$(s).find(".widgetTitle").remove();this.serial++;var l=[];var h=[];var q=[];var u=[];var b=[];var k=this;var r=document.createElement("div");var e=document.createElement("div");var a=document.createElement("div");var f=s;f.append(e);f.append(r);f.append(a);var d=$(s).attr("data-points");d=d>0?d:0;var w=parseInt(n.getTotalPoints());w=w>0?w:0;w+=Number(d);n.setTotalPoints(w);var y=$(s).attr("data-wraptype");var z=$(s).attr("data-layouttype");var p=$(s).attr("data-justifytype");var x=$(s).attr("data-imageheight");var t=(Number(x)+Number($(s).find(".captionDivElement").height()))+"px";var o=$(s).attr("data-bgColor");var v=getContrastYIQ(o);$(f).addClass("MatchingWidget");$(f).addClass("d_panel");$(f).css("border","5px solid black");$(f).css("display:block");$(f).css("margin:10px");$(f).css("margin-bottom","50px");$(f).css("contain","layout paint");$(f).css("min-width","0");$(f).css("display","flex");$(f).css("flex","0 1 auto");$(r).addClass("MatchingTargetArea");$(r).css("border","none");$(r).css("display:block");$(r).css("margin:10px");$(r).css("margin-bottom","50px");$(r).css("contain","layout paint");$(r).css("min-width","0");$(r).css("display","flex");$(r).css("flex","0 1 auto");$(r).css("height","100%");$(e).addClass("MatchingDragItemArea");$(e).css("border","none");$(e).css("display:block");$(e).css("margin:10px");$(e).css("margin-bottom","50px");$(e).css("min-width","0");$(e).css("display","flex");$(e).css("flex","0 1 auto");$(e).css("overflow","visible");$(a).css("overflow","hidden");$(a).css("flex","0 1 auto");this.generateButtons(k,f,a,n,d,h,q,u,e,v,o);if(isEmpty(z)){z="row"}switch(z){case"row":$(f).css("flex-direction","column");$(r).css("flex-direction","row");$(e).css("flex-direction","row");break;case"column":$(f).css("flex-direction","row");$(r).css("flex-direction","column");$(e).css("flex-direction","column");break}if(!isEmpty(p)){$(r).css("justify-content",p);$(e).css("justify-content",p)}if(!isEmpty(y)){$(f).css("flex-wrap","nowrap");$(r).css("flex-wrap",y);$(e).css("flex-wrap",y)}if(!isEmpty(o)){var m=hex2rgba(o);$(r).css("background-color",m)}$(s).find(".outerImageDiv").each(function(){$(this).css("flex-shrink","1");$(this).css("max-height",t);var A=n.getMediator(jet.view.mediator.ImageMediator.NAME);A.processElement(n,this)});$(s).find("img").each(function(H){$(this).removeAttr("width");$(this).css("margin","0");$(this).css("padding","0");$(this).css("width","auto");$(this).css("max-height",x);$(this).css("user-select","none");var A=$(this).attr("src").replace("base/base","");var F=isEmpty(A)?"none":"block";$(this).css("display",F);$(this).css("margin","auto");var I=$(this).parent();$(I).css("background-color","white");$(I).css("border","2px solid black");$(I).css("border-radius","20px");$(I).css("min-width","150px");$(I).css("padding","10px");$(I).css("display","flex");$(I).css("margin","10px");$(I).css("flex-direction","column");$(I).css("overflow","hidden");var G=$(this).parent().parent().find(".captionDivElement");b.push($(G).find("p").text());var D=getContrastYIQ(o);$(G).find("p").css("color",D);$(G).css("height","20%");$(G).find("p").css("text-align","center");$(G).find("p").css("user-select","none");var B=document.createElement("div");$(B).addClass("targetAreaElement");$(B).css("border","2px dotted "+v);$(B).css("width","90%");$(B).css("min-height","30px");$(B).css("margin","10px");$(B).attr("id","tae"+k.serial+"-"+H);var C=stripSpaces(stripNonAlphaNumeric($(G).find("p").text()));$(B).attr("data-category",C);$(B).css("background-color",o);$(B).droppable({drop:function(K,L){var M=L.draggable;$(M).css("left","0");$(M).css("top","0");$(this).prepend(M);$(M).draggable({disabled:true})}});var E=document.createElement("div");$(E).attr("id","fe"+k.serial+"-"+H);$(E).addClass("feedbackElement");$(E).css("width","40px");$(E).css("height","40px");$(E).css("padding","0px");$(E).css("overflow","hidden");$(E).css("bottom","10px");$(E).css("text-align","center");$(E).css("right","60px");$(E).css("border","5px solid #e7e7e7");$(E).css("border-radius","50%");$(E).css("margin","10px");$(E).css("visibility","hidden");$(I).append(E);u.push(E);$(I).append(G);if(z=="row"){$(I).prepend(B)}else{$(I).append(B)}$(r).append(I);var J=qValidate($(this).attr("data-match"));$(B).attr("data-match",$(this).attr("data-match"));q.push(B);l.push(J)});k.processDragItems(k,f,l,h,e,v);k.createMenu(f,b,k,v);$(f).keyup(function(A){k.keyboardHandler(A,k,v);A.stopPropagation()})},processDragItems:function(k,h,a,l,p,b){var n=generateRandomNumbers(a.length);for(var e=0;e<a.length;e++){var m=n[e];var o=a[m];var f=document.createElement("div");$(f).addClass("dragContainer");var d=document.createElement("p");$(f).append(d);$(d).append(o);$(d).css("text-align","center");$(f).css("user-select","none");$(f).css("font-weight","bold");$(f).css("z-index","4");$(f).css("margin","5px");$(f).css("padding","3px");$(f).css("color",b);$(f).attr("id","dc"+k.serial+"-"+e);$(f).draggable({start:function(){},containment:h});$(f).hover(function(){k.setCurrentItem(k,this)},function(){k.abdicateCurrentItem(k,this,b)});$(f).on("focus",function(){k.handleFocus(k,this)});$(f).on("blur",function(){k.handleBlur(k,this,b)});$(f).attr("tabindex","0");$(h).keyup(function(q){k.keyboardHandler(q,k,b);q.stopPropagation()});$(p).append(f);l.push(f)}},enableInteractivity:function(d){var b=$(d).find(".matchReset");var a=$(d).find(".matchCheck");$(b).prop("disabled",false);$(a).prop("disabled",false);$(b).click()},generateButtons:function(h,f,p,m,l,k,d,a,q,b,n){var o=document.createElement("button");var e=document.createElement("button");$(o).text("Reset");$(o).addClass("matchReset");$(o).addClass("d_button");$(o).addClass("chip_dark");$(o).addClass("matchReset");$(o).css("margin","10px");$(o).on("click",function(){h.handleReset(h,k,d,a,q,b,n)});$(p).append(o);$(e).text("Submit");$(e).addClass("matchCheck");$(e).addClass("d_button");$(e).addClass("chip_dark");$(e).css("margin","10px");$(e).on("click",function(){h.handleSubmit(m,h,f,l,o,e,k,d,a)});$(p).append(e)},handleReset:function(h,k,d,a,m,b,l){for(var f=0;f<k.length&&f<a.length&&f<d.length;f++){var e=k[f];$(e).draggable({disabled:false});if($(e).parent()!==h.dragDiv){$(e).css("color",b);$(m).prepend(e)}$(d[f]).css("background-color",l);$(a[f]).text("");$(a[f]).css("visibility","hidden")}},handleSubmit:function(m,l,e,b,o,w,h,p,t){var n=0;var G=Math.floor(b/h.length);var f=true;var d=m.getMediator(jet.view.mediator.PageMediator.NAME);for(var y=0;y<h.length;y++){var D=h[y];$(D).draggable("disable");for(var x=0;x<p.length;x++){var u=p[x];var B=$(u).attr("id");var a=$(D).attr("id");var A=qValidate($(u).attr("data-match"));var C=$(D).text();if(isOverlap(B,a)){if(A==C){$(u).css("background-color","lightgreen");$(D).css("color","black");$(t[x]).css("visibility","visible");$(t[x]).text("✓");$(t[x]).css("background-color","lightgreen");$(t[x]).css("user-select","none");n+=G}else{$(u).css("background-color","#f7bfbf");$(D).css("color","black");$(t[x]).css("visibility","visible");$(t[x]).css("font-weight","bold");$(t[x]).text("✘");$(t[x]).css("background-color","#f7bfbf");$(t[x]).css("user-select","none");f=false}}}}for(var v=0;v<t.length;v++){var r=t[v];if($(r).text()!="✓"){f=false;$(r).text("✘");$(r).css("visibility","visible");$(r).css("user-select","none")}}var z=Number(m.getUserPoints());if(isEmpty(z)){z=0}if(f){m.setUserPoints(Number(b)+z);var q=$(e).attr("data-correct_branch");if(!isEmpty(q)){var q=qValidate($(e).attr("data-correct_branch"));var F=l.parseBranchOptions(q);if(!isEmpty(F)){m.setBranchOptions(F);d.processFeedbackAndBranchingOptions(m,true,F)}}}else{m.setUserPoints(Number(n)+z);var s=$(e).attr("data-incorrect_branch");if(!isEmpty(s)){var E=qValidate(s);var F=l.parseBranchOptions(E);if(!isEmpty(F)){m.setBranchOptions(F);d.processFeedbackAndBranchingOptions(m,true,F)}}}m.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(m,m.uid);$(o).prop("disabled",true);$(w).prop("disabled",true)},parseBranchOptions:function(a){if(a!=null&&typeof a!="undefined"){try{var d=JSON.parse(a);return d}catch(b){return""}}},keyboardHandler:function(n,m,f,o){if(n.stopPropogation){n.stopPropogation()}if($(n.target).hasClass("ui-draggable-disabled")){return}if($(n.target).hasClass("dragContainer")||$(n.target).hasClass("dndMenuItem")){var b=n.keyCode;var l=m.currentItem;var h=$(l).offset();var k=m.isMenuShowing();console.log(k);switch(k){case false:var e="20px";switch(b){case 32:$(l).attr("aria-grabbed","true");$(l).attr("aria-owns","dndMenu");var d=m.showMenu(l,true,m);if(d!=null){$(d).css("top",e);$(m.currentItem).after(d);var a=$(d).find("li").first();$(a).focus()}break}break;case true:if(n.preventDefault){n.preventDefault()}n=n||window.event;var l=n.target||n.srcElement;var b=n.keyCode;switch(b){case 40:objFocus=l.nextSibling;if(!objFocus){objFocus=$(l).parent().find("li").first()}objFocus.focus();break;case 38:objFocus=l.previousSibling;if(!objFocus){objFocus=$(l).parent().find("li").last()}objFocus.focus();break;case 13:m.moveItem(m,m.currentItem,$(l).text(),f);m.resetFocus(m);break;case 27:$(m.currentItem).removeAttr("aria-owns");$(m.currentItem).removeAttr("aria-dropeffect");$(m.currentItem).attr("aria-grabbed","false");$(m.currentItem).css("background","none");$(m.currentItem).css("color","black");m.showMenu(null,false,m);m.resetFocus(m);break}break}}},createMenu:function(f,b,e,a){var h=document.createElement("ul");$(h).addClass("dndMenu");$(h).attr("id","dndMenu");$(h).attr("role","menu");$(h).css("padding-left","60px");$(h).css("padding-top","10px");$(h).css("padding-bottom","10px");$(h).css("position","relative");$(h).css("width","50%");$(h).css("background-color","white");$(h).css("border","2px solid black");for(key in b){objChoice=document.createElement("li");var d=stripNonAlphaNumeric(b[key]);objChoice.appendChild(document.createTextNode(d));$(objChoice).attr("role","listitem");$(objChoice).addClass("dndMenuItem");$(objChoice).attr("tabindex","0");$(objChoice).on("focus",function(){});h.appendChild(objChoice)}$("menu").on("keyup",function(k){e.keyboardHandler(k,e,a,key)});$(f).prepend(h);$(h).css("display","none")},showMenu:function(a,d,b){if(d==true&&$(".clonedMenu").size()<1){var e=$(a).closest(".MatchingWidget").find(".dndMenu").clone(true,true);$(e).css("display","block");$(e).css("background-color","#171717");$(e).css("color","white");$(e).addClass("clonedMenu");$(e).find("li").removeClass("focus");b.menuHeight=$(e).height();return e}else{if(d==true){return null}else{$(".clonedMenu").empty();$(".clonedMenu").remove()}}},isMenuShowing:function(){if($(".clonedMenu").css("display")=="block"){return true}else{return false}},moveItem:function(e,d,b,a){b=stripSpaces(b);var f=$(d).closest(".MatchingWidget").find("div[data-category="+b+"]")[0];$(f).append(d);e.deSelect(e,d,a);e.showMenu(null,false,e)},setCurrentItem:function(b,a){if(!b.isMenuShowing()){$(a).focus();b.currentItem=a;$(a).css("background-color","black");$(a).css("color","white")}},deSelect:function(d,b,a){$(b).css("background","none");$(b).css("color",a)},abdicateCurrentItem:function(d,b,a){$(b).css("background","none");$(b).css("color",a)},handleFocus:function(b,a){if(!b.isMenuShowing()){b.currentItem=a;$(a).css("background-color","black");$(a).css("color","white");$(a).attr("aria-haspopup","true")}},handleBlur:function(d,b,a){if(!d.isMenuShowing()){$(b).css("background","none");$(b).css("color",a);$(b).removeAttr("aria-haspopup")}},resetFocus:function(a){var b=$(a.currentItem).closest(".MatchingWidget").first();if(typeof b!="undefined"){$(b).focus()}else{$(a.currentItem).focus()}}},{TEXT_CHANGED:"textChanged",NAME:"MatchingWidget"});puremvc.define({name:"jet.view.widget.PwgImageSliderWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0007",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(h,e){$(h).find(".widgetTitle").remove();$(h).addClass("refreshCandidate");$(h).addClass("QuestionWidget");$(h).css("border","none");$(h).css("background-image","none");$(h).css("display:block");$(h).css("margin:20px");$(h).css("margin-bottom:50px");$(h).css("max-width:800px");var b=$(h).attr("data-displaylist")=="true"?true:false;var f=$(h).attr("data-slidetransition")=="true"?true:false;var a=f==true?"sliding":"fading";var d=document.createElement("ul");$(d).attr("id","pgwSlider_"+e.uid);$(d).addClass("pgwSlider");$(h).append(d);$(h).find("img").each(function(){var k=document.createElement("li");$(d).append(k);$(k).append(this)});$(h).find(".outerImageDiv").each(function(){$(this).remove()});$(d).pgwSlider({autoSlide:false,displayList:b,displayControls:true,transitionEffect:a,"max-height":500})},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"PwgImageSliderWidget"});puremvc.define({name:"jet.view.widget.QuestionWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0001",numberIncorrect:0,popupFeedback:"",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(a,k){var f=this.makeDiv();$(a).addClass("d_panel");var n=this.getQuestionStem(a);$(n).addClass("d_stem");var m=$(n).attr("data-bgColor");var e=hex2rgba(m);$(f).css("background-color",e);$(f).css("padding","10px");$(f).addClass("d_panel");var d=$(n).attr("data-marginleft");if(!isEmpty(d)){$(f).css("margin-left",d)}var b=$(n).attr("data-margintop");if(!isEmpty(b)){$(f).css("margin-top",b)}var h=$(n).attr("data-points");var l=$(n).attr("data-random")=="true"?true:false;var o=this.getDistractorsParentElement(a,k,h,l);$(f).append(n);$(f).append(o);$(a).replaceWith(f)},makeDiv:function(){var a=document.createElement("div");a.className="QuestionWidget";return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},getDistractorsParentElement:function(f,b,e,a){var d=$(f).find(".DistractorParent");this.processDistractors(d,b,e,a);return d},processDistractors:function(p,m,l,o){l=parseInt(l);l=l>0?l:0;var h=parseInt(m.getTotalPoints());h=h>0?h:0;h+=l;m.setTotalPoints(h);var b=$(p).find(".Qw_distractor, .Qw_MCDistractor");var e=this.createSubmitButton(p,m,this,l);this.submitButton=e;var n=getUniqueName();for(var f=0;f<b.size();f++){var d=b[f];$(d).addClass("d_distractor");$(d).addClass("chip_light");$(d).attr("style","clear:right;margin-top:10px;padding-top:10px");$(d).attr("data-ordinal",f);var k=document.createElement("input");if($(d).hasClass("Qw_MCDistractor")){$(k).attr("type","radio");$(k).attr("name",n)}else{$(k).attr("type","checkbox")}$(k).addClass("Qw_checkBox");$(k).attr("style","margin-right:10px; margin-bottom:0px;float:left");$(k).on("click",function(){$(e).show()});$(d).prepend(k);var a=document.createElement("div");$(a).addClass("feedbackdiv");$(a).addClass("d_feedback");$(a).width("20px");$(a).height("20px");$(a).html("<pre>   </pre>");$(a).attr("style","display:inline-block;margin-right:10px; min-width:20px;max-width:20px;max-height:15px; text-indent:0px; float:left");$(d).prepend(a);if(o){$(d).remove}}if(o){this.randomizeDistractors(b,p)}$(p).append(e)},randomizeDistractors:function(f,h){for(var d=f.length-1;d>0;d--){var a=f[d];var e=parseInt(Math.random()*(d+1));f[d]=f[e];f[e]=a}for(var b=0;b<f.length;b++){$(h).append(f[b])}},processAnswer:function(q,k,b){var d=k.getMediator(jet.view.mediator.PageMediator.NAME);var l=$(q).parent().find(".QuestionStem").first();var h=$(l).find("p").first().text();var a={uid:"",questionType:"",question:h,learnerResponse:"",correctResponse:"",feedBack:"",result:""};b=b>0?b:0;this.numberIncorrect=0;var s=this.getNumberOfCorrectAnswersFromAnswerKey(q);var f=this.checkAnswers(q,a);if(f){var r=k.getUserPoints();k.setUserPoints(b+r);var m=$(l).attr("data-correct_branch");if(!isEmpty(m)){var m=qValidate($(l).attr("data-correct_branch"));var u=this.parseBranchOptions(m);if(!isEmpty(u)){k.setBranchOptions(u);d.processFeedbackAndBranchingOptions(k,true,u)}}}else{var e=$(q).find(".Qw_distractor, .Qw_MCDistractor");var v=e.size();var p=b/s;var n=Math.ceil(b-(this.numberIncorrect*p));n=Math.max(0,n);var r=k.getUserPoints();k.setUserPoints(n+r);var o=$(l).attr("data-incorrect_branch");if(!isEmpty(o)){var t=qValidate(o);var u=this.parseBranchOptions(t);if(!isEmpty(u)){k.setBranchOptions(u);d.processFeedbackAndBranchingOptions(k,true,u)}}}k.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(k,k.uid);this.appendScoreMessage(q,f?b:n,b);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,a)},checkAnswers:function(r,a){this.popupFeedback="";var p="Overall, you are correct. <br /><br />";var s=true;var d=true;var f=this.getAttribute(r,"token");var o="AES_Encryption_2";var v="RandomInitVector";var f=validate(f,o,v);var m=f.split(";");var b=$(r).find(".Qw_distractor, .Qw_MCDistractor");for(var u=0;u<b.size();u++){var l=$(b).get(u);var n=$(l).find("input");var t=$(l).attr("data-ordinal");var w=m[t];var h=new RegExp("Y|YES|TRUE|T");var k=h.test(w.toUpperCase());var e="";if(k){a.correctResponse=a.correctResponse+$.trim($(n).parent().text())+"; "}if($(n).is(":checked")){a.learnerResponse=a.learnerResponse+$.trim($(n).parent().text())+"; ";+";";d=k?true:false;var q=d?"correctly":"incorrectly";if(!d){this.popupFeedback+="You "+q+" selected "+$.trim($(n).parent().text())+".<br />"}e=d?"\u2713":"\u2718";this.appendFeedbackMessage(l,a)}else{d=k?false:true;e=d?"<pre>   </pre>":"\u25BA";var q=d?"correctly":"incorrectly";if(!d){this.popupFeedback+="You "+q+" did not select "+$.trim($(n).parent().text())+".<br />"}}if(d==false){this.numberIncorrect++;s=false;p="Overall, you are incorrect. <br /><br />"}$(l).find(".feedbackdiv").html(e)}jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,p+this.popupFeedback);return s},getNumberOfCorrectAnswersFromAnswerKey:function(r){var n=0;var d=this.getAttribute(r,"token");var q="AES_Encryption_2";var e="RandomInitVector";var d=validate(d,q,e);var o=d.split(";");var a=$(r).find(".Qw_distractor, .Qw_MCDistractor");for(var f=0;f<a.size();f++){var b=$(a).get(f);var l=$(b).find("input");var m=$(b).attr("data-ordinal");var p=o[m];var k=new RegExp("Y|YES|TRUE|T");var h=k.test(p.toUpperCase());if(h){n++}}return n},appendFeedbackMessage:function(b,e){var d=document.createElement("div");$(b).append(d);$(d).addClass("feedbackMessagediv");$(d).attr("style","margin:5px;text-indent:100px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var f=$(b).attr("data-name_feedback");var a=qValidate(f);if(a.length>0){var h="<span>feedback: "+a+"</span>";$(d).html(h);e.feedBack=e.feedBack+a+"; "}},appendScoreMessage:function(d,e,f){var b=document.createElement("div");$(d).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+e+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(f,d,b,e){var a=document.createElement("button");$(a).addClass("Qw_submitButton");$(a).addClass("chip_dark");$(a).addClass("d_button");$(a).text("Submit");$(a).attr("style","margin-top:30px; margin-left:20px");$(a).on("click",function(){b.processAnswer(f,d,e);$(a).attr("disabled","disabled");$(f).find(".Qw_checkBox").attr("disabled","disabled")});$(a).show();return a},enableInteractivity:function(b){var a=$(b).find(".DistractorParent");$(a).find(".Qw_checkBox").removeAttr("disabled");$(a).find(".Qw_checkBox").attr("checked",false);$(a).find(".feedbackMessagediv").remove();$(a).find(".feedbackdiv").html("<pre>   </pre>");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".Qw_submitButton").hide();$(a).find(".scoreMessagediv").html("");$(a).find(".scoreMessagediv").html("")},parseBranchOptions:function(a){if(a!=null&&typeof a!="undefined"){try{var d=JSON.parse(a);return d}catch(b){return""}}},},{TEXT_CHANGED:"textChanged",NAME:"QuestionWidget"});puremvc.define({name:"jet.view.widget.ShortAnswerWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0002",popupFeedback:"",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(l,f){var d=this.makeDiv();$(l).addClass("d_div");var e=this.getQuestionStem(l);$(e).addClass("d_stem");var a=$(e).attr("data-bgColor");var b=hex2rgba(a);$(d).css("background-color",b);$(d).addClass("d_panel");$(d).css("padding","10px");var k=$(e).attr("data-points");var h=this.getDistractorsParentElement(l,f,k);$(d).append(e);$(d).append(h);$(l).replaceWith(d)},makeDiv:function(){var a=document.createElement("div");a.className="QuestionWidget";return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},getDistractorsParentElement:function(e,a,d){var b=$(e).find(".DistractorParent");this.processDistractors(b,a,d);return b},processDistractors:function(k,f,h){h=parseInt(h);var d=parseInt(f.getTotalPoints());d=d>0?d:0;d+=h;f.setTotalPoints(d);var b=this.createSubmitButton(k,f,this,h);this.submitButton=b;$(this.submitButton).addClass("d_button");var a=$(k).find(".ShortAnswerInput")[0];$(a).css("margin-top","20px");$(a).css("padding","10px");$(a).addClass("d_field");$(a).on("keydown",function(){$(b).show()});$(a).on("click",function(){$(b).show()});var l=document.createElement("div");$(l).addClass("feedbackdiv");$(l).addClass("d_feedback");$(l).width("20px");$(l).height("20px");$(l).html("<pre>   </pre>");$(l).attr("style","display:inline-block;margin-right:10px; min-width:20px;max-width:20px;max-height:15px; text-indent:0px; float:left");$(k).prepend(l);var e=document.createElement("div");$(e).prepend(b);$(k).append(e)},processAnswer:function(f,d,e){e=e>0?e:0;var b=this.checkAnswers(f);if(b){var a=d.getUserPoints();d.setUserPoints(e+a)}d.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(d,d.uid);this.appendScoreMessage(f,b?e:0,e)},checkAnswers:function(s){this.popupFeedback="";var t=false;var d=false;var f="\u2718";var k=this.getAttribute(s,"token");var q="AES_Encryption_2";var v="RandomInitVector";var k=validate(k,q,v);var p=k.split(";");var a=this.createAnswerOptions(p);var n=$(s).find(".ShortAnswerInput")[0];var h=$(n).val().toUpperCase();for(var u=0;u<a.length;u++){var b=a[u];var r=b.answer.toUpperCase();var w=b.isCorrect;var e=b.feedback;if(r==h){t=true;var m=new RegExp("Y|YES|TRUE|T");var l=m.test(w.toUpperCase());d=l?true:false;f=d?"\u2713":"\u2718";this.appendFeedbackMessage(s,e);break}}if(d==false){t=false}$(s).find(".feedbackdiv").html(f);var o=t?"correct":"incorrect";this.popupFeedback="You answered "+h+".<br>";this.popupFeedback+="Your answer is "+o+".";jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,this.popupFeedback);return t},createAnswerOptions:function(b){var a=0;var e=[];while(a<b.length){var d={answer:"",isCorrect:"",feedback:""};d.answer=b[a];d.isCorrect=b[a+1];d.feedback=b[a+2];e.push(d);a=a+3}return e},appendFeedbackMessage:function(b,a){var d=document.createElement("div");$(b).append(d);$(d).addClass("feedbackMessagediv");$(d).attr("style","margin:5px;text-indent:100px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var e="<span>feedback: "+a+"</span>";$(d).html(e)},appendScoreMessage:function(d,e,f){var b=document.createElement("div");$(d).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+e+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(f,d,b,e){var a=document.createElement("button");$(a).addClass("Qw_submitButton");$(a).addClass("d_button");$(a).addClass("chip_dark");$(a).text("Submit");$(a).attr("style","margin-top:40px; margin-left:20px");$(a).on("click",function(){b.processAnswer(f,d,e);$(a).attr("disabled","disabled");$(f).find(".Qw_checkBox").attr("disabled","disabled")});$(a).show();return a},enableInteractivity:function(b){var a=$(b).find(".DistractorParent");$(a).find(".feedbackMessagediv").remove();$(a).find(".feedbackdiv").html("<pre>   </pre>");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".Qw_submitButton").hide();$(a).find(".scoreMessagediv").html("");$(a).find(".scoreMessagediv").html("")},},{TEXT_CHANGED:"textChanged",NAME:"QuestionWidget"});puremvc.define({name:"jet.view.widget.TextLayoutWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0015",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(a,h){var n=[];var o=false;var b=$(a).attr("data-random");if(b=="true"){o=true}var f=$(a).attr("data-wraptype");var m=$(a).attr("data-layouttype");var p=$(a).attr("data-justifytype");var k=$(a).attr("data-textheight");var e=$(a).attr("data-textwidth");var l=$(a).attr("data-bgColor");$(a).addClass("FlexLayoutWidget");$(a).addClass("d_panel");$(a).css("border","none");$(a).css("background-image","none");$(a).css("display:block");$(a).css("margin:10px");$(a).css("margin-bottom","50px");$(a).css("contain","layout paint");$(a).css("min-width","0");$(a).css("display","flex");$(a).css("flex","0 1 auto");$(a).css("width",e);if(!isEmpty(m)){$(a).css("flex-direction",m)}if(!isEmpty(p)){$(a).css("justify-content",p)}if(!isEmpty(f)){$(a).css("flex-wrap",f)}if(!isEmpty(l)){var d=hex2rgba(l)}$(a).find(".outerTextDiv").each(function(){if(o){$(this).remove();n.push(this)}var s=$(this).attr("data-border_type");var u=$(this).attr("data-border_color");var r=$(a).attr("data-bordersize");if(isEmpty(r)){r=5}$(this).css("padding","10px");$(this).css("display","inline");$(this).css("overflow","hidden");$(this).css("text-overflow","ellipses");$(this).css("user-select","none");$(this).css("min-width","100px");$(this).css("height",k);switch(s){case"No Border":$(this).css("border","none");break;case"Normal Border":$(this).css("border",r+"px solid "+u);break;case"Rounded Border":$(this).css("border",r+"px solid "+u);$(this).css("border-radius","5px");break;case"Rounder Border":$(this).css("border",r+"px solid "+u);$(this).css("border-radius","8px");break;case"Roundest Border":$(this).css("border",r+"px solid "+u);$(this).css("border-radius","12px");break}$(this).css("flex-shrink","1");$(this).css("margin-bottom","10px");$(this).css("background-color",d);var q=getContrastYIQ(l);$(this).css("color",q);var t=h.getMediator(jet.view.mediator.ImageMediator.NAME);t.processElement(h,this)});if(o){this.randomizeDistractors(n,a)}},randomizeDistractors:function(f,h){for(var d=f.length-1;d>0;d--){var a=f[d];var e=parseInt(Math.random()*(d+1));f[d]=f[e];f[e]=a}for(var b=0;b<f.length;b++){$(h).append(f[b])}},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"TextLayoutWidget"});puremvc.define({name:"jet.view.widget.TimelineWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0008",tempData:{},getWidgetClassName:function(){return this.widgetClassName},processDiv:function(f,e){var d=this;d.tempData.args={};d.tempData.dataArray=[];$(f).css("border","none");$(f).css("background-image","none");$(f).css("padding","0");$(f).addClass("QuestionWidget");$(f).find(".outerTimelineDiv").each(function(){var p={};var o=$(this).find(".titleDiv").first().text().trim();var n=$(this).find(".data-subTitle").first().text().trim();var h=$(this).find(".dateDiv").first().text().trim();var l=$(this).find(".pointLabelDiv").first().text().trim();var k=$(this).find(".contentDiv").first().text().trim();var m=$(this).find("img").first();p.isSelected="";p.pName=o;p.pImge=$(m).attr("src").trim();p.title=o;p.subTitle=n;p.dateValue=h;p.pointCnt=l;p.bodyCnt=k;d.tempData.dataArray.push(p)});d.sortData(d,d.tempData.dataArray);var a=document.createElement("div");$(a).addClass("jetTimeline");$(a).addClass("d_panel");$(f).replaceWith(a);var b=$(a).jTLine({callType:"jsonObject",structureObj:d.tempData,formatTitle:function(l,h){var m="";if(h.pImge.trim()){m='<img src="'+h.pImge+'" alt="'+h.title+'"'}var k='<div class="snip1566">'+m+'<span><i class="fa fa-star"></i></span><a href="#"></a></div><span class="timelineTitle"> '+h.pName+"</span>";return k},formatSubTitle:function(h){return'<em><span style="color:blue">'+h+"</span></em>"},formatBodyContent:function(h){return'<p><span class="timelineContent" style="color:#6a6a6a">'+h+"</span></p>"},distanceMode:"fixDistance",eventsMinDistance:60,fixDistanceValue:2,firstPointMargin:1})},sortData:function(d,a){var b=[];$.each(a,function(h,k){var f=k.dateValue;var e=d.getMilliseconds(f);b=d.placeInArray(b,k,e)});d.tempData.dataArray=b},getMilliseconds:function(h){var f=h.split("/");if(f.length==3){var k=f[0];var a=f[1];var e=f[2];var d=new Date(e,k,a);var b=d.getTime();return b}else{return -1}},placeInArray:function(b,d,a){var e=this;var f=false;$.each(b,function(l,k){var h=e.getMilliseconds(k.dateValue);if(a<h){b.splice(l,0,d);f=true;return}});if(!f){b.push(d);return b}else{return b}},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"TimelineWidget"});puremvc.define({name:"jet.view.widget.TimerWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0014",numberIncorrect:0,popupFeedback:"",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(a,l){var b=l.getDiv();var e=this;var f=this.makeDiv();var h=$(a).attr("data-timer_branch");if(!isEmpty(h)){h=qValidate(h)}var n=$(a).attr("data-timer_ID");var m=$(a).attr("data-timer_type");var d=$(a).attr("data-seconds_timer_interval");var o=$(a).attr("data-minutes_timer_interval");$(a).replaceWith(f);var k=new MutationObserver(function(q){for(var u=0;u<q.length;u++){var r=q[u];if(r.type==="attributes"){var t=r.target;if($(t).is(":visible")){console.log("timer");var p=Number(o*60);var w=Number(d);var v=Number(p+w);var s=Number(v*1000);e.updateTimer(e,l,h,n,m,s);return}}}});k.observe(b,{attributes:true})},updateTimer:function(f,e,a,l,d,k){var b=getJetValue(l);switch(d){case"Fire Once":if(isEmpty(b)||isNaN(b)){var h=window.setInterval(function(){clearInterval(h);setJetValue(l,"");var m=f.parseBranchOptions(a);f.processBranchOptions(f,e,m)},k);setJetValue(l,h)}break;case"Fire On Interval":if(isEmpty(b)||isNaN(b)){var h=window.setInterval(function(){var m=f.parseBranchOptions(a);f.processBranchOptions(f,e,m)},k);setJetValue(l,h)}break;case"Stop Timer":if((!isEmpty(b)&&!isNaN(b))){clearInterval(b);setJetValue(l,"")}break;default:break}},makeDiv:function(){var a=document.createElement("div");a.className="TimerWidget";return a},parseBranchOptions:function(a){if(a!=null&&typeof a!="undefined"){try{var d=JSON.parse(a);return d}catch(b){return""}}},processBranchOptions:function(e,d,b){var a=d.getMediator(jet.view.mediator.PageMediator.NAME);if(b!=null&&typeof b!="undefined"){d.setBranchOptions(b);a.processFeedbackAndBranchingOptions(d,true,b)}},},{TEXT_CHANGED:"textChanged",NAME:"TimerWidget"});puremvc.define({name:"jet.view.widget.VideoWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0020",popupFeedback:"",iFrames:[],IFRAMEWIDTH:930,IFRAMEHEIGHT:450,videoSrc:null,isYouTube:true,captionResource:null,videoResource:null,startTime:null,endTime:null,getWidgetClassName:function(){return this.widgetClassName},processDiv:function(h,f){var b=$(h).attr("data-videoSource");var d=!isEmpty(b)?b.toUpperCase():b;if(!isEmpty(d)&&d.indexOf("WWW.YOUTUBE.COM")>-1){var a=b.indexOf("&");a=a>0?a:b.length;var e=b.substring(0,a);e=e.replace(/.*?v=/,"");this.drawYouTubePlayer(e,h,f);this.isYouTube=true;return}else{return}},makeDiv:function(){},enableInteractivity:function(a){},drawYouTubePlayer:function(e,l,d){var h=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var f=h.getVideoIndex();var b="player"+f;var a=document.createElement("iframe");this.iFrames.push(a);$(l).empty();$(l).append(a);a.id=b;$(a).css("width","100%");$(a).css("min-height","480px");$(a).css("height","auto");a.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1&start="+this.startTime+"&end="+this.endTime;var k=setInterval(function(){if(h.isYTAvailable()){h.addPlayer(b,e);clearInterval(k)}},2000)},},{TEXT_CHANGED:"textChanged",NAME:"VideoWidget"});puremvc.define({name:"jet.view.widget.WordProblemWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0009",numberIncorrect:0,popupFeedback:"",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(l,f){var d=this.makeDiv();$(d).addClass("d_panel");var e=this.getQuestionStem(l);if(!isEmpty(a)){var a=$(e).attr("data-bgColor");var b=hex2rgba(a);$(d).css("background-color",b)}$(d).css("padding","10px");var k=$(e).attr("data-points");var h=$(e).attr("data-expression");this.parseWordProblem(d,l,f,k,h,e);$(l).replaceWith(d)},makeDiv:function(){var a=document.createElement("div");a.className="WordProblemWidget";$(a).addClass("QuestionWidget");return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},parseWordProblem:function(d,a,k,e,h,n){e=parseInt(e);e=e>0?e:0;var b=parseInt(k.getTotalPoints());b=b>0?b:0;b+=e;k.setTotalPoints(b);var f=0;var l=$(n).html();var m=$(a).find(".contentDiv");$(m).each(function(t,q){var o=$(this).attr("data-variable").trim();var p=$(this).attr("data-min");var x=$(this).attr("data-max");var r=$(this).attr("data-integer");var s=$(this).attr("data-precision");f=s>f?s:f;var u=Number(p)+Number((Math.random()*(x-p)));if(r=="Yes"){u=Math.floor(u)}else{u=Math.floor(u*Math.pow(10,s))/Math.pow(10,s)}var w=new RegExp("{"+o+"}","g");var v=new RegExp("{"+o+"}","g");l=l.replace(w,u);h=h.replace(v,u)});var n=this.createQuestionStem(l);$(d).append(n);this.createInput(d,k,e,h,f);this.createFeedbackDiv(d)},createQuestionStem:function(a){var b=document.createElement("div");$(b).addClass("QuestionStem");$(b).addClass("d_stem");$(b).append(a);return b},createInput:function(e,h,l,k,b){var a=this.createInputField(e,h,this,l);var d=this.createSubmitButton(e,h,this,l,k,b);var f=this.createFeedbackDiv(e);$(a).on("keydown",function(){$(d).show()});$(a).on("click",function(){$(d).show()});$(e).append(a);$(e).append(d);$(e).append(f)},createFeedbackDiv:function(a){var b=document.createElement("div");$(b).addClass("feedbackDiv");return b},processAnswer:function(e,l,f,k,h){var m=$(e).find(".QuestionStem").first();var n=$(m).text();var b={uid:"",questionType:"",question:n,learnerResponse:"",correctResponse:"",feedBack:"",result:""};f=f>0?f:0;var a=this.checkAnswer(e,b,k,h);if(a){var d=l.getUserPoints();l.setUserPoints(f+d)}l.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(l,l.uid);this.appendScoreMessage(e,a?f:0,f);jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REPORT_TRANSCRIPT_ACTIVITY,b)},checkAnswer:function(widget,response,expression,highestPrecision){this.popupFeedback="";this.popupFeedback="";var isCorrectOverall=false;var isCorrect=false;var feedbackSymbol="\u2718";var shortAnswerInput=$(widget).find(".Qw_inputField")[0];var userAnswer=$(shortAnswerInput).val().toUpperCase();var correctAnswer=eval(expression);response.correctResponse=Math.floor(correctAnswer*Math.pow(10,highestPrecision))/Math.pow(10,highestPrecision);response.learnerResponse=userAnswer;adjustedUserAnswer=Math.floor(userAnswer*Math.pow(10,highestPrecision));adjustedCorrectAnswer=Math.floor(correctAnswer*Math.pow(10,highestPrecision));if(adjustedUserAnswer==adjustedCorrectAnswer){isCorrectOverall=true;isCorrect=true;response.feedBack="Correct";feedbackSymbol=isCorrect?"\u2713":"\u2718"}if(isCorrect==false){isCorrectOverall=false;response.feedBack="Incorrect"}$(widget).find(".feedbackDiv").html(feedbackSymbol);var answerFeedback=isCorrectOverall?"correct":"incorrect";this.popupFeedback="You answered "+userAnswer+".<br>";this.popupFeedback+="The correct answer is  "+response.correctResponse+".<br>";this.popupFeedback+="Your answer is "+answerFeedback+".";jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,this.popupFeedback);return isCorrectOverall},appendScoreMessage:function(e,d,f){var b=document.createElement("div");$(e).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+d+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(d,f,e,k,h,a){var b=document.createElement("button");$(b).addClass("Qw_submitButton");$(b).addClass("chip_dark");$(b).addClass("d_button");$(b).text("Submit");$(b).attr("style","margin-top:30px; margin-left:20px");$(b).on("click",function(){e.processAnswer(d,f,k,h,a);$(b).attr("disabled","disabled")});$(b).show();return b},createInputField:function(d,b,e){var a=document.createElement("input");$(a).addClass("Qw_inputField");$(a).addClass("d_field");$(a).attr("style","margin-top:30px; margin-left:20px");return a},enableInteractivity:function(a){$(a).find(".feedbackDiv").html("<pre>   </pre>");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".scoreMessagediv").html("");$(a).find(".scoreMessagediv").html("")},},{TEXT_CHANGED:"textChanged",NAME:"WordProblemWidget"});